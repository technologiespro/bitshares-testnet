(this.webpackJsonp=this.webpackJsonp||[]).push([[16,4],{2026:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(0),r=a.n(n),o=a(1),s=a.n(o),i=a(4),l=a(5),c=a.n(l),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};var p=r.a.createRef();function d(e){var t=e.onChange,a=e.value,n=e.placeholder,o=e.maxLength,s=e.style,l=e.className,c=e.name,d=e.autoComplete,h=e.onClear,m=e.type,f=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,["onChange","value","placeholder","maxLength","style","className","name","autoComplete","onClear","type"]);return null==h&&(h=function(){t({target:{value:""}}),p.current.focus()}),r.a.createElement(i.Input,u({ref:p,autoComplete:d,style:s,type:m,className:l+" search-input",placeholder:n,maxLength:o,name:c,value:a,onChange:t,addonAfter:r.a.createElement(i.Icon,{type:"search"}),suffix:h?r.a.createElement(i.Icon,{onClick:h,type:"close",className:a?"cursor-pointer":"hide"}):r.a.createElement("span",null)},f))}d.propTypes={onChange:s.a.func.isRequired,value:s.a.string,placeholder:s.a.string,style:s.a.object,className:s.a.string,type:s.a.string,name:s.a.string,autoComplete:s.a.string,maxLength:s.a.number,onClear:s.a.func},d.defaultProps={placeholder:c.a.translate("exchange.filter"),style:{width:"200px"},className:"",type:"text",name:"focus",autoComplete:"off",maxLength:16,onClear:void 0}},2029:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(16),s=a(1),i=a.n(s),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);e.scroll_length;var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={active:!1},a.listener=!1,a.onBodyClick=a.onBodyClick.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"componentDidMount",value:function(){this._setListener()}},{key:"shouldComponentUpdate",value:function(e,t){return!o.a.are_equal_shallow(e.entries,this.props.entries)||!o.a.are_equal_shallow(t,this.state)||e.value!==this.props.value}},{key:"_setListener",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;e.entries.length>1&&!this.listener&&(this.listener=!0,document.body.addEventListener("click",this.onBodyClick,{capture:!1,passive:!0}))}},{key:"_removeListener",value:function(){document.body.removeEventListener("click",this.onBodyClick),this.listener=!1}},{key:"componentWillReceiveProps",value:function(e){1===e.entries.length?this._removeListener():e.entries.length>1&&this._setListener(e)}},{key:"componentWillUnmount",value:function(){this._removeListener()}},{key:"onBodyClick",value:function(e){var t=e.target,a=!1;do{if(t.classList&&t.classList.contains("dropdown")&&t.id===this.props.id){a=!0;break}}while(t=t.parentNode);a?e.stopPropagation():this.setState({active:!1})}},{key:"onChange",value:function(e,t){t.preventDefault(),t.stopPropagation(),this.props.onChange(e),this.setState({active:!1})}},{key:"_toggleDropdown",value:function(){this.setState({active:!this.state.active})}},{key:"render",value:function(){var e=this,t=this.props,a=t.entries,n=t.value,o=this.state.active;if(0===a.length)return null;if(1==a.length)return r.a.createElement("div",{className:"dropdown-wrapper inactive"+(this.props.upperCase?" upper-case":"")},r.a.createElement("div",null,this.props.singleEntry?this.props.singleEntry:a[0]));var s=a.map((function(t){return r.a.createElement("li",{className:e.props.upperCase?"upper-case":"",key:t,onClick:e.onChange.bind(e,e.props.values[t])},r.a.createElement("span",null,t))}));return r.a.createElement("div",{onClick:this._toggleDropdown.bind(this),className:"dropdown-wrapper"+(o?" active":"")+(this.props.upperCase?" upper-case":"")},r.a.createElement("div",{style:{paddingRight:15}},n||r.a.createElement("span",{className:"hidden"},"A")),r.a.createElement("ul",{className:"dropdown",style:{overflow:a.length>this.props.scroll_length?"auto":"hidden"}},s))}}]),t}(r.a.Component);c.propTypes={scroll_length:i.a.number},c.defaultProps={scroll_length:9},t.a=c},2033:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return m}));var n=a(0),r=a.n(n),o=a(44),s=a(591),i=a.n(s),l=a(48),c=a(30),u=a(23),p=a(41),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var h=function(e){return!!e&&!!e.get("id")},m=function(e){var t,a,n=(a=t=function(t){function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),d(a,[{key:"render",value:function(){return h(this.props.currentAccount)?r.a.createElement(e,this.props):r.a.createElement(p.a,null)}}]),a}(r.a.Component),t.propTypes={currentAccount:o.a.ChainAccount},t.defaultProps={autosubscribe:!0},a);return n=Object(l.a)(n),n=i()(n,100,{leading:!1}),Object(c.a)(n,{listenTo:function(){return[u.a]},getProps:function(){var e=u.a.getState().currentAccount||u.a.getState().passwordAccount||"please-login";return{currentAccount:new Map([["name",e]])}}})}},2039:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(2),s=a.n(o),i=a(6),l=a(44),c=a(48),u=a(5),p=a.n(u),d=a(2029),h=a(35),m=a(9),f=a.n(m),b=a(3),g=a.n(b),y=a(127),v=a(1),_=a.n(v),k=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var S=function(e){function t(){return E(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return C(t,e),k(t,[{key:"render",value:function(){return 0!==this.props.assets.length&&this.props.value?r.a.createElement(d.a,{entries:this.props.assets.map((function(e){return e&&e.get("symbol")})).filter((function(e){return!!e})),values:this.props.assets.reduce((function(e,t){return t&&t.get("symbol")&&(e[t.get("symbol")]=t),e}),{}),singleEntry:this.props.assets[0]?r.a.createElement(h.a,{asset:this.props.assets[0].get("id"),amount:0,hide_amount:!0}):null,value:"",onChange:this.props.onChange}):null}}]),t}(r.a.Component);S.propTypes={value:_.a.string,onChange:_.a.func},S=Object(y.a)(S,{asList:!0});var A=function(e){function t(){return E(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return C(t,e),k(t,[{key:"getAsset",value:function(){return this.props.asset}},{key:"getError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.assetInput,t=this.props.error;return t||!e||this.getNameType(e)||(t=p.a.translate("explorer.asset.invalid",{name:e})),t}},{key:"getNameType",value:function(e){return e?i.ChainValidation.is_valid_symbol_error(e,!0)?null:"symbol":null}},{key:"onInputChanged",value:function(e){var t=e.target.value.trim().substr(0,16).toUpperCase();this.props.onChange&&t!==this.props.assetInput&&this.props.onChange(t)}},{key:"onKeyDown",value:function(e){13===e.keyCode&&(this.onFound(e),this.onAction(e))}},{key:"componentDidMount",value:function(){this.props.onFound&&this.props.asset&&this.props.onFound(this.props.asset)}},{key:"componentWillReceiveProps",value:function(e){this.props.onFound&&e.asset!==this.props.asset&&this.props.onFound(e.asset)}},{key:"onFound",value:function(e){e.preventDefault(),!this.props.onFound||this.getError()||this.props.disableActionButton||this.props.asset&&this.props.onFound(this.props.asset)}},{key:"onAssetSelect",value:function(e){e&&(this.props.onFound(e),this.props.onChange(e.get("symbol")))}},{key:"onAction",value:function(e){e.preventDefault(),!this.props.onAction||this.getError()||this.props.disableActionButton||this.props.asset&&this.props.onAction(this.props.asset)}},{key:"render",value:function(){var e=this.props,t=e.disabled,a=e.noLabel,n=this.getError(),o=void 0;t||(this.props.asset?o=this.props.asset.get("symbol"):!n&&this.props.assetInput&&(n=p.a.translate("explorer.asset.not_found",{name:this.props.assetInput})));var i=g()("button",{disabled:!this.props.asset||n||this.props.disableActionButton});return r.a.createElement("div",{className:"asset-selector",style:this.props.style},r.a.createElement("div",null,r.a.createElement("div",{className:"header-area"},n||a?null:r.a.createElement("label",{className:"right-label"},"  ",r.a.createElement("span",null,o)),r.a.createElement(s.a,{component:"label",content:this.props.label})),r.a.createElement("div",{className:"input-area"},r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("input",{style:this.props.inputStyle,disabled:this.props.disabled,type:"text",value:this.props.assetInput||"",placeholder:this.props.placeholder||p.a.translate("explorer.assets.symbol"),ref:"user_input",onChange:this.onInputChanged.bind(this),onKeyDown:this.onKeyDown.bind(this),tabIndex:this.props.tabIndex}),r.a.createElement("div",{className:"form-label select floating-dropdown"},this.props.asset?r.a.createElement(S,{ref:this.props.refCallback,value:this.props.asset.get("symbol"),assets:f.a.List(this.props.assets),onChange:this.onAssetSelect.bind(this)}):null),this.props.children,this.props.onAction?r.a.createElement("button",{className:i,onClick:this.onAction.bind(this)},r.a.createElement(s.a,{content:this.props.action_label})):null)),r.a.createElement("div",{className:"error-area",style:{paddingBottom:"10px"}},r.a.createElement("span",{style:{wordBreak:"break-all"}},n))))}}]),t}(r.a.Component);A.propTypes={label:_.a.string,error:_.a.string,placeholder:_.a.string,onChange:_.a.func,onFound:_.a.func,assetInput:_.a.string,asset:l.a.ChainAsset,tabIndex:_.a.number,disableActionButton:_.a.bool},A.defaultProps={disabled:!1},t.a=Object(c.a)(A)},2046:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(2092),s=a.n(o),i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={animateEnter:!1},e.timer=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.enableAnimation()}},{key:"resetAnimation",value:function(){this.setState({animateEnter:!1}),this.enableAnimation()}},{key:"enableAnimation",value:function(){var e=this;this.timer=setTimeout((function(){e.timer&&e.setState({animateEnter:!0})}),2e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){return this.props.children?r.a.createElement(s.a,{id:this.props.id,className:this.props.className,component:this.props.component,transitionName:this.props.transitionName,transitionEnterTimeout:this.props.enterTimeout,transitionEnter:this.state.animateEnter,transitionLeave:!1},this.props.children):r.a.createElement(this.props.component)}}]),t}(r.a.Component);l.defaultProps={component:"span",enterTimeout:2e3},t.a=l},2063:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(1),s=a.n(o),i=a(148),l=a.n(i),c=a(44),u=a(56),p=a.n(u),d=a(48),h=a(16),m=a(87),f=a(20),b=a(5),g=a.n(b),y=a(9),v=a.n(y),_=a(4),k=a(112),E=a(2),w=a.n(E),C=a(35),S=a(593),A=a(136),x=a(592);function O(e){var t=e.accountObj,a=e.backingAssetObj,n=e.collateralBalanceObj,o=e.debtBalanceObj,s=e.quoteAssetObj,i=e.newPosition,l=e.errors,c=e.collateral,u=e.collateral_ratio,p=e.debtAmount,d=e.backingPrecision,m=e.maintenanceRatio,f=e.remainingBackingBalance,b=e.remainingDebtBalance,y=e.target_collateral_ratio,v=e.unlockedInputType,E=e.disableHelp,O=e.isRatioLocked,P=e.isOriginalBelowMCR,T=e.isPredictionMarket,N=e.isValid,B=e.useTargetCollateral,M=e.onPayDebt,F=e.onMaximizeCollatereal,j=e.onBorrowChange,I=e.onLockChangeDebt,q=e.onCollateralChange,R=e.onLockChangeCollateral,L=e.onRatioChange,D=e.onLockChangeCR,V=e.onSetUseTCR,z=e.onTCRatioChange,U=h.a.get_asset_precision(s.get("precision")),H=i?r.a.createElement(A.a,{noPopOver:!0,noTip:!0,quote_amount:m*p*U,quote_asset:s.get("id"),base_asset:a.get("id"),base_amount:c*d}):null,W=r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(w.a,{component:"h3",content:"borrow.no_valid",asset_symbol:s.get("symbol")})),G=r.a.createElement("span",null,r.a.createElement("span",null,0!=c?r.a.createElement("span",null,r.a.createElement(w.a,{component:"a",onClick:M.bind(this),content:"borrow.pay_max_debt"})," "):null,r.a.createElement(w.a,{component:"span",content:"transfer.available"}),":"," ",r.a.createElement("span",null,o.id?r.a.createElement(C.a,{amount:b,asset:s.get("id")}):r.a.createElement(C.a,{amount:0,asset:s.get("id")})))),Q=r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement(w.a,{component:"a",onClick:F.bind(this),content:"borrow.use_max"})," "),r.a.createElement(w.a,{component:"span",content:"transfer.available"}),":"," ",r.a.createElement("span",null,n.id?r.a.createElement(C.a,{amount:f,asset:a.get("id")}):r.a.createElement(C.a,{amount:0,asset:a.get("id")}))));return N?r.a.createElement("div",{style:{textAlign:"left"}},E?null:r.a.createElement("div",{style:{paddingBottom:"1rem"}},r.a.createElement(x.a,{path:"components/"+(T?"BorrowModalPrediction":"BorrowModal"),debt:s.get("symbol"),collateral:a.get("symbol"),borrower:t.get("name"),mr:m})),!T&&P?r.a.createElement(w.a,{component:"h6",className:"has-warning",content:"borrow.errors.below_info"}):null,T?null:r.a.createElement("div",{style:{paddingTop:"1rem",paddingBottom:"1rem"}},r.a.createElement("div",{className:"borrow-price-feeds"},r.a.createElement("span",{className:"borrow-price-label"},r.a.createElement(w.a,{content:"transaction.feed_price"}),": "),r.a.createElement(A.a,{noPopOver:!0,quote_amount:k.a.extractRawFeedPrice(s).getIn(["base","amount"]),quote_asset:k.a.extractRawFeedPrice(s).getIn(["base","asset_id"]),base_asset:k.a.extractRawFeedPrice(s).getIn(["quote","asset_id"]),base_amount:k.a.extractRawFeedPrice(s).getIn(["quote","amount"])})),r.a.createElement("b",null),r.a.createElement("div",{className:"borrow-price-final "+(l.below_maintenance?"has-error":l.close_maintenance?"has-warning":"")},r.a.createElement("span",{className:"borrow-price-label"},r.a.createElement(w.a,{content:"exchange.your_price"}),": "),H)),r.a.createElement(_.Form,{className:"full-width",layout:"vertical"},r.a.createElement(S.a,{label:"transaction.borrow_amount",amount:p.toString(),onChange:j.bind(this),asset:s.get("id"),assets:[s.get("id")],display_balance:G,placeholder:"0.0",tabIndex:1,lockStatus:"debt"!=v&&!O,onLockChange:I.bind(this)}),r.a.createElement(S.a,{label:"transaction.collateral",amount:c.toString(),onChange:q.bind(this),asset:a.get("id"),assets:[a.get("id")],display_balance:Q,placeholder:"0.0",tabIndex:2,lockStatus:"collateral"!=v&&!O,onLockChange:R.bind(this),validateStatus:l.collateral_balance?"error":"",help:l.collateral_balance?l.collateral_balance:null}),T?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(_.Row,{gutter:16},r.a.createElement(_.Col,{span:12},r.a.createElement(_.Form.Item,{label:g.a.translate("borrow.coll_ratio"),validateStatus:l.close_maintenance?"warning":l.below_maintenance?"error":null,help:l.close_maintenance?l.close_maintenance:l.below_maintenance?l.below_maintenance:null},r.a.createElement(_.Input,{value:0==u?"":u,tabIndex:3,onChange:L.bind(this),className:"input-group-unbordered-before",addonBefore:r.a.createElement(_.Icon,{className:O?"green":"grey",type:O?"lock":"unlock",onClick:D.bind(this),style:{fontSize:"20px"}})}))),r.a.createElement(_.Col,{span:12},r.a.createElement(_.Form.Item,{validateStatus:l.tcr_below_maintenance?"error":"",help:l.tcr_below_maintenance?l.tcr_below_maintenance:null},r.a.createElement(_.Input.Group,{compact:!0,style:{marginBottom:8}},r.a.createElement(_.Checkbox,{onClick:V.bind(this),checked:B,tabIndex:4},r.a.createElement(w.a,{content:"borrow.enable_target_collateral_ratio"})),r.a.createElement(_.Tooltip,{title:g.a.translate("tooltip.target_collateral_ratio")},r.a.createElement(_.Icon,{type:"question-circle"}))),B?r.a.createElement(_.Input,{value:isNaN(y)?"0":y,tabIndex:5,onChange:z.bind(this)}):null))),r.a.createElement(_.Form.Item,{label:"Ratio Slider"},r.a.createElement(_.Slider,{step:.01,min:0,max:12*m,value:u,onChange:L.bind(this)}))))):W}var P=a(591),T=a.n(P),N=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var j=function(e){function t(e){B(this,t);var a=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state=a._initialState(e),a._onSubmit=a._onSubmit.bind(a),a}return F(t,e),N(t,[{key:"_initialState",value:function(e){var t=e?this._getCurrentPosition(e):{};if(t.collateral){var a=h.a.get_asset_amount(t.debt,e.quoteAssetObj),n=h.a.get_asset_amount(t.collateral,e.backingAssetObj),r=isNaN(t.target_collateral_ratio)?0:t.target_collateral_ratio/1e3;return{debtAmount:a?a.toString():null,collateral:n?n.toString():null,collateral_ratio:this._getCollateralRatio(a,n),target_collateral_ratio:r,errors:this._getInitialErrors(),useTargetCollateral:r>0,original_position:{debt:a,collateral:n,target_collateral_ratio:r},unlockedInputType:"collateral",isRatioLocked:!0}}return{debtAmount:0,collateral:0,collateral_ratio:this._getInitialCollateralRatio(e),target_collateral_ratio:this._getMaintenanceRatio(),errors:this._getInitialErrors(),useTargetCollateral:!1,original_position:{debt:0,collateral:0},unlockedInputType:"debt",isRatioLocked:!0}}},{key:"componentDidUpdate",value:function(){p.a.rebuild()}},{key:"componentDidMount",value:function(){var e=this._initialState(this.props);this.setState(e),this._setUpdatedPosition(e)}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.props.visible===e.visible&&h.a.are_equal_shallow(t,this.state)&&v.a.is(e.quoteAssetObj,this.props.quoteAssetObj)&&!e.backingAssetObj.get("symbol")!==this.props.backingAssetObj.get("symbol")&&v.a.is(e.accountObj,this.props.accountObj)&&v.a.is(e.call_orders,this.props.call_orders)&&this.state.unlockedInputType===t.unlockedInputType)}},{key:"componentWillReceiveProps",value:function(e){var t=this.state,a=t.debtAmount,n=t.collateral,r=t.collateral_ratio;if(e.accountObj!==this.props.accountObj||e.hasCallOrders!==this.props.hasCallOrders||e.quoteAssetObj.get("id")!==this.props.quoteAssetObj.get("id")){var o=this._initialState(e),s=!1;(a||n||r)&&(o.debtAmount=a,o.collateral=n,o.collateral_ratio=r,s=!0),this.setState(o),s&&this._validateFields(o)}}},{key:"_getInitialErrors",value:function(){return{collateral_balance:null,ratio_too_high:null}}},{key:"_getMaintenanceRatio",value:function(){return this.props.quoteAssetObj.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3}},{key:"confirmClicked",value:function(e){e.preventDefault(),l.a.publish(this.props.modalId,"close")}},{key:"_onBorrowChange",value:function(e){var t=this._getFeedPrice(),a=e.amount.replace(/,/g,""),n={debtAmount:a,collateral:this.state.isRatioLocked?(this.state.collateral_ratio*(a/t).toFixed(this.props.backingAssetObj.get("precision"))).toFixed(this.props.backingAssetObj.get("precision")):this.state.collateral,collateral_ratio:this.state.isRatioLocked?this.state.collateral_ratio:this.state.collateral/(a/t)};this.setState(n),this._validateFields(n),this._setUpdatedPosition(n)}},{key:"_onCollateralChange",value:function(e){var t=this.state,a=t.isRatioLocked,n=t.collateral_ratio,r=e.amount.replace(/,/g,""),o=this._getFeedPrice(),s=a?n:r/(this.state.debtAmount/o),i=a?(r*o/s).toFixed(this.props.backingAssetObj.get("precision")):this.state.debtAmount,l=this._isPredictionMarket(this.props)?{debtAmount:r,collateral:r,collateral_ratio:1}:{debtAmount:i,collateral:r,collateral_ratio:s};this.setState(l),this._validateFields(l),this._setUpdatedPosition(l)}},{key:"_onTargetRatioChange",value:function(e){var t=e.target.value;new RegExp(/[[:digit:]]/).test(t)||(t=t.replace(/[^0-9.]/g,""));var a={target_collateral_ratio:t};this.setState(a),this._validateFields(a),this._setUpdatedPosition(a)}},{key:"_onRatioChange",value:function(e){var t=this._getFeedPrice(),a=void 0,n=void 0,r=0;e.target?(new RegExp(/[[:digit:]]/).test(e.target.value)||(e.target.value=e.target.value.replace(/[^0-9.]/g,"")),r=e.target.value):r=e;"debt"==this.state.unlockedInputType?(a=(this.state.collateral*t/parseFloat(r)).toFixed(this.props.backingAssetObj.get("precision")),n=this.state.collateral):(a=this.state.debtAmount,n=(this.state.debtAmount/t*parseFloat(r)).toFixed(this.props.backingAssetObj.get("precision")));var o={debtAmount:a,collateral:n,collateral_ratio:r};this.setState(o),this._validateFields(o),this._setUpdatedPosition(o)}},{key:"_maximizeCollateral",value:function(){var e=this.props?this._getCurrentPosition(this.props):{},t=0;e.collateral&&(t=h.a.convert_satoshi_to_typed(e.collateral,this.props.backingAssetObj));var a=h.a.convert_satoshi_to_typed(this.props.collateralBalanceObj.get("balance"),this.props.backingAssetObj),n=Math.max(Math.floor(a+t-10),0);this._onCollateralChange(new Object({amount:n.toString()}))}},{key:"_maximizeDebt",value:function(){var e=this.props?this._getCurrentPosition(this.props):{},t=0;e.collateral&&(t=h.a.get_asset_amount(e.collateral,this.props.backingAssetObj));var a=this.props.collateralBalanceObj.get("balance")/h.a.get_asset_precision(this.props.backingAssetObj)+t-10,n={debtAmount:a/this.state.collateral_ratio*this._getFeedPrice(),collateral:a,collateral_ratio:this.state.collateral_ratio};this.setState(n),this._validateFields(n),this._setUpdatedPosition(n)}},{key:"_payDebt",value:function(){var e=this.props?this._getCurrentPosition(this.props):{debt:0};if(!(e.debt<=0)){var t=h.a.get_asset_amount(Math.max(e.debt-this.props.debtBalanceObj.get("balance"),0),this.props.quoteAssetObj);this._onBorrowChange({amount:t.toString()})}}},{key:"_setUpdatedPosition",value:function(e){this.setState({newPosition:parseFloat(e.debtAmount)/parseFloat(e.collateral)})}},{key:"_validateFields",value:function(e){var t=this._getInitialErrors(),a=this.state.original_position,n=this.props.collateralBalanceObj?this.props.collateralBalanceObj.toJS():{balance:0},r=this._getMaintenanceRatio(),o=this._getCollateralRatio(a.debt,a.collateral),s=a.collateral>0&&o<r;parseFloat(e.collateral)-a.collateral>h.a.get_asset_amount(n.balance,this.props.backingAssetObj.toJS())&&(t.collateral_balance=g.a.translate("borrow.errors.collateral")),e.target_collateral_ratio&&e.target_collateral_ratio<r&&(t.tcr_below_maintenance=g.a.translate("borrow.errors.below_mcr_tcr",{mr:r})),s&&e.debtAmount>a.debt?t.below_maintenance=g.a.translate("borrow.errors.increased_debt_on_margin_call"):s&&parseFloat(e.collateral_ratio)<=parseFloat(o)?t.below_maintenance=g.a.translate("borrow.errors.below_ratio_mcr_update",{ocr:o.toFixed(4)}):!s&&parseFloat(e.collateral_ratio)<(this._isPredictionMarket(this.props)?1:r)?t.below_maintenance=g.a.translate("borrow.errors.below",{mr:r}):parseFloat(e.collateral_ratio)<(this._isPredictionMarket(this.props)?1:r+.5)&&(t.close_maintenance=g.a.translate("borrow.errors.close",{mr:r})),this.setState({errors:t})}},{key:"_onSubmit",value:function(e){e.preventDefault(),this.props.hideModal();var t=h.a.get_asset_precision(this.props.quoteAssetObj.get("precision")),a=h.a.get_asset_precision(this.props.backingAssetObj.get("precision")),n=this._getCurrentPosition(this.props),r=!1;!!(void 0!==this.state.target_collateral_ratio&&this.state.target_collateral_ratio>0&&this.state.useTargetCollateral)&&(r={target_collateral_ratio:parseInt(1e3*this.state.target_collateral_ratio,10)});var o=parseInt(this.state.collateral*a-n.collateral,10),s=parseInt(this.state.debtAmount*t-n.debt,10);0==o&&0==s&&(o=1);var i=m.a.new_transaction();r?i.add_type_operation("call_order_update",{fee:{amount:0,asset_id:0},funding_account:this.props.accountObj.get("id"),delta_collateral:{amount:o,asset_id:this.props.backingAssetObj.get("id")},delta_debt:{amount:s,asset_id:this.props.quoteAssetObj.get("id")},extensions:r}):i.add_type_operation("call_order_update",{fee:{amount:0,asset_id:0},funding_account:this.props.accountObj.get("id"),delta_collateral:{amount:o,asset_id:this.props.backingAssetObj.get("id")},delta_debt:{amount:s,asset_id:this.props.quoteAssetObj.get("id")}}),f.a.process_transaction(i,null,!0).catch((function(e){0})),l.a.publish(this.props.modalId,"close")}},{key:"_getCurrentPosition",value:function(e){var t={collateral:null,debt:null};return e&&e.hasCallOrders&&e.call_orders&&(t=(t=e.call_orders.filter((function(e){return!!e})).find((function(t){return t.getIn(["call_price","quote","asset_id"])===e.quoteAssetObj.get("id")})))?t.toJS():{collateral:null,debt:null}),t}},{key:"_getFeedPrice",value:function(){return this.props?this._isPredictionMarket(this.props)?1:1/h.a.get_asset_price(k.a.extractRawFeedPrice(this.props.quoteAssetObj).getIn(["quote","amount"]),this.props.backingAssetObj,k.a.extractRawFeedPrice(this.props.quoteAssetObj).getIn(["base","amount"]),this.props.quoteAssetObj):1}},{key:"_getInitialCollateralRatio",value:function(e){return this._isPredictionMarket(e)?1:2*this._getMaintenanceRatio()}},{key:"_getCollateralRatio",value:function(e,t){return t/(e/this._getFeedPrice())}},{key:"_isPredictionMarket",value:function(e){return e.quoteAssetObj.getIn(["bitasset","is_prediction_market"])}},{key:"_setUseTargetCollateral",value:function(){this.setState({useTargetCollateral:!this.state.useTargetCollateral})}},{key:"_onLockChange",value:function(e){this.setState({isRatioLocked:!1,unlockedInputType:e})}},{key:"_onLockCR",value:function(){this.setState({isRatioLocked:!this.state.isRatioLocked})}},{key:"render",value:function(){var e=this,t=this.props,a=t.quoteAssetObj,n=t.backingAssetObj,o=t.debtBalanceObj,s=t.collateralBalanceObj,i=this.state,l=i.debtAmount,c=i.collateral,u=i.collateral_ratio,p=i.target_collateral_ratio,d=i.errors,m=i.original_position,f=i.useTargetCollateral;u&&!isNaN(u)&&u>0&&u<1e3||(u=0),-1!=u.toString().indexOf(".")&&u.toString().split(".")[1].length>2&&(u=u.toString().split(".")[0]+"."+u.toString().split(".")[1].substr(0,2)),-1!=p.toString().indexOf(".")&&p.toString().split(".")[1].length>2&&(p=p.toString().split(".")[0]+"."+p.toString().split(".")[1].substr(0,2)),o=o?o.toJS():{balance:0,id:null},s=s?s.toJS():{balance:0,id:null};var b=h.a.get_asset_precision(this.props.backingAssetObj.get("precision")),y=h.a.get_asset_precision(this.props.quoteAssetObj.get("precision")),v=this._getCurrentPosition(this.props),k=parseInt(this.state.collateral*b-v.collateral,10),E=parseInt(this.state.debtAmount*y-v.debt,10),w=s.balance-k,C=o.balance+E,S=this._getFeedPrice(),A=this._getMaintenanceRatio(),x=this._isPredictionMarket(this.props),P=m.collateral>0&&this._getCollateralRatio(m.debt,m.collateral)<A,T=[];return!x&&isNaN(S)?T.push(r.a.createElement(_.Button,{tabIndex:6,onClick:this.props.hideModal},g.a.translate("accountObj.perm.cancel"))):(T.push(r.a.createElement(_.Button,{tabIndex:6,key:"submit",type:"primary",onClick:this._onSubmit},g.a.translate("borrow.adjust"))),T.push(r.a.createElement(_.Button,{tabIndex:7,key:"cancel",onClick:function(){e.setState(e._initialState(e.props))}},g.a.translate("wallet.reset")))),r.a.createElement(_.Modal,{title:g.a.translate("borrow.title",{asset_symbol:a.get("symbol")}),visible:this.props.visible,onCancel:this.props.hideModal,footer:T},r.a.createElement(O,{accountObj:this.props.accountObj,backingAssetObj:n,collateralBalanceObj:s,debtBalanceObj:o,quoteAssetObj:a,newPosition:this.state.newPosition||null,errors:d,collateral:c,collateral_ratio:u,debtAmount:l,backingPrecision:b,maintenanceRatio:A,remainingBackingBalance:w,remainingDebtBalance:C,target_collateral_ratio:p,unlockedInputType:this.state.unlockedInputType,disableHelp:this.props.disableHelp,isRatioLocked:this.state.isRatioLocked,isOriginalBelowMCR:P,isPredictionMarket:x,isValid:x||!x&&!isNaN(S),useTargetCollateral:f,onBorrowChange:this._onBorrowChange.bind(this),onCollateralChange:this._onCollateralChange.bind(this),onMaximizeCollatereal:this._maximizeCollateral.bind(this),onRatioChange:this._onRatioChange.bind(this),onLockChangeCR:this._onLockCR.bind(this),onLockChangeCollateral:this._onLockChange.bind(this,"debt"),onLockChangeDebt:this._onLockChange.bind(this,"collateral"),onPayDebt:this._payDebt.bind(this),onTCRatioChange:this._onTargetRatioChange.bind(this),onSetUseTCR:this._setUseTargetCollateral.bind(this)}))}}]),t}(r.a.Component);j.propTypes={quoteAssetObj:c.a.ChainAsset.isRequired,backingAssetObj:c.a.ChainAsset.isRequired,debtBalanceObj:c.a.ChainObject,collateralBalanceObj:c.a.ChainObject,call_orders:c.a.ChainObjectsList,hasCallOrders:s.a.bool},j=Object(d.a)(j),j=T()(j,50,{leading:!1});var I=function(e){function t(){B(this,t);var e=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={smallScreen:!1,open:!1},e}return F(t,e),N(t,[{key:"show",value:function(){this.props.showModal()}},{key:"componentWillMount",value:function(){this.setState({smallScreen:window.innerHeight<=800})}},{key:"render",value:function(){var e=this.props,t=e.quoteAssetObj,a=e.backingAssetObj,n=e.accountObj,o=n.get("balances").toJS(),s=void 0,i=void 0;if(o)for(var l in o)l===a&&(s=o[l]),l===t&&(i=o[l]);return this.props.visible?r.a.createElement(j,{visible:this.props.visible,hideModal:this.props.hideModal,showModal:this.props.showModal,quoteAssetObj:t,call_orders:n.get("call_orders",Object(y.List)()).toList(),hasCallOrders:n.get("call_orders")&&n.get("call_orders").size>0,modalId:this.props.modalId,debtBalanceObj:i,collateralBalanceObj:s,backingAssetObj:a,disableHelp:this.state.smallScreen,accountObj:n}):null}}]),t}(r.a.Component);t.a=I},2075:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return c}));var n=a(107),r=a(6),o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments[2],n=arguments[3];if(e||""===e){var r=e.toUpperCase();r.startsWith("BIT")&&r.length>=6&&(r=e.substr(3,r.length-1)),a(r,10,t),n({lookupQuote:r})}}function i(e,t,a,r){var s=e.searchAssets,i=e.marketPickerAsset,u=e.baseAsset,p=e.quoteAsset,d=t.inputValue,h=t.lookupQuote;a({activeSearch:!0});var m=0,f=[],b=u.get("symbol"),g=p.get("symbol");s.size&&d&&d.length>2&&s.filter((function(e){try{if(e.options.description){var t=JSON.parse(e.options.description);if("visible"in t&&!t.visible)return!1}}catch(e){}return-1!==e.symbol.indexOf(h)})).forEach((function(e){if(!(m>100)){m++;var t=c(e.issuer),a=u.get("symbol"),n=e.symbol+"_"+a,r=g==i;(r&&e.symbol!=b||!r&&e.symbol!=g)&&f.push([n,{quote:e.symbol,base:a,issuerId:e.issuer,issuer:t}])}})),r(function(e,t){t.startsWith("BIT")&&t.length>=6&&(t=t.substr(3,t.length-1));return e.sort((function(e,a){var r=o(e,2)[1],s=o(a,2)[1],i=l(r),c=l(s);if(i.asset!==c.asset){if(i.asset===t)return-1;if(c.asset===t)return 1;if(i.asset>c.asset)return-1;if(i.asset<c.asset)return 1}if(i.isCommittee^c.isCommittee){if(i.isCommittee)return-1;if(c.isCommittee)return 1}var u=Object(n.f)(r.quote),p=Object(n.f)(s.quote);return u&&!p?-1:p&&!u||i.gateway>c.gateway?1:i.gateway<c.gateway?-1:0}))}(f,d))}function l(e){var t={},a=e.quote;if(-1!==a.indexOf(".")){var n=a.split("."),r=o(n,2),s=r[0],i=r[1];t.gateway=s,t.asset=i}else t.asset=a;return"1.2.0"===e.issuerId&&(t.isCommittee=!0),t}function c(e){var t=r.ChainStore.getObject(e,!1,!1);return t?t.get("name"):void 0}},2076:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(2),s=a.n(o),i=a(16),l=a(48),c=a(44),u=a(56),p=a.n(u),d=a(5),h=a.n(d),m=a(83),f=a(601),b=a(168),g=a(41),y=a(46),v=a(30),_=a(21),k=a(22),E=a(595),w=a.n(E),C=a(4),S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},A=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var T=function(e){function t(e){x(this,t);var a=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={inputCoinType:e.inputCoinType||a.props.preferredBridge,outputCoinType:e.outputCoinType,receiveAmount:0,depositLimit:0,sendAmount:0,toAddress:m.a.getLast(e.walletType),withdrawValue:"",amountError:null,inputAmount:0,receiveLoading:!1,limitLoading:!0,apiError:!1},a._validateAddress(a.state.toAddress,e),a.deposit_address_cache=new f.a,a}return P(t,e),A(t,[{key:"onClose",value:function(){this.props.hideModal()}},{key:"componentWillMount",value:function(){this._getDepositAddress(this.props)}},{key:"componentDidMount",value:function(){this._getDepositLimit(this.props),this._estimateOutput(this.props)}},{key:"componentWillReceiveProps",value:function(e){e.inputCoinType===this.props.inputCoinType&&e.outputCoinType===this.props.outputCoinType||(this.setState({inputCoinType:e.inputCoinType,outputCoinType:e.outputCoinType}),this._getDepositLimit(e),this._estimateOutput(e),this._getDepositAddress(e))}},{key:"componentDidUpdate",value:function(){p.a.rebuild()}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.inputCoinType===t.inputCoinType&&this.state.outputCoinType===t.outputCoinType||(this._getDepositLimit(t),this._estimateOutput(t),this._getDepositAddress(t)),e.inputCoinType!==this.props.inputCoinType||e.outputCoinType!==this.props.outputCoinType||e.sender!==this.props.sender||e.asset!==this.props.asset||e.isAvailable!==this.props.isAvailable||e.isDown!==this.props.isDown||!i.a.are_equal_shallow(t,this.state)}},{key:"_getDepositAddress",value:function(e){this.setState({receive_address:null}),Object(m.m)(this._getDepositObject(e))}},{key:"_getDepositObject",value:function(e){var t=this,a=e.inputCoinType,n=e.outputCoinType;return{inputCoinType:a.toLowerCase(),outputCoinType:n.toLowerCase(),outputAddress:this.props.sender.get("name"),url:y.b.BASE,stateCallback:function(e){t.addDepositAddress(a.toLowerCase(),n.toLowerCase(),t.props.sender.get("name"),e)}}}},{key:"_getDepositLimit",value:function(e){var t=this,a=e.inputCoinType,n=e.outputCoinType;this.setState({limitLoading:!0}),Object(m.k)(a.toLowerCase(),n.toLowerCase()).then((function(e){t.setState({depositLimit:e.depositLimit,limitLoading:!1})})).catch((function(e){console.log("deposit limit error:",e),t.setState({depositLimit:null,limitLoading:!1})}))}},{key:"_onAmountChange",value:function(e,t){var a=t.target.value;switch(new RegExp(/[[:digit:]]/).test(a)||(a=a.replace(/[^0-9.]/g,"")),"."==a.charAt(0)&&(a="0."),a.charAt(a.length)!=a.search(".")&&a.substr(1),a=i.a.limitByPrecision(a,8),e){case"input":this.setState({inputAmount:a},this._estimateOutput.bind(this));break;case"output":this.setState({outputAmount:a},this._estimateInput.bind(this))}}},{key:"_estimateOutput",value:function(){var e=this,t=this.state,a=t.inputAmount,n=t.inputCoinType,r=t.outputCoinType;this.setState({receiveAmount:0,sendAmount:a}),a&&(this.setState({receiveLoading:!0}),Object(m.c)(a,n.toLowerCase(),r.toLowerCase()).then((function(t){e.setState({inputAmount:t.inputAmount,receiveAmount:t.outputAmount,receiveLoading:!1})})).catch((function(t){console.log("receive amount err:",t),e.setState({receiveLoading:!1,apiError:!0})})))}},{key:"_estimateInput",value:function(){var e=this,t=this.state,a=t.outputAmount,n=t.inputCoinType,r=t.outputCoinType;this.setState({receiveAmount:a,sendAmount:0}),a&&(this.setState({receiveLoading:!0}),Object(m.b)(a,n.toLowerCase(),r.toLowerCase()).then((function(t){console.log(t),e.setState({inputAmount:t.inputAmount,sendAmount:i.a.limitByPrecision(t.inputAmount,8),receiveLoading:!1})})).catch((function(t){console.log("send amount err:",t),e.setState({receiveLoading:!1,apiError:!0})})))}},{key:"addDepositAddress",value:function(e,t,a,n){this.deposit_address_cache.cacheInputAddress("blocktrades",a,e,t,n.address,n.memo),this.setState({receive_address:n})}},{key:"_validateAddress",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;Object(m.n)({walletType:a.walletType,newAddress:e}).then((function(a){t.state.toAddress===e&&t.setState({withdraw_address_check_in_progress:!1,validAddress:a})})).catch((function(e){console.error("Error when validating address:",e)}))}},{key:"_setDepositAsset",value:function(e){this.setState({inputCoinType:e}),k.a.changeViewSetting({preferredBridge:e})}},{key:"_renderDeposit",value:function(){var e=i.a.replaceName(this.props.asset),t=e.name,a=e.prefix,n=this.state,o=n.receive_address,l=n.apiError,c=o&&"memo"in o&&o.memo,u=o&&o.address||"",p=r.a.createElement("div",{className:"QR",style:{textAlign:"center"}},r.a.createElement(w.a,{size:140,value:u})),d=Object.keys(this.props.bridges.toJS()),m=this.state.inputCoinType.toUpperCase(),f=(a||"")+t,y=(this.state.receiveAmount/this.state.inputAmount).toFixed(4),v=f+"/"+m,_=this.state.inputAmount>parseFloat(this.state.depositLimit)||this.state.sendAmount>parseFloat(this.state.depositLimit);return r.a.createElement("div",{className:"modal__body",style:{paddingTop:0}},r.a.createElement(C.Form,{className:"full-width",layout:"vertical"},r.a.createElement(C.Form.Item,{label:h.a.translate("modal.buy.asset")},r.a.createElement(C.Input,{disabled:!0,value:f})),r.a.createElement(C.Form.Item,{label:h.a.translate("modal.buy.bridge")},r.a.createElement(C.Tooltip,{title:h.a.translate("tooltip.bridge_TRADE")},r.a.createElement(C.Input,{disabled:!0,type:"text",defaultValue:"BLOCKTRADES"})))),l?r.a.createElement(s.a,{content:"modal.deposit.address_generation_error"}):r.a.createElement("span",null,r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 medium-6",style:{paddingRight:5}},r.a.createElement(C.Form,{className:"full-width",layout:"vertical"},r.a.createElement(C.Form.Item,{label:h.a.translate("transfer.send"),validateStatus:_?"error":"",help:_?h.a.translate("gateway.over_limit"):""},r.a.createElement(C.Input,{value:this.state.sendAmount,onChange:this._onAmountChange.bind(this,"input"),addonAfter:r.a.createElement(C.Select,{defaultValue:this.state.inputCoinType.toUpperCase(),value:this.state.inputCoinType.toUpperCase(),style:{width:100},onChange:this._setDepositAsset.bind(this)},d.map((function(e){return r.a.createElement(C.Select.Option,{key:e.toUpperCase()},e.toUpperCase())})))})))),r.a.createElement("div",{className:"small-12 medium-6",style:{paddingRight:5}},r.a.createElement(C.Form,{className:"full-width",layout:"vertical"},r.a.createElement(C.Form.Item,{label:h.a.translate("gateway.deposit_limit")},r.a.createElement(C.Input,{value:this.state.depositLimit,disabled:!0,addonAfter:r.a.createElement(C.Select,{defaultValue:this.state.inputCoinType.toUpperCase(),value:this.state.inputCoinType.toUpperCase(),style:{width:100},disabled:!0,showArrow:!1},d.map((function(e){return r.a.createElement(C.Select.Option,{key:e.toUpperCase()},e.toUpperCase())})))}))))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 medium-6",style:{paddingRight:5}},r.a.createElement(C.Form,{className:"full-width",layout:"vertical"},r.a.createElement(C.Form.Item,{label:h.a.translate("exchange.receive")},r.a.createElement(C.Input,{value:this.state.receiveAmount,onChange:this._onAmountChange.bind(this,"output"),addonAfter:r.a.createElement(C.Select,{defaultValue:f,value:f,style:{width:100},disabled:!0,showArrow:!1},r.a.createElement(C.Select.Option,{key:f},f))})))),r.a.createElement("div",{className:"small-12 medium-6",style:{paddingRight:5}},r.a.createElement(C.Form,{className:"full-width",layout:"vertical"},r.a.createElement(C.Form.Item,{label:h.a.translate("exchange.price")},r.a.createElement(C.Input,{value:_||isNaN(y)?0:y,disabled:!0,addonAfter:r.a.createElement(C.Select,{defaultValue:v,value:v,style:{width:125},disabled:!0,showArrow:!1},r.a.createElement(C.Select.Option,{key:v},v))}))))),u?r.a.createElement("div",{className:"container-row"},c?null:p,r.a.createElement("div",{className:"grid-block"},r.a.createElement("div",{className:"copyIcon"},r.a.createElement(b.a,{text:u,className:"copyIcon"})),r.a.createElement("div",null,r.a.createElement(s.a,{component:"div",style:{fontSize:"0.8rem",fontWeight:"bold",paddingBottom:"0.3rem"},content:"gateway.purchase_notice",inputAsset:m,outputAsset:f}),r.a.createElement("div",{className:"modal__highlight"},u))),c?r.a.createElement("div",{className:"grid-block",style:{marginTop:"10px"}},r.a.createElement("div",{className:"copyIcon"},r.a.createElement(b.a,{text:o.memo,className:"copyIcon"})),r.a.createElement("div",null,r.a.createElement(s.a,{unsafe:!0,content:"gateway.purchase_notice_memo",component:"div",style:{fontSize:"0.8rem",fontWeight:"bold",paddingBottom:"0.3rem"}}),r.a.createElement("div",{className:"modal__highlight"},o.memo))):null):r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(g.a,{type:"three-bounce"}))))}},{key:"render",value:function(){return this.props.asset?r.a.createElement("div",{className:"grid-block vertical no-overflow"},this.props.isDown?r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(s.a,{className:"txtlabel cancel",content:"gateway.unavailable_TRADE",component:"p"})):this.props.isAvailable?this._renderDeposit():r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(s.a,{className:"txtlabel cancel",content:"gateway.unavailable",component:"p"}))):null}}]),t}(r.a.Component);T.propTypes={sender:c.a.ChainAccount.isRequired,asset:c.a.ChainAsset.isRequired},T=Object(l.a)(T);var N=function(e){function t(){return x(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return P(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.preferredBridge,a=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,["preferredBridge"]),n=this.props.bridges.get(this.props.preferredBridge);return n||(t=(n=this.props.bridges.first()).inputCoinType),r.a.createElement(T,S({hideModal:this.props.hideModal},a,{preferredBridge:t},n.toJS()))}}]),t}(r.a.Component);N=Object(v.a)(N,{listenTo:function(){return[_.a]},getProps:function(){return{preferredBridge:_.a.getState().viewSettings.get("preferredBridge","btc")}}});var B=function(e){function t(){return x(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return P(t,e),A(t,[{key:"render",value:function(){return this.props.bridges?r.a.createElement(C.Modal,{title:h.a.translate("modal.buy.title"),visible:this.props.visible,onCancel:this.props.hideModal,footer:[r.a.createElement(C.Button,{key:"cancel",onClick:this.props.hideModal},h.a.translate("modal.close"))]},r.a.createElement(N,S({},this.props,{open:this.props.visible}))):null}}]),t}(r.a.Component);t.a=B},2088:function(e,t,a){"use strict";var n=a(2025),r=a(0),o=a.n(r),s=a(9),i=a.n(s),l=a(2040),c=a.n(l),u=a(16),p=a(2),d=a.n(p),h=a(27),m=a(30),f=a(35),b=a(127),g=a(44),y=a(48),v=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),v(t,[{key:"render",value:function(){return this.props.account?o.a.createElement("span",null,this.props.account.get("name")):null}}]),t}(o.a.Component);E.propTypes={account:g.a.ChainObject.isRequired},E.defaultProps={autosubscribe:!1};var w=Object(y.a)(E),C=a(34),S=a(82),A=a(22),x=a(885),O=a(4),P=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var T=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.statsInterval=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),P(t,[{key:"_onClick",value:function(e){"/market/"+e!==this.props.location.pathname&&(S.a.switchMarket(),this.props.history.push("/market/"+e))}},{key:"componentDidMount",value:function(){this.statsChecked=new Date,this.statsInterval=S.a.getMarketStatsInterval(35e3,this.props.base,this.props.quote)}},{key:"componentWillUnmount",value:function(){this.statsInterval&&this.statsInterval()}},{key:"shouldComponentUpdate",value:function(e){return!u.a.are_equal_shallow(e,this.props)}},{key:"_onStar",value:function(e,t,a){a.preventDefault(),this.props.starred?A.a.removeStarMarket(e,t):A.a.addStarMarket(e,t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.quote,n=t.base,r=(t.noSymbols,t.stats),s=t.starred;if(!a||!n)return null;var i=a.get("symbol")+"_"+n.get("symbol"),l=a.get("symbol")+":"+n.get("symbol"),c=this.props.getDynamicObject(a.get("dynamic_asset_data_id")),p=this.props.getDynamicObject(n.get("dynamic_asset_data_id")),d=u.a.convertPrice(a,n),h={};this.props.leftAlign&&(h.textAlign="left");var m="button outline",b=null;this.props.compact&&(m+=" no-margin",b={marginBottom:0,fontSize:"0.75rem",padding:"4px 10px",borderRadius:"0px",letterSpacing:"0.05rem"});var g=this.props.columns.map((function(t){switch(t.name){case"star":var h=s?"gold-star":"grey-star";return o.a.createElement("td",{onClick:e._onStar.bind(e,a.get("symbol"),n.get("symbol")),key:t.index},o.a.createElement(C.a,{className:h,name:"fi-star",title:"icons.fi_star.symbol"}));case"vol":var g=r?r.volumeBase:0;return o.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right",key:t.index},u.a.format_volume(g));case"change":var y=u.a.format_number(r&&r.change?r.change:0,2),v="0.00"===y?"":y>0?"change-up":"change-down";return o.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right "+v,key:t.index},y+"%");case"marketName":return o.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},o.a.createElement("div",{className:m,style:b},l));case"market":return o.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},e.props.name);case"price":var _=r&&r.price?r.price.toReal():r&&r.close&&r.close.quote.amount&&r.close.base.amount?u.a.get_asset_price(r.close.quote.amount,a,r.close.base.amount,n,!0):u.a.get_asset_price(d.quote.amount,a,d.base.amount,n,!0),k=6;return-1!==["BTC","OPEN.BTC","TRADE.BTC","GOLD","SILVER"].indexOf(n.get("symbol"))&&(k=8),o.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right",key:t.index},u.a.format_number(_,_>1e3?0:_>10?2:k));case"quoteSupply":return o.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},c?o.a.createElement(f.a,{style:{fontWeight:"bold"},amount:parseInt(c.get("current_supply"),10),asset:a.get("id")}):null);case"baseSupply":return o.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},p?o.a.createElement(f.a,{style:{fontWeight:"bold"},amount:parseInt(p.get("current_supply"),10),asset:n.get("id")}):null);case"issuer":return o.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},o.a.createElement(w,{account:a.get("issuer")}));case"add":return o.a.createElement("td",{style:{textAlign:"right"},key:t.index,onClick:e.props.onCheckMarket.bind(e,i)},o.a.createElement(O.Tooltip,{title:e.props.isDefault?"This market is a default market and cannot be removed":null},o.a.createElement("input",{type:"checkbox",checked:!!e.props.isChecked||e.props.isDefault,disabled:e.props.isDefault})));case"remove":return o.a.createElement("td",{key:t.index,className:"clickable",onClick:e.props.removeMarket},o.a.createElement("span",{style:{marginBottom:"6px",marginRight:"6px",zIndex:999},className:"text float-right remove"},"–"))}})).sort((function(e,t){return e.key>t.key})),y="clickable";return this.props.current&&(y+=" activeMarket"),o.a.createElement("tr",{className:y,style:h},g)}}]),t}(o.a.Component);T.defaultProps={noSymbols:!1},T=Object(x.a)(T);var N=Object(b.a)(T,{propNames:["quote","base"],defaultProps:{tempComponent:"tr"},withDynamic:!0}),B=a(21),M=a(197),F=a(594),j=a(97),I=a(472),q=a(3),R=a.n(q),L=a(2039),D=a(5),V=a.n(D),z=a(41),U=a(6),H=a(591),W=a.n(H),G=(a(148),a(88)),Q=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var K=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={backingAsset:"",error:!1,valid:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Q(t,[{key:"_onMoveUp",value:function(e){var t=this.props.quotes.findIndex((function(t){return t===e}));A.a.modifyPreferedBases({oldIndex:t,newIndex:t-1})}},{key:"_onMoveDown",value:function(e){var t=this.props.quotes.findIndex((function(t){return t===e}));A.a.modifyPreferedBases({oldIndex:t,newIndex:t+1})}},{key:"_onRemove",value:function(e){var t=this.props.quotes.findIndex((function(t){return t===e}));t>=0&&A.a.modifyPreferedBases({remove:t})}},{key:"_onAdd",value:function(e){-1===this.props.quotes.findIndex((function(t){return t===e.get("symbol")}))&&A.a.modifyPreferedBases({add:e.get("symbol")})}},{key:"_onInputBackingAsset",value:function(e){this.setState({backingAsset:e.toUpperCase(),error:null})}},{key:"_onFoundBackingAsset",value:function(e){e&&(this.props.quotes.includes(e.get("symbol"))?this.setState({error:"Asset already being used",isValid:!1}):this.setState({isValid:!0}))}},{key:"render",value:function(){var e=this,t=this.state.error,a=this.props.quotes.size;return o.a.createElement(O.Modal,{title:V.a.translate("exchange.quote_selection"),closable:!1,visible:this.props.visible,id:"quote_selection",overlay:!0,onCancel:this.props.hideModal,footer:[o.a.createElement(O.Button,{onClick:this.props.hideModal},V.a.translate("modal.close"))]},o.a.createElement("section",{className:"no-border-bottom"},o.a.createElement("table",{className:"table"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null),o.a.createElement("th",null,o.a.createElement(d.a,{content:"account.quote"})),o.a.createElement("th",{style:{textAlign:"center"}},o.a.createElement(d.a,{content:"exchange.move_down"})),o.a.createElement("th",{style:{textAlign:"center"}},o.a.createElement(d.a,{content:"exchange.move_up"})),o.a.createElement("th",{style:{textAlign:"center"}},o.a.createElement(d.a,{content:"exchange.remove"})))),o.a.createElement("tbody",null,this.props.quotes.map((function(t,n){return o.a.createElement("tr",{key:t},o.a.createElement("td",null,n+1),o.a.createElement("td",null,t),o.a.createElement("td",{className:"text-center"},n!==a-1&&o.a.createElement(C.a,{onClick:e._onMoveDown.bind(e,t),name:"chevron-down",className:"clickable"})),o.a.createElement("td",{className:"text-center"},0!==n&&o.a.createElement(C.a,{onClick:e._onMoveUp.bind(e,t),name:"chevron-down",className:"clickable rotate180"})),o.a.createElement("td",{className:"text-center"},a>1&&o.a.createElement(C.a,{onClick:e._onRemove.bind(e,t),name:"cross-circle",className:"clickable"})))})))),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement(L.a,{label:"exchange.custom_quote",onChange:this._onInputBackingAsset.bind(this),asset:this.state.backingAsset,assetInput:this.state.backingAsset,tabIndex:1,style:{width:"100%",paddingRight:"10px"},onFound:this._onFoundBackingAsset.bind(this),onAction:this._onAdd.bind(this),action_label:"exchange.add_quote",disableActionButton:!!t,noLabel:!0}),o.a.createElement("div",{className:"error-area"},t))))}}]),t}(o.a.Component),J=a(2026),Y=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ee(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var te=function(e){function t(e){X(this,t);var a=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state=a._getInitialState(e),a}return ee(t,e),Z(t,[{key:"_getInitialState",value:function(e){var t=!!e.findMarketTab||e.viewSettings.get("myMarketsBase_"+e.index);return{open:void 0===t||t,inverseSort:e.viewSettings.get("myMarketsInvert",!0),sortBy:e.viewSettings.get("myMarketsSort","volume")}}},{key:"componentWillReceiveProps",value:function(e){e.findMarketTab!==this.props.findMarketTab&&this.setState(this._getInitialState(e))}},{key:"shouldComponentUpdate",value:function(e,t){return!e.markets||!this.props.markets||(!u.a.are_equal_shallow(t,this.state)||!u.a.are_equal_shallow(e.markets,this.props.markets)||e.starredMarkets!==this.props.starredMarkets||e.marketStats!==this.props.marketStats||e.userMarkets!==this.props.userMarkets)}},{key:"_inverseSort",value:function(){A.a.changeViewSetting({myMarketsInvert:!this.state.myMarketsInvert}),this.setState({inverseSort:!this.state.inverseSort})}},{key:"_changeSort",value:function(e){e!==this.state.sortBy?(A.a.changeViewSetting({myMarketsSort:e}),this.setState({sortBy:e})):this._inverseSort()}},{key:"_onToggle",value:function(){if(!this.props.findMarketTab){var e=!this.state.open;this.setState({open:e});var t={};t["myMarketsBase_"+this.props.index]=e,A.a.changeViewSetting(t)}}},{key:"_onToggleUserMarket",value:function(e){var t=e.split("_"),a=Y(t,2),n=a[0],r=a[1],o=!this.props.userMarkets.get(e);A.a.setUserMarket(n,r,o)}},{key:"render",value:function(){var e=this,t=this.props,a=t.columns,n=t.markets,r=t.base,s=t.marketStats,i=t.starredMarkets,l=t.current,c=this.state,u=c.sortBy,p=c.inverseSort,h=c.open;if(!n||!n.length)return null;var m=a.map((function(t){switch(t.name){case"market":return o.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"name")},o.a.createElement(d.a,{content:"exchange.market"}));case"vol":return o.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"volume"),style:{textAlign:"right"}},o.a.createElement(d.a,{content:"exchange.vol_short"}));case"price":return o.a.createElement("th",{key:t.name,style:{textAlign:"right"}},o.a.createElement(d.a,{content:"exchange.price"}));case"quoteSupply":return o.a.createElement("th",{key:t.name},o.a.createElement(d.a,{content:"exchange.base_supply"}));case"baseSupply":return o.a.createElement("th",{key:t.name},o.a.createElement(d.a,{content:"exchange.quote_supply"}));case"change":return o.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"change"),style:{textAlign:"right"}},o.a.createElement(d.a,{content:"exchange.change"}));case"issuer":return o.a.createElement("th",{key:t.name},o.a.createElement(d.a,{content:"explorer.assets.issuer"}));case"add":return o.a.createElement("th",{key:t.name,style:{textAlign:"right"}},o.a.createElement(d.a,{content:"account.perm.confirm_add"}));default:return o.a.createElement("th",{key:t.name})}})),f=n.map((function(t){return e.props.onlyLiquid&&s.get(t.id)&&0==s.get(t.id).volumeBase?null:o.a.createElement(N,{key:t.id,name:"others"===r?o.a.createElement("span",null,o.a.createElement(j.a,{name:t.quote}),":",o.a.createElement(j.a,{name:t.base})):o.a.createElement(j.a,{dataPlace:"left",name:t.quote}),quote:t.quote,base:t.base,columns:a,leftAlign:!0,compact:!0,noSymbols:!0,stats:s.get(t.id),starred:i.has(t.id),current:l===t.id,isChecked:e.props.userMarkets.has(t.id),isDefault:e.props.defaultMarkets&&e.props.defaultMarkets.has(t.id),onCheckMarket:e._onToggleUserMarket.bind(e),location:e.props.location,history:e.props.history})})).filter((function(e){return null!==e})).sort((function(e,t){var a=e.key.split("_"),n=t.key.split("_"),r=s.get(a[0]+"_"+a[1]),o=s.get(n[0]+"_"+n[1]);switch(u){case"name":return a[0]>n[0]?p?-1:1:a[0]<n[0]?p?1:-1:a[1]>n[1]?p?-1:1:a[1]<n[1]?p?1:-1:0;case"volume":return r&&o?p?o.volumeBase-r.volumeBase:r.volumeBase-o.volumeBase:0;case"change":return r&&o?p?o.change-r.change:r.change-o.change:0}}));return o.a.createElement("div",{style:{paddingRight:10}},h?o.a.createElement("table",{className:"table table-hover text-right"},o.a.createElement("thead",null,o.a.createElement("tr",null,m)),f&&f.length?o.a.createElement("tbody",null,f):null):null)}}]),t}(o.a.Component);te.defaultProps={maxRows:20,onlyLiquid:!1};var ae=function(e){function t(e){X(this,t);var a=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.clearInput=function(){a.setState({myMarketFilter:""})},a.handleSearchUpdate=function(e){a.setState({myMarketFilter:e.target.value&&e.target.value.toUpperCase()})},a.state={isQuoteModalVisible:!1,inverseSort:e.viewSettings.get("myMarketsInvert",!0),sortBy:e.viewSettings.get("myMarketsSort","volume"),activeTab:e.viewSettings.get("favMarketTab","my-market"),activeMarketTab:e.viewSettings.get("activeMarketTab",0),lookupQuote:null,lookupBase:null,inputValue:"",minWidth:"100%",findBaseInput:"BTS",activeFindBase:"BTS"},a._setMinWidth=a._setMinWidth.bind(a),a.getAssetList=Object(n.a)(I.a.getAssetList.defer,150),a.showQuoteModal=a.showQuoteModal.bind(a),a.hideQuoteModal=a.hideQuoteModal.bind(a),a}return ee(t,e),Z(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.activeTab!==t.activeTab?this._changeTab(t.activeTab):e.tabHeader||this.state.activeTab===e.activeTab||this._changeTab(e.activeTab),!(i.a.is(e.searchAssets,this.props.searchAssets)&&i.a.is(e.markets,this.props.markets)&&i.a.is(e.starredMarkets,this.props.starredMarkets)&&i.a.is(e.defaultMarkets,this.props.defaultMarkets)&&i.a.is(e.marketStats,this.props.marketStats)&&u.a.are_equal_shallow(t,this.state)&&e.current===this.props.current&&e.minWidth===this.props.minWidth&&e.listHeight===this.props.listHeight&&e.preferredBases===this.props.preferredBases&&e.onlyStars===this.props.onlyStars&&e.onlyLiquid===this.props.onlyLiquid&&e.assetsLoading===this.props.assetsLoading&&e.userMarkets===this.props.userMarkets)}},{key:"componentWillMount",value:function(){if(this.props.setMinWidth&&window.addEventListener("resize",this._setMinWidth,{capture:!1,passive:!0}),this.props.currrent){var e=this.props.current.split("_")[1],t=this.props.preferredBases.findIndex((function(t){return t===e}));-1!==t&&t!==this.state.activeMarketTab&&this.setState({activeMarketTab:t})}}},{key:"componentDidMount",value:function(){var e=this,t=this.refs.favorites;c.a.initialize(t),this._setMinWidth(),this.state.activeTab!==this.props.activeTab&&setTimeout((function(){e._changeTab(e.props.activeTab)}),100)}},{key:"componentWillUnmount",value:function(){this.props.setMinWidth&&window.removeEventListener("resize",this._setMinWidth),clearTimeout(this.timer)}},{key:"componentWillReceiveProps",value:function(e){this.props.myMarketTab&&!e.myMarketTab&&this.refs.findSearchInput&&this.refs.findSearchInput.focus()}},{key:"hideQuoteModal",value:function(){this.setState({isQuoteModalVisible:!1})}},{key:"showQuoteModal",value:function(){this.setState({isQuoteModalVisible:!0})}},{key:"_setMinWidth",value:function(){this.props.setMinWidth&&this.refs.favorites&&"my-market"===this.props.activeTab&&this.state.minWidth!==this.refs.favorites.offsetWidth&&this.setState({minWidth:this.refs.favorites.offsetWidth})}},{key:"componentDidUpdate",value:function(){if(this.refs.favorites){var e=this.refs.favorites;c.a.update(e)}}},{key:"_inverseSort",value:function(){A.a.changeViewSetting({myMarketsInvert:!this.state.myMarketsInvert}),this.setState({inverseSort:!this.state.inverseSort})}},{key:"_changeSort",value:function(e){e!==this.state.sortBy?(A.a.changeViewSetting({myMarketsSort:e}),this.setState({sortBy:e})):this._inverseSort()}},{key:"_goMarkets",value:function(){this.props.history.push("/markets")}},{key:"_changeTab",value:function(e){A.a.changeViewSetting({favMarketTab:e}),this.setState({activeTab:e}),this._setMinWidth()}},{key:"_onInputName",value:function(e,t){var a=this,n=t.target.value.trim().toUpperCase(),r=!U.ChainValidation.is_valid_symbol_error(n,!0);this.setState({inputValue:n}),n&&n.length>=2&&!r||(this.state.inputValue!==n&&this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){a._lookupAssets(n,e)}),1500))}},{key:"_lookupAssets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e||""===e){var a=e.toUpperCase().split(":"),n=a[0],r=2===a.length?a[1]:null;this.setState({lookupQuote:n,lookupBase:r}),A.a.changeViewSetting.defer({marketLookupInput:e.toUpperCase()}),this.getAssetList(n,50,t)}}},{key:"toggleActiveMarketTab",value:function(e){A.a.changeViewSetting({activeMarketTab:e}),this.setState({activeMarketTab:e})}},{key:"_onInputBaseAsset",value:function(e){this.setState({findBaseInput:e.toUpperCase(),error:null})}},{key:"_onFoundBaseAsset",value:function(e){e&&this.setState({activeFindBase:e.get("symbol")})}},{key:"_getMarkets",value:function(){var e=this.props,t=e.searchAssets,a=e.defaultMarkets,n=e.onlyStars,r=e.userMarkets,o=e.preferredBases,s=e.starredMarkets,l=this.state,c=l.activeTab,u=l.lookupQuote,p=l.lookupBase,d=l.myMarketFilter,h=l.activeMarketTab,m=Object(G.d)(o),f=this._getBases(),b=[],g={},y=[],v="my-market"===c;t.size&&t.filter((function(e){try{if(e.options.description){var t=JSON.parse(e.options.description);if("visible"in t&&!t.visible)return!1}}catch(e){}return-1!==e.symbol.indexOf(u)&&e.symbol.length>=u.length})).forEach((function(e){f.forEach((function(t){var a=e.symbol+"_"+t;t!==e.symbol&&b.push([a,{quote:e.symbol,base:t}])}))})),b=b.filter((function(e){return!p||e[1].quote===u}));var _=v?a:i.a.Map(b);function k(e,t,a,r,i){return{otherMarkets:a.filter((function(e){if(e.base===e.quote)return!1;if(v){var t=e.quote+"_"+e.base;return d?-1!==t.indexOf(d):!(n&&!s.has(t))}return!(u.length<1)&&-1!==e.quote.indexOf(u)})).map((function(a){var n=a.quote+"_"+a.base;if(-1!==t.indexOf(a.base)){r[e]||(r[e]=[]);var s={id:n,quote:a.quote,base:a.base};return r[e].find((function(e){return e.id===n}))||r[e].push(s),null}if(!o.includes(a.base)&&-1===m.indexOf(a.base))return{id:n,quote:a.quote,base:a.base}})).filter((function(e){return!!e})).take(v?100:20).toArray().concat(i),baseGroups:r}}if(v&&r.size&&r.forEach((function(e,t){_.has(t)||(_=_.set(t,e))})),_.size>0){var E=v?o.get(h):this.state.activeFindBase,w=k(E,[E],_,g,y);y=w.otherMarkets,g=w.baseGroups,G.c.forEach((function(e){var t=e+"."+E;if(U.ChainStore.getAsset(t)){var a=_.map((function(e){if(e.quote===e.base)return null;var a=e.quote+"_"+t;return _.has(a)?null:{base:t,quote:e.quote}}),{}).filter((function(e){return!!e})),n=k(E,[E,t],a,g,y);y=n.otherMarkets,g=n.baseGroups}}))}return{baseGroups:g,otherMarkets:y}}},{key:"_getBases",value:function(){var e=this.props,t=e.preferredBases,a=e.searchAssets,n=this.state,r=n.lookupQuote,o=n.lookupBase,s=a.filter((function(e){return o&&o.length?0===e.symbol.indexOf(o):-1!==e.symbol.indexOf(r)})).map((function(e){if(o&&o.length){if(0===e.symbol.indexOf(o))return e.symbol}else if(t.includes(e.symbol)&&e.symbol.length>=r.length&&e.symbol.length<r.length+3)return e.symbol})).filter((function(e){return!!e})).toArray();return s=(s=s.concat(t.filter((function(e){return!o||!o.length||0===e.indexOf(o)})).toArray())).filter((function(e){return!(o&&o.length>1)||0===e.indexOf(o)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.starredMarkets,r=t.marketStats,s=t.columns,i=t.assetsLoading,l=t.preferredBases,c=t.current,u=t.viewSettings,p=t.listHeight,m=this.state,f=m.activeMarketTab,b="my-market"===m.activeTab,g=l.map((function(e){return e}));b||(l=(l=l.clear()).push(this.state.activeFindBase)),b||(f=0);var y=this._getMarkets(),v=y.baseGroups,_=y.otherMarkets,k=_&&_.length,E="mymarkets-header clickable",w=R()(E,{inactive:!b}),C=R()(E,{inactive:b}),x={minWidth:this.state.minWidth,minHeight:"6rem"};p&&(x.height=p);var O=a(5);return o.a.createElement("div",{className:this.props.className,style:this.props.style},this.props.tabHeader?o.a.createElement("div",{style:this.props.headerStyle,className:"grid-block shrink left-orderbook-header bottom-header"},o.a.createElement("div",{ref:"myMarkets",className:w,onClick:this._changeTab.bind(this,"my-market"),"data-intro":O.translate("walkthrough.my_markets_tab")},o.a.createElement(d.a,{content:"exchange.market_name"})),o.a.createElement("div",{className:C,onClick:this._changeTab.bind(this,"find-market"),"data-intro":O.translate("walkthrough.find_markets_tab")},o.a.createElement(d.a,{content:"exchange.more"}))):null,this.props.noHeader||this.props.tabHeader?null:o.a.createElement("div",{style:this.props.headerStyle},o.a.createElement("div",{className:"exchange-content-header"},o.a.createElement("span",null,o.a.createElement(d.a,{content:"exchange.market_name"})))),this.props.controls?o.a.createElement("div",{className:"small-12 medium-6",style:{padding:"1rem 0"}},this.props.controls?o.a.createElement("div",{style:{paddingBottom:"0.5rem"}},this.props.controls):null):null,b?o.a.createElement("div",{className:"grid-block vertical shrink",style:{width:"100%",textAlign:"left",padding:"0 0.5rem 0.75rem 0.5rem"}},o.a.createElement("div",null,o.a.createElement("label",{style:{margin:"3px 0 0"}},o.a.createElement("input",{style:{position:"relative",top:3},className:"no-margin",type:"checkbox",checked:this.props.onlyLiquid,onChange:function(){A.a.changeViewSetting({onlyLiquid:!e.props.onlyLiquid})}}),o.a.createElement("span",{style:{paddingLeft:"0.4rem"}},o.a.createElement(d.a,{content:"exchange.show_only_liquid"}))),o.a.createElement("label",{style:{margin:"3px 0 0"}},o.a.createElement("input",{style:{position:"relative",top:3},className:"no-margin",type:"checkbox",checked:this.props.onlyStars,onChange:function(){S.a.toggleStars()}}),o.a.createElement("span",{style:{paddingLeft:"0.4rem"}},o.a.createElement(h.a,{string:"exchange.show_only_star_formatter",keys:[{type:"icon",value:"fi-star",className:"gold-star",arg:"star_icon"}]}))),o.a.createElement("br",null)),o.a.createElement("div",{className:"search-wrapper"},o.a.createElement("form",null,o.a.createElement("div",{className:"filter inline-block"},o.a.createElement(J.a,{style:{fontSize:"0.9rem",height:"inherit",position:"relative"},className:"no-margin market-filter-input",value:this.state.myMarketFilter,onChange:this.handleSearchUpdate}))))):o.a.createElement("div",{style:{width:"100%",textAlign:"left",padding:"0.75rem 0.5rem"}},o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",{style:{width:"100%"}},o.a.createElement("td",null,o.a.createElement(L.a,{onAssetSelect:this._onFoundBaseAsset.bind(this),assets:g,onChange:this._onInputBaseAsset.bind(this),asset:this.state.findBaseInput,assetInput:this.state.findBaseInput,tabIndex:1,style:{width:"100%",paddingBottom:"1.5rem"},onFound:this._onFoundBaseAsset.bind(this),label:"exchange.quote",noLabel:!0,inputStyle:{fontSize:"0.9rem"}}))),o.a.createElement("tr",{style:{width:"100%"}},o.a.createElement("td",null,o.a.createElement("label",null,o.a.createElement(d.a,{content:"account.user_issued_assets.name"}),":"),o.a.createElement("input",{style:{fontSize:"0.9rem",position:"relative",top:1},type:"text",value:this.state.inputValue,onChange:this._onInputName.bind(this,!0),placeholder:V.a.translate("exchange.search"),maxLength:16,tabIndex:2,ref:"findSearchInput"}),this.state.assetNameError?o.a.createElement("div",{className:"error-area",style:{paddingTop:10}},o.a.createElement("span",{style:{wordBreak:"break-all"}},o.a.createElement(d.a,{content:"explorer.asset.invalid",name:this.state.inputValue}))):null))))),o.a.createElement("ul",{className:"mymarkets-tabs",style:{marginBottom:0}},b&&o.a.createElement("li",{key:"quote_edit",style:{textTransform:"uppercase"},onClick:this.showQuoteModal,className:"mymarkets-tab"}," + "),b||this.state.inputValue?l.map((function(t,a){return t?o.a.createElement("li",{key:t,onClick:e.toggleActiveMarketTab.bind(e,a),className:R()("mymarkets-tab",{active:f===a})},t):null})):null,b&&k?o.a.createElement("li",{key:"others",style:{textTransform:"uppercase"},onClick:this.toggleActiveMarketTab.bind(this,l.size+1),className:R()("mymarkets-tab",{active:f===l.size+1})},o.a.createElement(d.a,{content:"exchange.others"})):null),o.a.createElement("div",{style:x,className:"table-container grid-block vertical mymarkets-list",ref:"favorites"},i?o.a.createElement("div",{style:{position:"absolute",paddingTop:"3rem",textAlign:"center",width:"100%"}},o.a.createElement(z.a,{type:"three-bounce"})):null,l.filter((function(e){return e===l.get(f)})).map((function(t,a){return o.a.createElement(te,{userMarkets:e.props.userMarkets,defaultMarkets:e.props.defaultMarkets,index:a,allowChange:!1,key:t,current:c,starredMarkets:n,marketStats:r,viewSettings:u,columns:b?s:e.props.findColumns||s,markets:v[t],base:t,maxRows:b?20:10,findMarketTab:!b,location:e.props.location,history:e.props.history,onlyLiquid:e.props.onlyLiquid&&b})})),f===l.size+1&&b&&k?o.a.createElement(te,{userMarkets:this.props.userMarkets,index:l.size,current:c,starredMarkets:n,marketStats:r,viewSettings:u,columns:s,markets:_,base:"others",maxRows:b?20:10,findMarketTab:!b,location:this.props.location,history:this.props.history}):null),o.a.createElement(K,{visible:this.state.isQuoteModalVisible,hideModal:this.hideQuoteModal,showModal:this.showQuoteModal,quotes:this.props.preferredBases}))}}]),t}(o.a.Component);ae.defaultProps={activeTab:"my-market",setMinWidth:!1},ae=W()(ae,50,{leading:!1});var ne=function(e){function t(){return X(this,t),$(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return ee(t,e),Z(t,[{key:"render",value:function(){return o.a.createElement(ae,this.props)}}]),t}(o.a.Component);t.a=Object(m.a)(ne,{listenTo:function(){return[B.a,M.a,F.a]},getProps:function(){return{starredMarkets:B.a.getState().starredMarkets,onlyLiquid:B.a.getState().viewSettings.get("onlyLiquid",!0),defaultMarkets:B.a.getState().defaultMarkets,viewSettings:B.a.getState().viewSettings,preferredBases:B.a.getState().preferredBases,marketStats:M.a.getState().allMarketStats,userMarkets:B.a.getState().userMarkets,searchAssets:F.a.getState().assets,onlyStars:M.a.getState().onlyStars,assetsLoading:F.a.getState().assetsLoading}}})},2089:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(9),s=a.n(o),i=a(1),l=a.n(i),c=a(2),u=a.n(c),p=a(97),d=a(102),h=(a(44),a(127)),m=a(82),f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return b(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),f(t,[{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote;if(t.get("id")===a.get("id"))return null;var n=a.get("symbol")+"_"+t.get("symbol"),o=r.a.createElement("span",null,r.a.createElement(p.a,{name:a.get("symbol")})," /"," ",r.a.createElement(p.a,{name:t.get("symbol")}));return r.a.createElement(d.a,{to:"/market/"+n,onClick:function(){return m.a.switchMarket()}},o)}}]),t}(r.a.Component),v=y=Object(h.a)(y,{propNames:["quote","base"],defaultProps:{base:"1.3.0"}}),_=a(371),k=a(87),E=a(20),w=a(5),C=a.n(w),S=a(6),A=a(593),x=a(15),O=a(40),P=a(112),T=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var F=function(e){return function(e){var t=Object(h.a)(e,{propNames:["shortBackingAsset"]});return Object(h.a)((function(e){return r.a.createElement(t,N({},e,{shortBackingAsset:e.asset.getIn(["bitasset","options","short_backing_asset"])}))}))}(function(t){function a(){var e,t,n;B(this,a);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=n=M(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(o))),n.state={worthLessSettlement:void 0},M(n,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),T(a,[{key:"updateFlag",value:function(){var e=this,t=this.props,a=t.asset,n=t.shortBackingAsset,r=a.get("id"),o=n.get("id"),s=x.Apis.instance().db_api().exec("get_order_book",[o,r,1]).then((function(e){return 0===e.bids.length?0:Number(e.bids[0].price)})),i=null,l=1;a.get("bitasset")&&a.get("bitasset").get("settlement_fund")>0?i=a.get("bitasset").get("settlement_price"):(i=P.a.extractRawFeedPrice(a),l=1-a.get("bitasset").get("options").get("force_settlement_offset_percent")/1e4);var c=new O.i({base:new O.a({asset_id:o,amount:i.getIn(["quote","amount"]),preicision:n.get("precision")}),quote:new O.a({asset_id:r,amount:i.getIn(["base","amount"]),precision:a.get("precision")})}).toReal()*l;s.then((function(t){return e.setState({worthLessSettlement:t>c,marketPrice:t,settlementPrice:c})}))}},{key:"componentWillMount",value:function(){this.updateFlag()}},{key:"componentDidUpdate",value:function(){this.updateFlag()}},{key:"render",value:function(){var t=this.props,a=this.state,n=a.worthLessSettlement,o=a.marketPrice,s=a.settlementPrice;return r.a.createElement(e,N({},t,{worthLessSettlement:n,marketPrice:o,settlementPrice:s}))}}]),a}(n.PureComponent))},j=a(27),I=a(4),q=a(16),R=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var z=F((function(e){var t=e.worthLessSettlement,a=e.asset,n=e.shortBackingAsset,o=e.marketPrice,s=e.settlementPrice;switch(o=q.a.format_number(o,a.get("precision")),s=q.a.format_number(s,a.get("precision")),t){case!0:return r.a.createElement("div",null,r.a.createElement(u.a,{component:"h2",content:"exchange.settle_better_marketprice"}),r.a.createElement("span",null,r.a.createElement(j.a,{string:"exchange.worth_less_settlement_warning",keys:[{value:r.a.createElement(v,{base:a.get("id"),quote:n.get("id")}),arg:"market_link"}]}),r.a.createElement("br",null),"  ",r.a.createElement(u.a,{content:"exchange.price_market"}),":  ",o,r.a.createElement("br",null),"  ",r.a.createElement(u.a,{content:"exchange.settle"}),":  ",s));case void 0:return r.a.createElement(u.a,{content:"exchange.checking_for_worth_less_settlement"});default:return r.a.createElement("div",null,r.a.createElement(u.a,{component:"h2",content:"exchange.settle_better_settleprice"}),r.a.createElement("span",null,r.a.createElement(j.a,{string:"exchange.settlement_hint",keys:[{value:r.a.createElement(v,{base:a.get("id"),quote:n.get("id")}),arg:"market_link"},{value:r.a.createElement(p.a,{name:a.get("symbol")}),arg:"long"}]}),r.a.createElement("br",null),"  ",r.a.createElement(u.a,{content:"exchange.price_market"}),":  ",o,r.a.createElement("br",null),"  ",r.a.createElement(u.a,{content:"exchange.settle"}),":  ",s))}})),U=function(e){function t(){L(this,t);var e=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={amount:0},e.onSubmit=e.onSubmit.bind(e),e}return V(t,e),R(t,[{key:"componentWillReceiveProps",value:function(e){e.asset&&this.props.asset&&e.asset.get("id")!==this.props.asset.get("id")&&this.setState({amount:0})}},{key:"getSettlementInfo",value:function(){var e=this.props,t=e.getDynamicObject,a=e.asset,n=e.core,r=t(a.get("dynamic_asset_data_id")),o=r&&r.size?r.get("current_supply"):0,s=n&&n.size?n.getIn(["parameters","maintenance_interval"]):0,i=a.get("bitasset").toJS(),l=i.force_settled_volume,c=o*(i.options.maximum_force_settlement_volume/1e4);return{maxSettlementVolume:c,remainingVolume:l?c-l:c,maintenanceInterval:s,settlementDelay:i.options.force_settlement_delay_sec}}},{key:"onAmountChanged",value:function(e){var t=e.amount;e.asset;this.setState({amount:t})}},{key:"onSubmit",value:function(e){var t=this.state.amount;e.preventDefault(),this.props.hideModal(),t=parseInt(t*Math.pow(10,this.props.asset.get("precision")));var a=k.a.new_transaction();return a.add_type_operation("asset_settle",{fee:{amount:0,asset_id:0},account:this.props.account.get("id"),amount:{amount:t,asset_id:this.props.asset.get("id")}}),E.a.process_transaction(a,null,!0).then((function(e){return!0})).catch((function(e){return console.error("asset settle error: ",e),!1}))}},{key:"_useMaxValue",value:function(e){this.setState({amount:e/Math.pow(10,this.props.asset.get("precision"))})}},{key:"render",value:function(){var e=this.props,t=e.asset,a=e.account,o=this.state.amount;if(!t)return null;var s=t&&t.getIn(["bitasset","options"])?t.getIn(["bitasset","options"]).toJS():null,i=t.get("bitasset").get("settlement_fund")>0,l=0;i||(l=t.get("bitasset").get("options").get("force_settlement_offset_percent")/100);var c=t.get("id"),p=a.get("balances"),d=q.a.replaceName(t),h=d.name,m=d.prefix,f=(m||"")+h,b=null,g=0;p&&p.forEach((function(e){var t=S.ChainStore.getObject(e);if(!t.get("balance"))return null;t.get("asset_type")===c&&(b=e,g=t.get("balance"))}));var y=r.a.createElement("span",null,r.a.createElement(u.a,{content:"exchange.balance"}),": ",b?r.a.createElement("span",{className:"underline",onClick:this._useMaxValue.bind(this,g)},r.a.createElement(_.a,{balance:b})):"0 "+t.get("symbol")),v=!1;o>g/Math.pow(10,this.props.asset.get("precision"))&&(v=!0);var k=[r.a.createElement(I.Tooltip,{title:v?C.a.translate("tooltip.lack_funds"):null},r.a.createElement(I.Button,{key:"submit",type:"primary",onClick:this.onSubmit,disabled:v},C.a.translate("modal.settle.submit"))),r.a.createElement(I.Button,{key:"close",onClick:this.props.hideModal},C.a.translate("modal.close"))],E=this.getSettlementInfo(),w=E.maxSettlementVolume,x=E.remainingVolume,O=E.settlementDelay,P=E.maintenanceInterval,T=i?0:(O+Math.floor(o/w)*P)/3600,N=t.getIn(["bitasset","is_prediction_market"]),B=N?r.a.createElement(I.Alert,{message:C.a.translate("tooltip.settle_market_prediction"),type:"info",showIcon:!0}):r.a.createElement(r.a.Fragment,null,i?r.a.createElement(I.Alert,{message:C.a.translate("exchange.settle_delay_globally_settled"),type:"warning",showIcon:!0}):r.a.createElement(I.Alert,{message:C.a.translate("exchange.settle_delay",{hours:s.force_settlement_delay_sec/3600}),description:T?C.a.translate("modal.settle.delay",{amount:T}):null,type:"info",showIcon:!0}),r.a.createElement(z,{asset:c}),r.a.createElement("br",null),i?null:r.a.createElement(u.a,{component:"div",content:"exchange.settle_offset",offset:l}),r.a.createElement("br",null),r.a.createElement(I.Form,{className:"full-width",layout:"vertical"},r.a.createElement(A.a,{label:"modal.settle.amount",amount:o,onChange:this.onAmountChanged.bind(this),display_balance:y,asset:c,assets:[c],tabIndex:1,style:o>x?{"margin-bottom":"0"}:{}}),o>x?r.a.createElement(n.Fragment,null,r.a.createElement(u.a,{className:"facolor-info",content:"modal.settle.max_volume",amount:w,asset:f}),r.a.createElement("br",null),r.a.createElement(u.a,{className:"facolor-info",content:"modal.settle.remaining_volume",amount:x,asset:f})):null));return r.a.createElement(I.Modal,{title:C.a.translate("modal.settle.title",{asset:f}),visible:this.props.visible,id:this.props.modalId,footer:N?null:k,onCancel:this.props.hideModal,overlay:!0,ref:"settlement_modal"},B)}}]),t}(r.a.Component);U.propTypes={asset:l.a.instanceOf(s.a.Map),core:l.a.instanceOf(s.a.Map),account:l.a.instanceOf(s.a.Map)},U.defaultProps={asset:s.a.Map(),core:s.a.Map(),account:s.a.Map()},U=Object(h.a)(U,{propNames:["asset","core"],withDynamic:!0,defaultProps:{core:"2.0.0"}});var H=function(e){function t(){return L(this,t),D(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return V(t,e),R(t,[{key:"render",value:function(){return r.a.createElement(U,this.props)}}]),t}(r.a.Component);t.a=H},2091:function(e,t,a){e.exports=a(173)},2095:function(e,t){e.exports={midnightTheme:{bidColor:"#50D2C2",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#6BA583",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#e0e0e0",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#191a1f",textColor:"#e0e0e0"},darkTheme:{bidColor:"#6BA583",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#258A14",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#e0e0e0",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#2a2a2a",textColor:"#ffffff"},lightTheme:{bidColor:"#258A14",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#EA340B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#528c0a",negativeColor:"rgba(225, 66, 74, 1)",strokeColor:"#000000",primaryText:"#242424",volumeColor:"#848484",tooltipBackgroundColor:"rgba(255,255,255, 0.9)",tooltipColor:"#000",tooltipFillColor:"#000",axisLabelsColor:"#000",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#848484",bgColor:"#fff",textColor:"#3d3d3d"}}},2136:function(e,t,a){"use strict";(function(e){var n=a(0),r=a.n(n),o=a(6),s=a(282),i=a(375),l=a(567),c=a(2091),u=a.n(c),p=a(2),d=a.n(p),h=a(4),m=a(5),f=a.n(m),b=a(168),g=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var y=1,v=function(t){function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.hasErrors=function(){var e=t.props.form.getFieldsValue(["line_items","memo","keys"]);return Object.keys(e).some((function(t){return"line_items"!==t?!e[t]:e.keys?e.keys.some((function(a){return!e[t][a].label||!e[t][a].price||!e[t][a].quantity})):void 0}))||!t.state.recipient_name},t.remove=function(e){var a=t.props.form,n=a.getFieldValue("keys");if(1!==n.length){var r=n.filter((function(t){return t!==e}));a.setFieldsValue({keys:r})}},t.add=function(){var e=t.props.form,a=e.getFieldValue("keys").concat(y++);e.setFieldsValue({keys:a})},t.state={invoice:null,invoiceData:null,recipient_name:null,recipient_name_account:null,currency:"BTS",defaultAssets:["BTS","CNY","USD"]},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),g(a,[{key:"componentDidMount",value:function(){this.setState({recipient_name:this.props.currentAccount.get("name")})}},{key:"_printInvoice",value:function(t){var a=this;this.props.validateFormat(t)&&Object(l.compress)(JSON.stringify(t),9,(function(n,r){var o=u.a.encode(e.from(n));a.setState({invoiceData:o}),console.log("Invoice data",t,o)}))}},{key:"componentWillReceiveProps",value:function(e,t){null==this.state.recipient_name&&this.props.currentAccount&&this.setState({recipient_name:this.props.currentAccount.get("name")})}},{key:"fromChanged",value:function(e){this.setState({recipient_name:e,recipient_name_account:null})}},{key:"onFromAccountChanged",value:function(e){this.setState({recipient_name_account:e})}},{key:"handleSubmit",value:function(e){var t=this,a=this.state.currency;e.preventDefault(),this.props.form.validateFields((function(e,n){if(!e){var r=n.line_items,o=n.memo,s=n.note,i=n.to_label;r=r.filter((function(e){return!!e})),t._printInvoice({currency:a,line_items:r,memo:o,note:s,to:t.state.recipient_name,to_label:i})}}))}},{key:"onChangeCurrency",value:function(e){var t=o.ChainStore.getAsset(e);this.setState({currency:t.get("symbol")})}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldValue,n=t.getFieldDecorator,o=this.state,l=o.currency,c=o.defaultAssets;n("keys",{initialValue:[0]});var u=a("keys"),p=r.a.createElement(r.a.Fragment,null,r.a.createElement(h.Row,{style:{marginTop:"0.5rem",marginBottom:"0.5rem"}},r.a.createElement(h.Col,{span:12},r.a.createElement(d.a,{component:"span",content:"invoice.request.items"})),r.a.createElement(h.Col,{span:5},r.a.createElement(d.a,{component:"span",content:"invoice.request.quantity"})),r.a.createElement(h.Col,{span:5},r.a.createElement(d.a,{component:"span",content:"invoice.request.price"})),r.a.createElement(h.Col,{span:2},r.a.createElement(d.a,{component:"span",content:"invoice.request.action"}))),u.map((function(t,a){return r.a.createElement(h.Form.Item,{key:t,style:{marginBottom:"0px"}},r.a.createElement(h.Input.Group,{compact:!0},r.a.createElement(h.Row,null,r.a.createElement(h.Col,{span:12},n("line_items["+t+"]label")(r.a.createElement(h.Input,null))),r.a.createElement(h.Col,{span:5},n("line_items["+t+"]quantity")(r.a.createElement(h.Input,{type:"number"}))),r.a.createElement(h.Col,{span:5},n("line_items["+t+"]price")(r.a.createElement(h.Input,{type:"number"}))),r.a.createElement(h.Col,{span:2},t==u[u.length-1]?r.a.createElement(h.Button,{type:"primary",icon:"plus-circle-o",onClick:function(){return e.add(t)}}):r.a.createElement(h.Button,{type:"primary",icon:"minus-circle-o",onClick:function(){return e.remove(t)}})))))}))),m=this.hasErrors();return r.a.createElement("div",{className:"merchant-protocol--request"},r.a.createElement(s.a,{className:"invoice-request-input",label:"invoice.request.recipient_account",accountName:this.state.recipient_name,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),account:this.state.recipient_name,typeahead:!0,size:32}),r.a.createElement(h.Form,{onSubmit:this.handleSubmit.bind(this),required:!0},r.a.createElement(h.Form.Item,{className:"invoice-request-input",label:r.a.createElement("span",null,f.a.translate("invoice.request.identifier"),r.a.createElement(h.Tooltip,{placement:"topLeft",title:f.a.translate("invoice.request.identifier_tooltip")}," ",r.a.createElement(h.Icon,{type:"question-circle",theme:"filled"})))},n("memo")(r.a.createElement(h.Input,null))),r.a.createElement(h.Form.Item,{className:"invoice-request-input",label:r.a.createElement("span",null,f.a.translate("invoice.request.payment_asset"),r.a.createElement(h.Tooltip,{placement:"topLeft",title:f.a.translate("invoice.request.payment_asset_tooltip")}," ",r.a.createElement(h.Icon,{type:"question-circle",theme:"filled"})))},r.a.createElement(i.a,{value:l,assets:c,onChange:this.onChangeCurrency.bind(this)})),r.a.createElement(h.Form.Item,{className:"invoice-request-input",label:r.a.createElement("span",null,f.a.translate("invoice.request.recipient_name"),r.a.createElement(h.Tooltip,{placement:"topLeft",title:f.a.translate("invoice.request.recipient_name_tooltip")}," ",r.a.createElement(h.Icon,{type:"question-circle",theme:"filled"})))},n("to_label")(r.a.createElement(h.Input,null))),r.a.createElement(h.Form.Item,{className:"invoice-request-input",label:r.a.createElement("span",null,f.a.translate("invoice.request.note"),r.a.createElement(h.Tooltip,{placement:"topLeft",title:f.a.translate("invoice.request.note_tooltip")}," ",r.a.createElement(h.Icon,{type:"question-circle",theme:"filled"})))},n("note")(r.a.createElement(h.Input.TextArea,{rows:3}))),p,r.a.createElement(h.Form.Item,null,r.a.createElement(h.Button,{type:"primary",htmlType:"submit",disabled:m},r.a.createElement(d.a,{content:"invoice.request.create_invoice_string"})))),this.state.invoiceData&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginTop:"2rem"}},r.a.createElement(h.Input.TextArea,{disabled:!0,rows:4,value:this.state.invoiceData})),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(b.a,{useDiv:!1,text:this.state.invoiceData}))))}}]),a}(r.a.Component);v=h.Form.create({name:"invoice_request"})(v),t.a=v}).call(this,a(126).Buffer)},2137:function(e,t,a){"use strict";(function(e){var n=a(0),r=a.n(n),o=a(35),s=a(42),i=a(282),l=a(371),c=a(6),u=a(237),p=a(76),d=a(567),h=a(2091),m=a.n(h),f=a(16),b=a(2138),g=a(2),y=a.n(g),v=a(4),_=a(283),k=a.n(_),E=a(5),w=a.n(E),C=a(2033),S=a(604),A=a(595),x=a.n(A),O=a(2140),P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},T=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function N(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(i)}("next")}))}}var B=function(t){function a(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n,r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return r.decompressRawData=function(e){return new Promise((function(t,a){Object(d.decompress)(e,(function(e,n){n?a(n):t(e)}))}))},r.handleRawInvoiceDataChange=function(e){var a=e.target.value.replace(/\s/g,"");r.setState({rawDataInputValue:a},N(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=m.a.decode(a),e.next=4,r.decompressRawData(n);case 4:o=e.sent,r.parseInvoiceData(o),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),r.setState({error:e.t0.message});case 12:case"end":return e.stop()}}),e,t,[[0,8]])}))))},r.handleQrScanSuccess=(n=N(regeneratorRuntime.mark((function e(a){var n,o,s=a.address;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=m.a.decode(s),e.next=4,r.decompressRawData(n);case 4:o=e.sent,r.parseInvoiceData(o),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),r.setState({error:e.t0.message});case 12:case"end":return e.stop()}}),e,t,[[0,8]])}))),function(e){return n.apply(this,arguments)}),r.state={invoice:null,pay_from_name:null,pay_from_account:null,pay_to_account:null,error:null,blockNum:null,invoiceQr:!1,rawDataInputValue:"",isRawDataInputVisible:!1},r.onBroadcastAndConfirm=r.onBroadcastAndConfirm.bind(r),r.getTotal=r.getTotal.bind(r),r}var n,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),T(a,[{key:"_printExampleInvoice",value:function(){Object(d.compress)(JSON.stringify({to:"sschiessl",to_label:"Stefan S.",currency:"BTS",memo:"Invoice #1234",line_items:[{label:"Something to Buy",quantity:1,price:"0.1"},{label:"10 things to Buy",quantity:10,price:"0.02"}],note:"Something the merchant wants to say to the user"}),9,(function(t,a){m.a;console.log(m.a.encode(e.from(t)))}))}},{key:"componentDidMount",value:(h=N(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.a.decode(this.props.match.params.data),p.a.unlisten(this.onBroadcastAndConfirm),p.a.listen(this.onBroadcastAndConfirm),e.prev=3,e.next=6,this.decompressRawData(t);case 6:return a=e.sent,e.next=9,this.parseInvoiceData(a);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.setState({isRawDataInputVisible:!0});case 14:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(){return h.apply(this,arguments)})},{key:"componentWillReceiveProps",value:function(e,t){if(null==this.state.pay_from_name&&this.props.currentAccount){var a=this._findPayment();this.setState({pay_from_name:this.props.currentAccount.get("name"),paymentOperation:a})}}},{key:"parseInvoiceData",value:(n=N(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=k()(t,{whiteList:[],stripIgnoreTag:!0}),a=JSON.parse(t),!this.props.validateFormat(a)){e.next=13;break}return e.next=6,Object(c.FetchChainObjects)(c.ChainStore.getAsset,[a.currency]);case 6:return n=e.sent,e.next=9,Object(c.FetchChain)("getAccount",a.to,void 0,(o={},s=a.to,i=!1,s in o?Object.defineProperty(o,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[s]=i,o));case 9:r=e.sent,this.setState({invoice:a,asset:n[0],pay_to_account:r,pay_from_name:this.props.currentAccount.get("name"),error:null,isRawDataInputVisible:!1},this.getTotal),e.next=14;break;case 13:this.setState({error:w.a.translate("invoice.invalid_format")});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),this.setState({error:e.t0.message});case 19:case"end":return e.stop()}var o,s,i}),e,this,[[0,16]])}))),function(e){return n.apply(this,arguments)})},{key:"parsePrice",value:function(e){var t=e.match(/([\d\,\.\s]+)/);return!t||t.length,parseFloat(t[1].replace(/[\,\s]/g,""))}},{key:"_findPayment",value:function(){var e=this;if(Object(C.b)(this.props.currentAccount)&&this.state.total_amount&&this.state.pay_to_account){var t=this.state.pay_to_account.get("id"),a=this.state.asset.get("id"),n=this.state.total_amount*Math.pow(10,this.state.asset.get("precision")),r=null;return this.props.currentAccount.get("history").toJS().forEach((function(o){var s=o.op;if(0==s[0]){s[1].from;var i=s[1].to,l=s[1].amount.amount,c=s[1].amount.asset_id;e.state.invoice;console.log(t,i,a,c,n,l),t==i&&a==c&&n==l&&(r=o)}})),r}}},{key:"getTotal",value:function(){var e=this,t=this.state.invoice.line_items;if(!t||0===t.length)return 0;var a=t.reduce((function(t,a){var n=e.parsePrice(a.price);return n?t+a.quantity*n:t}),0),n=this._findPayment();this.setState({total_amount:parseFloat(a.toFixed(this.state.asset.get("precision"))),paymentOperation:n})}},{key:"onBroadcastAndConfirm",value:function(e){e.included&&e.broadcasted_transaction&&(p.a.unlisten(this.onBroadcastAndConfirm),p.a.reset(),this.setState({blockNum:e.trx_block_num}))}},{key:"onPayClick",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.asset,r=a.total_amount,o=f.a.get_asset_precision(n.get("precision")),i=c.ChainStore.getAccount(this.state.invoice.to);i?s.a.transfer(this.state.pay_from_account.get("id"),i.get("id"),parseInt(r*o,10),n.get("id"),this.state.invoice.memo).then((function(){p.a.unlisten(t.onBroadcastAndConfirm),p.a.listen(t.onBroadcastAndConfirm)})).catch((function(e){console.log("error: ",e)})):u.a.error("Account "+this.state.invoice.to+" not found")}},{key:"fromChanged",value:function(e){this.setState({pay_from_name:e,pay_from_account:null})}},{key:"onFromAccountChanged",value:function(e){this.setState({pay_from_account:e})}},{key:"onToAccountChanged",value:function(e){this.setState({pay_to_account:e})}},{key:"render",value:function(){var e=this,t=this.props.match.params.data;if(this.state.isRawDataInputVisible)return r.a.createElement("div",null,r.a.createElement(O.a,{labelContent:r.a.createElement(y.a,{component:"span",content:"invoice.raw_invoice_data"}),submitBtnText:w.a.translate("invoice.use_invoice_data"),dataFoundText:w.a.translate("invoice.invoice_data_found")+":",onInputChange:this.handleRawInvoiceDataChange,inputValue:this.state.rawDataInputValue,handleQrScanSuccess:this.handleQrScanSuccess}),r.a.createElement("br",null),r.a.createElement("h4",{className:"has-error text-center"},this.state.error));if(this.state.error)return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h4",{className:"has-error text-center"},this.state.error));if(!this.state.invoice)return null;if(!this.state.asset)return r.a.createElement("div",null,r.a.createElement(y.a,{className:"has-error text-center",component:"h4",content:"transfer.errors.asset_unsupported",currency:this.state.invoice.currency}));var a=this.state,n=a.invoice,s=a.total_amount,c=n.currency;n.to_label&&(n.to_name=n.to_label);var u=P({},n,{total_amount:s?s.toString():0,asset:c,from:this.state.pay_from_account,blockNum:this.state.blockNum});if(this.state.pay_from_account){var p=this.state.pay_from_account.get("balances").get(this.state.asset.get("id"));r.a.createElement("span",null,r.a.createElement(y.a,{component:"span",content:"transfer.available"}),r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"}},r.a.createElement(l.a,{balance:p})))}var d=n.line_items.map((function(t,a){var n=e.parsePrice(t.price),s=t.quantity*n;return r.a.createElement(v.Row,{key:"invoice_item_"+a},r.a.createElement(v.Col,{span:10},r.a.createElement("div",{className:"item-name"},t.label),r.a.createElement("div",{className:"item-description"})),r.a.createElement(v.Col,{span:3},t.quantity," x"),r.a.createElement(v.Col,{span:5},r.a.createElement(o.a,{amount:t.price,asset:c,exact_amount:!0})),r.a.createElement(v.Col,{span:5},r.a.createElement(o.a,{amount:s,asset:c,exact_amount:!0})))})),h="pay"!==t?t:this.state.rawDataInputValue,m=null;return this.state.invoiceQr?m=h:this.state.pay_from_name&&n.to!==this.state.pay_from_name&&(m="bitshares:operation/transfer?to="+n.to+"&from="+this.state.pay_from_name+"&asset="+c+"&amount="+s+(n.memo?"&memo="+n.memo:"")),r.a.createElement("div",{className:"merchant-protocol--pay"},r.a.createElement("div",{style:{float:"right"}},r.a.createElement(b.a,{data:u,parsePrice:this.parsePrice})),r.a.createElement(y.a,{component:"h3",content:"invoice.payment_request"}),r.a.createElement("br",null),r.a.createElement(v.Row,null,r.a.createElement(v.Col,{span:10,style:{width:"30rem"}},r.a.createElement("h4",null,n.memo),r.a.createElement(i.a,{label:"invoice.paid_by",accountName:this.state.pay_from_name,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),account:this.state.pay_from_name,typeahead:!0,size:32}),r.a.createElement(i.a,{label:"invoice.pay_to",accountName:n.to,disabled:!0,onAccountChanged:this.onToAccountChanged.bind(this),account:this.state.pay_to_account,size:32})),r.a.createElement(v.Col,{span:6,offset:4},r.a.createElement("div",{className:"inline-block"},r.a.createElement(y.a,{component:"h4",content:"invoice.pay.barcode"}),r.a.createElement(v.Button,{type:"secondary",style:{width:"180px",marginBottom:"20px"},onClick:function(){e.setState({invoiceQr:!e.state.invoiceQr})}},r.a.createElement(y.a,{component:"span",content:this.state.invoiceQr?"invoice.pay.invoice_qr_code":"invoice.pay.payment_qr_code"}))),r.a.createElement(x.a,{size:180,value:m||"",bgColor:m?void 0:"#000000"}))),n.to_name&&r.a.createElement("div",null,r.a.createElement(y.a,{content:"invoice.request.recipient_name"}),r.a.createElement("p",null,n.to_name)),n.note&&r.a.createElement("div",null,r.a.createElement(y.a,{content:"invoice.note"}),r.a.createElement("p",null,n.note)),r.a.createElement(v.Row,null,r.a.createElement(v.Col,{span:10},r.a.createElement(y.a,{component:"span",content:"invoice.items"})),r.a.createElement(v.Col,{span:3},r.a.createElement(y.a,{component:"span",content:"invoice.amount"})),r.a.createElement(v.Col,{span:5},r.a.createElement(y.a,{component:"span",content:"invoice.unit"})),r.a.createElement(v.Col,{span:5},r.a.createElement(y.a,{component:"span",content:"invoice.total"}))),r.a.createElement("div",{className:"divider"}),d,r.a.createElement("div",{className:"divider"}),r.a.createElement(v.Row,null,r.a.createElement(v.Col,{span:18},r.a.createElement(y.a,{component:"span",content:"invoice.total"})),r.a.createElement(v.Col,{span:5},r.a.createElement(o.a,{amount:s,asset:c,exact_amount:!0}))),this.state.paymentOperation?r.a.createElement("div",null,r.a.createElement("h3",null,w.a.translate("invoice.payment_proof")," ",r.a.createElement(v.Tooltip,{title:w.a.translate("invoice.tooltip_payment_proof"),mouseEnterDelay:.5},r.a.createElement(v.Icon,{type:"question-circle"}))),r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,r.a.createElement(S.a,{includeOperationId:!0,key:this.state.paymentOperation.id,operationId:this.state.paymentOperation.id,op:this.state.paymentOperation.op,result:this.state.paymentOperation.result,block:this.state.paymentOperation.block_num,current:this.props.currentAccount.get("id")})))):r.a.createElement(v.Button,{type:"primary",style:{marginTop:"30px"},disabled:!this.state.pay_from_account,onClick:this.onPayClick.bind(this)},r.a.createElement(y.a,{content:"invoice.pay_button",asset:r.a.createElement(o.a,{amount:s,asset:c,exact_amount:!0}),name:n.to})))}}]),a}(r.a.Component);t.a=B}).call(this,a(126).Buffer)},2138:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(4),s=a(5),i=a.n(s),l=a(615),c=a.n(l),u=(a(2139),a(154)),p=a(267);function d(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}t.a=function(e){var t=e.data,a=e.parsePrice,n=i.a.translate("invoice.print_receipt");return t.blockNum&&p.a.getHeader.defer(t.blockNum),r.a.createElement(o.Tooltip,{placement:"left",title:i.a.translate("tooltip.print_receipt")},r.a.createElement(o.Button,{type:"primary",icon:"download",onClick:function(){return function(e){var t=e.data,a=e.parsePrice,n=t.line_items,r=t.to,o=t.asset,s=t.from,l=t.total_amount,p=t.memo,h=t.currency,m=t.blockNum,f=t.to_name,b=t.note,g=0,y=[],v="",_="";s&&(s.get("history").forEach((function(e){e.get("block_num")!==m||(v=e.get("id"))})),_=s.get("name"));var k=u.a.getState().blockHeaders.get(m),E=k?k.timestamp.toLocaleDateString("en-US").replace(/\//g,"."):(new Date).toLocaleDateString("en-US").replace(/\//g,"."),w=new c.a({orientation:"portrait",compressPdf:!0});w.setFontStyle("bold"),w.setFontSize(16),w.text(i.a.translate("invoice.pay_to",{locale:"en"}).toUpperCase(),15,g+=25),w.setFontStyle("normal"),w.text(f,15,g+=10),w.text(r,15,g+=10),w.autoTable({body:[["",i.a.translate("invoice.memo",{locale:"en"}),p],[{content:i.a.translate("invoice.paid_by",{locale:"en"}).toUpperCase(),styles:{fontStyle:"bold"}},i.a.translate("invoice.date",{locale:"en"}),E],[_,i.a.translate("invoice.transaction",{locale:"en"}),v],[{content:i.a.translate("invoice.note",{locale:"en"}).toUpperCase(),styles:{fontStyle:"bold"}},"",""],[b,"",""]],bodyStyles:{valign:"top"},styles:{cellWidth:"wrap",rowPageBreak:"auto",halign:"justify"},columnStyles:{0:{halign:"left",cellWidth:90},1:{fontStyle:"bold"},2:{cellWidth:40}},startY:g+=10,theme:"plain"}),w.line(5,g=w.autoTable.previous.finalY+10,205,g),w.setFontSize(20),w.text(i.a.translate("invoice.receipt_total",{locale:"en"}).toUpperCase(),15,g+=10),w.text(l+" "+h,150,g),w.line(5,g+=5,205,g),w.setFontStyle("normal"),w.setFontSize(16);var C=!0,S=!1,A=void 0;try{for(var x,O=n[Symbol.iterator]();!(C=(x=O.next()).done);C=!0){var P=x.value,T=a(P.price),N=T+" "+o,B=P.quantity*T+" "+o;y=[].concat(d(y),[{descrption:P.label,unit:N,amount:P.quantity,total:B}])}}catch(e){S=!0,A=e}finally{try{!C&&O.return&&O.return()}finally{if(S)throw A}}w.autoTable({columns:[{header:{content:"DESCRIPTION",styles:{halign:"left"}},dataKey:"descrption"},{header:"AMOUNT",dataKey:"amount"},{header:"UNIT",dataKey:"unit"},{header:"TOTAL",dataKey:"total"}],body:y,startY:g+10,bodyStyles:{valign:"top"},styles:{cellWidth:"auto",rowPageBreak:"auto",halign:"right"},columnStyles:{descrption:{halign:"left"}},theme:"plain"}),w.save("bitshares-receipt-"+r+".pdf")}({data:t,parsePrice:a})}},n))}},2140:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n),o=a(1),s=a.n(o),i=a(4),l=a(785);function c(e){var t=e.labelContent,a=e.handleQrScanSuccess,n=e.onInputChange,o=e.inputValue,s=e.submitBtnText,c=e.dataFoundText;return r.a.createElement("div",{style:{marginBottom:"1em"}},r.a.createElement("label",{className:"left-label"},t),r.a.createElement("div",null,r.a.createElement("div",{className:"inline-label"},r.a.createElement(i.Input.TextArea,{style:{marginBottom:0},rows:3,onChange:n,value:o}),r.a.createElement("span",null,r.a.createElement(l.a,{label:"Scan",onSuccess:a,submitBtnText:s,dataFoundText:c})))))}c.propTypes={labelContent:s.a.oneOfType([s.a.string,s.a.element]),handleQrScanSuccess:s.a.func.isRequired,onInputChange:s.a.func.isRequired,inputValue:s.a.string,submitBtnText:s.a.oneOfType([s.a.string,s.a.element]),dataFoundText:s.a.oneOfType([s.a.string,s.a.element])}},2149:function(e,t,a){},2181:function(e,t,a){!function(e){"use strict";function t(e,a){var r=n({},e);for(var o in a)"object"!=typeof e[o]||null===e[o]||Array.isArray(e[o])?void 0!==a[o]&&(r[o]=a[o]):r[o]=t(e[o],a[o]);return r}function a(){return"1.12 (internal id 630b704a @ 2018-06-06 02:16:11.305509)"}var n=Object.assign||function(e){for(var t,a=arguments,n=1,r=arguments.length;n<r;n++)for(var o in t=a[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r={mobile:{disabled_features:["left_toolbar","header_widget","timeframes_toolbar","edit_buttons_in_legend","context_menus","control_bar","border_around_the_chart"],enabled_features:[]}},o={width:800,height:500,symbol:"AA",interval:"D",timezone:"UTC",container_id:"",library_path:"",locale:"en",widgetbar:{details:!1,watchlist:!1,watchlist_settings:{default_symbols:[]}},overrides:{"mainSeriesProperties.showCountdown":!1},studies_overrides:{},brokerConfig:{configFlags:{}},fullscreen:!1,autosize:!1,disabled_features:[],enabled_features:[],debug:!1,logo:{},time_frames:[{text:"5y",resolution:"W"},{text:"1y",resolution:"W"},{text:"6m",resolution:"120"},{text:"3m",resolution:"60"},{text:"1m",resolution:"30"},{text:"5d",resolution:"5"},{text:"1d",resolution:"1"}],client_id:"0",user_id:"0",charts_storage_api_version:"1.0",favorites:{intervals:[],chartTypes:[]}},s=function(){function e(e){if(this._id="tradingview_"+(1048576*(1+Math.random())|0).toString(16).substring(1),this._ready=!1,this._readyHandlers=[],this._onWindowResize=this._autoResizeChart.bind(this),!e.datafeed)throw new Error("Datafeed is not defined");if(this._options=t(o,e),e.preset){var a=r[e.preset];a?(void 0!==this._options.disabled_features?this._options.disabled_features=this._options.disabled_features.concat(a.disabled_features):this._options.disabled_features=a.disabled_features,void 0!==this._options.enabled_features?this._options.enabled_features=this._options.enabled_features.concat(a.enabled_features):this._options.enabled_features=a.enabled_features):console.warn("Unknown preset: `"+e.preset+"`")}this._create()}return e.prototype.onChartReady=function(e){this._ready?e.call(this):this._readyHandlers.push(e)},e.prototype.onGrayedObjectClicked=function(e){this._innerAPI().onGrayedObjectClicked(e)},e.prototype.onShortcut=function(e,t){this._innerWindow().createShortcutAction(e,t)},e.prototype.subscribe=function(e,t){this._innerAPI().subscribe(e,t)},e.prototype.unsubscribe=function(e,t){this._innerAPI().unsubscribe(e,t)},e.prototype.chart=function(e){return this._innerAPI().chart(e)},e.prototype.setLanguage=function(e){this.remove(),this._options.locale=e,this._create()},e.prototype.setSymbol=function(e,t,a){this._innerAPI().changeSymbol(e,t+"",a)},e.prototype.remove=function(){window.removeEventListener("resize",this._onWindowResize),this._readyHandlers.splice(0,this._readyHandlers.length),delete window[this._id];var e=this._getIFrameElement();e.contentWindow.destroyChart(),e.parentNode&&e.parentNode.removeChild(e)},e.prototype.closePopupsAndDialogs=function(){this._innerAPI().closePopupsAndDialogs()},e.prototype.selectLineTool=function(e){this._innerAPI().selectLineTool(e)},e.prototype.selectedLineTool=function(){return this._innerAPI().selectedLineTool()},e.prototype.save=function(e){this._innerAPI().saveChart(e)},e.prototype.load=function(e,t){this._innerAPI().loadChart({json:e,extendedData:t})},e.prototype.getSavedCharts=function(e){this._innerAPI().getSavedCharts(e)},e.prototype.loadChartFromServer=function(e){this._innerAPI().loadChartFromServer(e)},e.prototype.saveChartToServer=function(e,t,a,n){this._innerAPI().saveChartToServer(e,t,a,n)},e.prototype.removeChartFromServer=function(e,t){this._innerAPI().removeChartFromServer(e,t)},e.prototype.onContextMenu=function(e){this._innerAPI().onContextMenu(e)},e.prototype.createButton=function(e){return this._innerWindow().createButton(e)},e.prototype.showNoticeDialog=function(e){this._innerAPI().showNoticeDialog(e)},e.prototype.showConfirmDialog=function(e){this._innerAPI().showConfirmDialog(e)},e.prototype.showLoadChartDialog=function(){this._innerAPI().showLoadChartDialog()},e.prototype.showSaveAsChartDialog=function(){this._innerAPI().showSaveAsChartDialog()},e.prototype.symbolInterval=function(){return this._innerAPI().getSymbolInterval()},e.prototype.mainSeriesPriceFormatter=function(){return this._innerAPI().mainSeriesPriceFormatter()},e.prototype.getIntervals=function(){return this._innerAPI().getIntervals()},e.prototype.getStudiesList=function(){return this._innerAPI().getStudiesList()},e.prototype.addCustomCSSFile=function(e){this._innerWindow().addCustomCSSFile(e)},e.prototype.applyOverrides=function(e){this._options=t(this._options,{overrides:e}),this._innerWindow().applyOverrides(e)},e.prototype.applyStudiesOverrides=function(e){this._innerWindow().applyStudiesOverrides(e)},e.prototype.watchList=function(){return this._innerAPI().watchlist()},e.prototype.activeChart=function(){return this._innerAPI().activeChart()},e.prototype.chartsCount=function(){return this._innerAPI().chartsCount()},e.prototype.layout=function(){return this._innerAPI().layout()},e.prototype.setLayout=function(e){this._innerAPI().setLayout(e)},e.prototype._getIFrameElement=function(){var e=document.getElementById(this._id);if(null===e)throw new Error("There is no such iframe");return e},e.prototype._innerAPI=function(){return this._getIFrameElement().contentWindow.tradingViewApi},e.prototype._innerWindow=function(){return this._getIFrameElement().contentWindow},e.prototype._autoResizeChart=function(){this._options.fullscreen&&(this._getIFrameElement().style.height=window.innerHeight+"px")},e.prototype._create=function(){var e=this,t=this._render(),a=document.getElementById(this._options.container_id);if(null===a)throw new Error("There is no such element - #"+this._options.container_id);a.innerHTML=t;var n=this._getIFrameElement();(this._options.autosize||this._options.fullscreen)&&(n.style.width="100%",this._options.fullscreen||(n.style.height="100%")),window.addEventListener("resize",this._onWindowResize),this._onWindowResize();var r=function(){n.removeEventListener("load",r,!1),n.contentWindow.widgetReady((function(){e._ready=!0;for(var t=0,a=e._readyHandlers;t<a.length;t++)a[t].call(e);n.contentWindow.initializationFinished()}))};n.addEventListener("load",r,!1)},e.prototype._render=function(){var e=window;e[this._id]={datafeed:this._options.datafeed,customFormatters:this._options.customFormatters,brokerFactory:this._options.brokerFactory,overrides:this._options.overrides,studiesOverrides:this._options.studies_overrides,disabledFeatures:this._options.disabled_features,enabledFeatures:this._options.enabled_features,brokerConfig:this._options.brokerConfig,restConfig:this._options.restConfig,favorites:this._options.favorites,logo:this._options.logo,numeric_formatting:this._options.numeric_formatting,rss_news_feed:this._options.rss_news_feed,newsProvider:this._options.news_provider,loadLastChart:this._options.load_last_chart,saveLoadAdapter:this._options.save_load_adapter,loading_screen:this._options.loading_screen,settingsAdapter:this._options.settings_adapter},this._options.saved_data&&(e[this._id].chartContent={json:this._options.saved_data});var t=(this._options.library_path||"")+"static/tv-chart.630b704a2b9d0eaf1593.html#localserver=1&symbol="+encodeURIComponent(this._options.symbol)+"&interval="+encodeURIComponent(this._options.interval)+(this._options.timeframe?"&timeframe="+encodeURIComponent(this._options.timeframe):"")+(this._options.toolbar_bg?"&toolbarbg="+this._options.toolbar_bg.replace("#",""):"")+(this._options.studies_access?"&studiesAccess="+encodeURIComponent(JSON.stringify(this._options.studies_access)):"")+"&widgetbar="+encodeURIComponent(JSON.stringify(this._options.widgetbar))+(this._options.drawings_access?"&drawingsAccess="+encodeURIComponent(JSON.stringify(this._options.drawings_access)):"")+"&timeFrames="+encodeURIComponent(JSON.stringify(this._options.time_frames))+"&locale="+encodeURIComponent(this._options.locale)+"&uid="+encodeURIComponent(this._id)+"&clientId="+encodeURIComponent(String(this._options.client_id))+"&userId="+encodeURIComponent(String(this._options.user_id))+(this._options.charts_storage_url?"&chartsStorageUrl="+encodeURIComponent(this._options.charts_storage_url):"")+(this._options.charts_storage_api_version?"&chartsStorageVer="+encodeURIComponent(this._options.charts_storage_api_version):"")+(this._options.indicators_file_name?"&indicatorsFile="+encodeURIComponent(this._options.indicators_file_name):"")+(this._options.custom_css_url?"&customCSS="+encodeURIComponent(this._options.custom_css_url):"")+(this._options.auto_save_delay?"&autoSaveDelay="+encodeURIComponent(String(this._options.auto_save_delay)):"")+"&debug="+this._options.debug+(this._options.snapshot_url?"&snapshotUrl="+encodeURIComponent(this._options.snapshot_url):"")+(this._options.timezone?"&timezone="+encodeURIComponent(this._options.timezone):"")+(this._options.study_count_limit?"&studyCountLimit="+encodeURIComponent(String(this._options.study_count_limit)):"")+(this._options.symbol_search_request_delay?"&ssreqdelay="+encodeURIComponent(String(this._options.symbol_search_request_delay)):"");return'<iframe id="'+this._id+'" name="'+this._id+'"  src="'+t+'"'+(this._options.autosize||this._options.fullscreen?"":' width="'+this._options.width+'" height="'+this._options.height+'"')+' frameborder="0" allowTransparency="true" scrolling="no" allowfullscreen style="display:block;"></iframe>'},e}();window.TradingView=window.TradingView||{},window.TradingView.version=a,e.version=a,e.onready=function(e){window.addEventListener("DOMContentLoaded",e,!1)},e.widget=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2192:function(e,t,a){"use strict";(function(e){var n=a(0),r=a.n(n),o=a(148),s=a.n(o),i=a(2),l=a.n(i),c=a(40),u=a(16),p=a(48),d=a(44),h=a(42),m=a(56),f=a.n(m),b=a(5),g=a.n(b),y=a(83),v=a(168),_=a(34),k=a(41),E=a(212),w=a(30),C=a(21),S=a(285),A=a(46),x=a(36),O=a(4),P=a(6),T=a(372),N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},B=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var I=function(t){function a(e){M(this,a);var t=F(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.state={toAddress:y.a.getLast(e.walletType),withdrawValue:"",amountError:null,symbol:e.asset.get("symbol"),to_withdraw:new c.a({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),feeAsset:{asset_id:P.ChainStore.assets_by_symbol.get(e.fee_asset_symbol)||"1.3.0",amount:0},loading:!1,emptyAddressDeposit:!1},t._validateAddress(t.state.toAddress,e),t.addDepositAddress=t.addDepositAddress.bind(t),t._checkBalance=t._checkBalance.bind(t),t._getCurrentBalance=t._getCurrentBalance.bind(t),t}return j(a,t),B(a,[{key:"componentWillMount",value:function(){this._getDepositAddress()}},{key:"componentWillReceiveProps",value:function(e){e.asset&&this.props.asset&&e.asset.get("id")!==this.props.asset.get("id")&&this.setState({to_withdraw:new c.a({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),gateFee:e.asset.get("gateFee"),intermediateAccount:e.asset.get("intermediateAccount"),symbol:e.asset.get("symbol"),memo:"",withdrawValue:"",receive_address:null,toAddress:y.a.getLast(e.walletType)},this._getDepositAddress)}},{key:"_getDepositAddress",value:function(){if(this.props.backingCoinType){var e=Object(y.j)({coin:"open."+this.props.backingCoinType.toLowerCase(),account:this.props.account,stateCallback:this.addDepositAddress});e?this.setState({receive_address:e}):Object(y.m)(this._getDepositObject())}}},{key:"_getDepositObject",value:function(){return{inputCoinType:this.props.backingCoinType.toLowerCase(),outputCoinType:this.props.symbol.toLowerCase(),outputAddress:this.props.sender.get("name"),stateCallback:this.addDepositAddress}}},{key:"requestDepositAddressLoad",value:function(){this.setState({loading:!0,emptyAddressDeposit:!1}),Object(y.m)(this._getDepositObject())}},{key:"addDepositAddress",value:function(e){e.error&&("no_address"===e.error.message?this.setState({emptyAddressDeposit:!0}):this.setState({emptyAddressDeposit:!1})),this.setState({receive_address:e,loading:!1})}},{key:"componentDidUpdate",value:function(){f.a.rebuild()}},{key:"getMemo",value:function(){return this.props.backingCoinType.toLowerCase()+":"+this.state.toAddress+(this.state.memo?":"+new e(this.state.memo,"utf-8"):"")}},{key:"onSubmit",value:function(e){if(e.preventDefault(),0===this.state.to_withdraw.getAmount())return this.setState({amountError:"transfer.errors.pos"});if(this.props.intermediateAccount){var t=this.state.feeAsset,a=this._getGateFee(),n=this.state.to_withdraw.clone(),r=n.clone(this._getCurrentBalance().get("balance"));n.plus(a),r.lt(n)&&(n=this.state.to_withdraw.clone()),h.a.transfer(this.props.sender.get("id"),this.props.intermediateAccount,this.state.to_withdraw.getAmount(),this.state.to_withdraw.asset_id,this.getMemo(),null,t.asset_id)}}},{key:"_updateAmount",value:function(){var e=this.state.feeAsset,t=this._getCurrentBalance(),a=new c.a({amount:t?t.get("balance"):0,asset_id:this.props.asset.get("id"),precision:this.props.asset.get("precision")});a.asset_id===e.asset_id&&a.minus(e),this.state.to_withdraw.setAmount({sats:a.getAmount()}),this.setState({withdrawValue:a.getAmount({real:!0}),amountError:null},this._checkBalance)}},{key:"_getCurrentBalance",value:function(){var e=this,t=this.props.balance?[P.ChainStore.getObject(this.props.balance)]:this.props.balances;return t?t.find((function(t){return t&&t.get("asset_type")===e.props.asset.get("id")})):null}},{key:"_checkBalance",value:function(){var e=this.state,t=e.feeAsset,a=e.to_withdraw,n=this.props.asset,r=this._getCurrentBalance();if(r&&t){var o=Object(E.a)(a.getAmount({real:!0}),n,t,r,this._getGateFee());if(null!==o)return this.state.balanceError!==!o&&this.setState({balanceError:!o}),o}}},{key:"_onInputAmount",value:function(e){try{this.state.to_withdraw.setAmount({real:parseFloat(e.target.value||0)}),this.setState({withdrawValue:e.target.value,amountError:null},this._checkBalance)}catch(e){console.error("err:",e)}}},{key:"_onInputTo",value:function(e){var t=e.target.value.trim();this.setState({withdraw_address_check_in_progress:!0,withdraw_address_selected:t,validAddress:null,toAddress:t}),this._validateAddress(t)}},{key:"_onMemoChanged",value:function(e){this.setState({memo:e.target.value})}},{key:"_validateAddress",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;Object(y.n)({url:A.h.BASE,walletType:a.walletType,newAddress:e}).then((function(a){t.state.toAddress===e&&t.setState({withdraw_address_check_in_progress:!1,validAddress:!!a})})).catch((function(e){console.error("Error when validating address:",e)}))}},{key:"_openRegistrarSite",value:function(e){e.preventDefault(),window.open(C.a.site_registr,"_blank").opener=null}},{key:"_getGateFee",value:function(){var e=this.props,t=e.gateFee,a=e.asset;return new c.a({real:parseFloat(t?t.replace(",",""):0),asset_id:a.get("id"),precision:a.get("precision")})}},{key:"onFeeChanged",value:function(e){this.setState({feeAsset:e})}},{key:"_renderWithdraw",value:function(){var e=this.state,t=e.amountError,a=e.toAddress,n=e.memo,o=e.feeAsset,s=e.balanceError,i=e.withdrawValue,c=e.validAddress,p=this.props,d=p.supportsMemos,h=p.asset,m=p.account,f=u.a.replaceName(h).name,b=1,y=o,v=this.getMemo(),_=!y||s||!a||!i;return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(l.a,{content:"gateway.withdraw_funds",asset:f,wallet_name:Object(x.p)()})),this._renderCurrentBalance(),r.a.createElement("div",{className:"SimpleTrade__withdraw-row"},r.a.createElement("label",{className:"left-label"},g.a.translate("modal.withdraw.amount")),r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("input",{tabIndex:b++,type:"number",min:"0",onKeyPress:this.onKeyPress.bind(this),value:i,onChange:this._onInputAmount.bind(this)}),r.a.createElement("div",{className:"form-label select floating-dropdown"},r.a.createElement("div",{className:"dropdown-wrapper inactive"},r.a.createElement("div",null,f)))),t?r.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},r.a.createElement(l.a,{content:t})):null,this.state.balanceError?r.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},r.a.createElement(l.a,{content:"transfer.errors.insufficient"})):null),r.a.createElement("div",{className:"SimpleTrade__withdraw-row withdraw-fee-selector"},r.a.createElement(T.a,{label:"showcases.barter.fee_when_proposal_executes",account:m,transaction:{type:"transfer",options:["price_per_kbyte"],data:{type:"memo",content:v}},onChange:this.onFeeChanged.bind(this)})),r.a.createElement("div",{className:"SimpleTrade__withdraw-row"},r.a.createElement("label",{className:"left-label"},g.a.translate("modal.withdraw.address")),r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("input",{placeholder:g.a.translate("gateway.withdraw_placeholder",{asset:f}),tabIndex:b++,type:"text",value:a,onChange:this._onInputTo.bind(this)}),r.a.createElement("div",{className:"form-label select floating-dropdown"},r.a.createElement("div",{className:"dropdown-wrapper inactive"},r.a.createElement(O.Tooltip,{placement:"right",title:g.a.translate("tooltip.withdraw_address",{asset:f})},"?")))),!c&&a?r.a.createElement("div",{className:"has-error",style:{paddingTop:10}},r.a.createElement(l.a,{content:"gateway.valid_address",coin_type:f})):null),d?r.a.createElement("div",{className:"SimpleTrade__withdraw-row"},r.a.createElement("label",{className:"left-label"},g.a.translate("transfer.memo")),r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("textarea",{rows:"3",value:n,tabIndex:b++,onChange:this._onMemoChanged.bind(this)})),!c&&a?r.a.createElement("div",{className:"has-error",style:{paddingTop:10}},r.a.createElement(l.a,{content:"gateway.valid_address",coin_type:f})):null):null,r.a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},r.a.createElement("button",{tabIndex:b++,className:"button"+(_?" disabled":""),onClick:this.onSubmit.bind(this),type:"submit"},r.a.createElement(l.a,{content:"gateway.withdraw_now"}))))}},{key:"_renderDeposit",value:function(){var e=this.state,t=e.receive_address,a=e.loading,n=e.emptyAddressDeposit,o=u.a.replaceName(this.props.asset).name,s=t&&"memo"in t&&t.memo,i=t&&t.address||"",c=1;return r.a.createElement("div",{className:i?"":"no-overflow"},r.a.createElement("p",null,r.a.createElement(l.a,{unsafe:!0,content:"gateway.add_funds",account:this.props.sender.get("name"),wallet_name:Object(x.p)()})),this._renderCurrentBalance(),r.a.createElement("div",{className:"SimpleTrade__withdraw-row"},r.a.createElement(O.Tooltip,{placement:"right",title:g.a.translate("tooltip.deposit_tip",{asset:o})},r.a.createElement("p",{style:{marginBottom:10}},r.a.createElement(l.a,{className:"help-tooltip",content:"gateway.deposit_to",asset:o}),":",r.a.createElement("label",{className:"fz_12 left-label"},r.a.createElement(l.a,{content:"gateway.deposit_notice_delay"})))),i?r.a.createElement("label",null,n?r.a.createElement(l.a,{content:"gateway.please_generate_address"}):r.a.createElement("span",{className:"inline-label"},r.a.createElement("input",{readOnly:!0,type:"text",value:i}),r.a.createElement(v.a,{text:i})," ")):r.a.createElement(k.a,{type:"three-bounce"}),s?r.a.createElement("label",null,r.a.createElement("span",{className:"inline-label"},r.a.createElement("input",{readOnly:!0,type:"text",value:g.a.translate("transfer.memo")+": "+t.memo}),r.a.createElement(v.a,{text:t.memo}))):null,t&&t.error?r.a.createElement("div",{className:"has-error",style:{paddingTop:10}},t.error.message):null),r.a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},r.a.createElement("button",{tabIndex:c++,className:"button spinner-button-circle",onClick:this.requestDepositAddressLoad.bind(this),type:"submit"},a?r.a.createElement(k.a,{type:"circle"}):null,r.a.createElement(l.a,{content:"gateway.generate_new"}))))}},{key:"_renderCurrentBalance",value:function(){var e=u.a.replaceName(this.props.asset).name,t="deposit"===this.props.action,a=this._getCurrentBalance(),n=a?new c.a({asset_id:a.get("asset_type"),precision:this.props.asset.get("precision"),amount:a.get("balance")}):null,o=t?r.a.createElement("span",{style:{border:"2px solid black",borderLeft:"none"},className:"form-label"},e):r.a.createElement(O.Tooltip,{placement:"right",title:g.a.translate("tooltip.withdraw_full")},r.a.createElement("button",{className:"button",style:{border:"2px solid black",borderLeft:"none"},onClick:this._updateAmount.bind(this,a?parseInt(a.get("balance"),10):0)},r.a.createElement(_.a,{name:"clippy",title:"icons.clippy.withdraw_full"})));return r.a.createElement("div",{className:"SimpleTrade__withdraw-row",style:{fontSize:"1rem"}},r.a.createElement("label",{style:{fontSize:"1rem"}},g.a.translate("gateway.balance_asset",{asset:e}),":",r.a.createElement("span",{className:"inline-label"},r.a.createElement("input",{disabled:!0,style:{color:"black",border:"2px solid black",padding:10,width:"100%"},value:n?n.getAmount({real:!0}):0}),o)))}},{key:"render",value:function(){var e=this.props,t=e.asset,a="deposit"===e.action;if(!t)return null;u.a.replaceName(t).name;var n=this.props.isDown?r.a.createElement("div",null,r.a.createElement(l.a,{className:"txtlabel cancel",content:"gateway.unavailable_OPEN",component:"p"})):this.props.isAvailable?a?this._renderDeposit():this._renderWithdraw():r.a.createElement("div",null,r.a.createElement(l.a,{className:"txtlabel cancel",content:"gateway.unavailable",component:"p"}));return r.a.createElement("div",{className:"SimpleTrade__modal"},r.a.createElement("div",{className:"grid-block vertical no-overflow",style:{zIndex:1002,paddingLeft:"2rem",paddingRight:"2rem",paddingTop:"1rem"}},n))}}]),a}(S.a);I.propTypes={balance:d.a.ChainObject,sender:d.a.ChainAccount.isRequired,asset:d.a.ChainAsset.isRequired,coreAsset:d.a.ChainAsset.isRequired,globalObject:d.a.ChainAsset.isRequired},I.defaultProps={coreAsset:"1.3.0",globalObject:"2.0.0"},I=Object(w.a)(I,{listenTo:function(){return[C.a]},getProps:function(e){return{fee_asset_symbol:C.a.getState().settings.get("fee_asset")}}}),I=Object(p.a)(I);var q=function(e){function t(){M(this,t);var e=F(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={open:!1},e}return j(t,e),B(t,[{key:"show",value:function(){var e=this;this.setState({open:!0},(function(){s.a.publish(e.props.modalId,"open")}))}},{key:"onClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e="deposit"===this.props.action?g.a.translate("gateway.deposit"):g.a.translate("modal.withdraw.submit");return r.a.createElement(O.Modal,{title:e,footer:[],visible:this.props.visible,onCancel:this.props.hideModal,className:"test",onClose:this.onClose.bind(this),overlay:!0,id:this.props.modalId},this.props.visible?r.a.createElement(I,N({},this.props,{open:this.props.visible})):null)}}]),t}(r.a.Component);t.a=q}).call(this,a(126).Buffer)},2326:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(4),s=a(5),i=a.n(s),l=a(2136),c=a(2137),u=a(2033),p=a(2141),d=(a(2149),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}),h=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={tabs:[{name:"Request",link:"/invoice/request",translate:"invoice.request.title",content:r.a.createElement(l.a,d({},e,{validateFormat:a._validateFormat.bind(a)}))},{name:"Pay",link:"/invoice/pay",translate:"invoice.pay.title",content:r.a.createElement(c.a,d({},e,{validateFormat:a._validateFormat.bind(a)}))}]},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),h(t,[{key:"_validateFormat",value:function(e){return!Object(p.validate)(e,{type:"object",properties:{to:{type:"string"},to_label:{type:"string"},currency:{type:"string"},memo:{type:"string"},line_items:{type:"array",items:{type:"object",properties:{label:{type:"string"},quantity:{type:"float",minimum:1},price:{type:"float"}}}},note:{type:"string"},required:["to","currency","line_items"]}}).errors.length}},{key:"componentDidMount",value:function(){var e=this;this.state.tabs.some((function(t){return t.link===e.props.match.url}))||this.props.history.push("/invoice/pay")}},{key:"onTabChange",value:function(e){this.props.history.push(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"merchant-protocol center"},r.a.createElement(o.Card,null,r.a.createElement(o.Tabs,{activeKey:this.props.location.pathname,animated:!1,onChange:this.onTabChange.bind(this)},this.state.tabs.map((function(e){return r.a.createElement(o.Tabs.TabPane,{key:e.link,tab:i.a.translate(e.translate)},r.a.createElement("div",{className:"padding"},e.content))})))))}}]),t}(r.a.Component);m=Object(u.a)(m),t.default=m},2334:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(197),s=a(23),i=a(21),l=a(155),c=a(574),u=a(117),p=a(119),d=a(2025),h=a(15),m=a(6),f=a(4),b=a(3),g=a.n(b),y=a(5),v=a.n(y),_=a(796),k=a.n(_),E=a(32),w=a.n(E),C=a(2040),S=a.n(C),A=a(1),x=a.n(A),O=a(22),P=a(82),T=a(112),N=a(65),B=a(40),M=a(212),F=a(16),j=a(2),I=a.n(j),q=a(27),R=a(44),L=a(48),D=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var U=function(e){function t(){return V(this,t),z(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),D(t,[{key:"render",value:function(){var e=this.props,t=e.price,a=e.preFormattedPrice,n=e.quote,o=e.base;if(!t&&!a)return null;var s=a||F.a.price_to_text(t,n,o);return s.full>=1?r.a.createElement("span",null,r.a.createElement("span",{className:"price-integer"},s.int,"."),s.dec?r.a.createElement("span",{className:"price-integer"},s.dec):null,s.trailing?r.a.createElement("span",{className:"price-decimal"},s.trailing):null):s.full>=.1?r.a.createElement("span",null,r.a.createElement("span",{className:"price-decimal"},s.int,"."),s.dec?r.a.createElement("span",{className:"price-integer"},s.dec):null,s.trailing?r.a.createElement("span",{className:"price-decimal"},s.trailing):null):r.a.createElement("span",null,r.a.createElement("span",{className:"price-decimal"},s.int,"."),s.dec?r.a.createElement("span",{className:"price-decimal"},s.dec):null,s.trailing?r.a.createElement("span",{className:"price-integer"},s.trailing):null)}}]),t}(r.a.Component),H=a(97),W=a(556),G=a(827),Q=a(34),K=a(2089),J=a(56),Y=a.n(J),Z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var X=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.getDatePickerRef=function(t){e.datePricker=t},e.handleQuickDepositVisibleChange=function(t){e.setState({isQuickDepositVisible:t}),t&&setTimeout((function(){Y.a.rebuild()}),20)},e.onExpirationSelectChange=function(t){"SPECIFIC"===t.target.value?e.datePricker.picker.handleOpenChange(!0):e.datePricker.picker.handleOpenChange(!1),e.props.onExpirationTypeChange(t)},e.onExpirationSelectClick=function(t){"SPECIFIC"===t.target.value&&(e.firstClick&&(e.secondClick=!0),e.firstClick=!0,e.secondClick&&(e.datePricker.picker.handleOpenChange(!0),e.firstClick=!1,e.secondClick=!1))},e.onExpirationSelectBlur=function(){e.firstClick=!1,e.secondClick=!1},e.state={forceReRender:!1,isSettleModalVisible:!1},e.showSettleModal=e.showSettleModal.bind(e),e.hideSettleModal=e.hideSettleModal.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Z(t,[{key:"_forceRender",value:function(e){this.state.forceReRender&&this.setState({forceReRender:!1}),this.props.parentWidth!==e.parentWidth&&this.setState({forceReRender:!0})}},{key:"shouldComponentUpdate",value:function(e,t){return this._forceRender(e,t),t.isSettleModalVisible!==this.state.isSettleModalVisible||e.amount!==this.props.amount||e.onBorrow!==this.props.onBorrow||e.total!==this.props.total||e.currentPrice!==this.props.currentPrice||e.price!==this.props.price||e.balance!==this.props.balance||e.account!==this.props.account||e.className!==this.props.className||!(!e.fee||!this.props.fee)&&e.fee.ne(this.props.fee)||e.isPredictionMarket!==this.props.isPredictionMarket||e.feeAsset!==this.props.feeAsset||e.isOpen!==this.props.isOpen||e.hasFeeBalance!==this.props.hasFeeBalance||e.expirationType!==this.props.expirationType||e.expirationCustomTime!==this.props.expirationCustomTime||e.parentWidth!==this.props.parentWidth||t.forceReRender!==this.state.forceReRender||e.singleColumnOrderForm!==this.props.singleColumnOrderForm||e.hideFunctionButtons!==this.props.hideFunctionButtons||t.isQuickDepositVisible!==this.state.isQuickDepositVisible}},{key:"showSettleModal",value:function(){this.setState({isSettleModalVisible:!0})}},{key:"hideSettleModal",value:function(){this.setState({isSettleModalVisible:!1})}},{key:"_addBalance",value:function(e){"bid"===this.props.type?this.props.totalChange({target:{value:e.getAmount({real:!0}).toString()}}):this.props.amountChange({target:{value:e.getAmount({real:!0}).toString()}})}},{key:"_setPrice",value:function(e){this.props.priceChange({target:{value:e.toString()}})}},{key:"onDeposit",value:function(){this.setState({isQuickDepositVisible:!1}),this.props.onDeposit()}},{key:"onBuy",value:function(){this.setState({isQuickDepositVisible:!1}),this.props.onBuy()}},{key:"render",value:function(){var e=this,t=this.props,a=t.type,n=t.quote,o=t.base,i=t.amountChange,c=t.fee,u=t.isPredictionMarket,p=t.priceChange,d=t.onSubmit,h=t.balance,m=t.totalChange,b=t.balancePrecision,y=t.currentPrice,_=t.currentPriceObject,k=t.feeAsset,E=t.feeAssets,C=t.hasFeeBalance,S=t.hideHeader,A=t.verticalOrderForm,x=this.props.expirationCustomTime,O=!!((this.refs.order_form?this.refs.order_form.clientWidth:0)<450||this.props.singleColumnOrderForm),P=void 0,N=void 0,M=void 0;this.props.amount&&(P=this.props.amount),this.props.price&&(N=this.props.price),this.props.total&&(M=this.props.total);var j=new B.a({amount:h?h.get("balance"):0,precision:b,asset_id:this.props.balanceId}),R=new B.a({amount:o.getIn(["options","max_market_fee"]),asset_id:o.get("asset_id"),precision:o.get("precision")}),L=new B.a({amount:n.getIn(["options","max_market_fee"]),asset_id:n.get("asset_id"),precision:n.get("precision")}),D=o.getIn(["options","market_fee_percent"])/100+"%",V=n.getIn(["options","market_fee_percent"])/100+"%",z=P?Math.min(L.getAmount({real:!0}),P*n.getIn(["options","market_fee_percent"])/1e4).toFixed(L.precision):0,J=P?Math.min(R.getAmount({real:!0}),M*o.getIn(["options","market_fee_percent"])/1e4).toFixed(R.precision):0,Y=T.a.getFlagBooleans(o.getIn(["options","flags"]),o.has("bitasset_data_id")),Z=T.a.getFlagBooleans(n.getIn(["options","flags"]),n.has("bitasset_data_id")),X=F.a.replaceName(this.props.base),$=X.name,ee=X.prefix,te=Y.charge_market_fee?A?r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:D,asset:(ee||"")+$})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",D),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{placeholder:"0.0",id:"baseMarketFee",defaultValue:J,value:J,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{noTip:!0,name:o.get("symbol")}))})))):O?r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:D,asset:(ee||"")+$})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-3 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",D),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{placeholder:"0.0",id:"baseMarketFee",defaultValue:J,value:J,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{noTip:!0,name:o.get("symbol")}))})))):r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:D,asset:(ee||"")+$})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",D),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{placeholder:"0.0",id:"baseMarketFee",defaultValue:J,value:J,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{noTip:!0,name:o.get("symbol")}))})))):null,ae=F.a.replaceName(this.props.quote),ne=ae.name,re=ae.prefix,oe=Z.charge_market_fee?A?r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:V,asset:(re||"")+ne})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",V),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:z,value:z,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{style:{width:100},noTip:!0,name:n.get("symbol")}))})))):O?r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:V,asset:(re||"")+ne})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-3 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",V),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:z,value:z,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{style:{width:100},noTip:!0,name:n.get("symbol")}))})))):r.a.createElement(f.Tooltip,{title:v.a.translate("tooltip.market_fee",{percent:V,asset:(re||"")+ne})},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-12 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"}),", ",V),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{placeholder:"0.0",id:"quoteMarketFee",defaultValue:z,value:z,addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{style:{width:100},noTip:!0,name:n.get("symbol")}))})))):null,se=A?null:r.a.createElement("div",{style:{visibility:"hidden"},className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-3 buy-sell-label"},r.a.createElement(I.a,{content:"explorer.asset.summary.market_fee"})),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{placeholder:"0.0",id:"emptyPlaceholder",defaultValue:"0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{style:{width:100},noTip:!0,name:n.get("symbol")}))}))),ie="bid"===a,le=ie&&oe?oe:!ie&&te?te:oe||te?se:null,ce=ie?j.getAmount({real:!0})>=parseFloat(M):j.getAmount({real:!0})>=parseFloat(P),ue=ie?v.a.translate("exchange.buy"):v.a.translate("exchange.sell"),pe=!u&&!(j.getAmount()>0&&ce),de=!(N>0),he=!(P>0),me=pe||de||he,fe=g()(a,{disabled:me}),be=ie?o.get("symbol"):n.get("symbol"),ge=de?v.a.translate("exchange.invalid_price"):he?v.a.translate("exchange.invalid_amount"):pe?v.a.translate("exchange.no_balance"):null;E[1]&&"1.3.0"===E[1].getIn(["options","core_exchange_rate","quote","asset_id"])&&"1.3.0"===E[1].getIn(["options","core_exchange_rate","base","asset_id"])&&(k=E[0],E.splice(1,1));var ye=0,ve=E.map((function(e){var t=F.a.replaceName(e),a=t.name,n=t.prefix;return r.a.createElement(f.Select.Option,{key:e.get("id"),value:ye++},n,a)})),_e=void 0;_e=k.get("symbol")===be?j.clone(j.getAmount()-c.getAmount()):j;ie?v.a.translate("walkthrough.buy_form"):v.a.translate("walkthrough.sell_form");var ke=void 0;"SPECIFIC"!==this.props.expirationType&&(ke=this.props.expirations[this.props.expirationType].get());var Ee=Object.keys(this.props.expirations).map((function(t){return r.a.createElement("option",{value:t,key:t},"SPECIFIC"===t&&"Specific"!==x?w()(x).format("Do MMM YYYY hh:mm A"):e.props.expirations[t].title)})),we=void 0;we=A?r.a.createElement("div",{className:"small-12"},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-12 buy-sell-label",content:"exchange.price"}),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Price",value:N,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")})," / ",r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-12 buy-sell-label",content:"transfer.amount"}),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Amount",value:P,onChange:i,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-12 buy-sell-label",content:"exchange.total"}),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Total",value:M,onChange:m,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-12 buy-sell-label",content:"transfer.fee"}),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Fee",placeholder:"0.0",defaultValue:C?c.getAmount({real:!0}):v.a.translate("transfer.errors.insufficient"),disabled:!0,addonAfter:r.a.createElement(f.Select,{style:{width:100},disabled:1===E.length,defaultValue:E.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ve)}))),le):O?r.a.createElement("div",{className:"small-12"},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"exchange.price"}),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{id:a+"Price",value:N,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")})," / ",r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"transfer.amount"}),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{id:a+"Amount",value:P,onChange:i,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"exchange.total"}),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{id:a+"Total",value:M,onChange:m,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")}))}))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"transfer.fee"}),r.a.createElement("div",{className:"inputAddon small-9"},r.a.createElement(W.a,{id:a+"Fee",placeholder:"0.0",value:C?c.getAmount({real:!0}):v.a.translate("transfer.errors.insufficient"),disabled:!0,addonAfter:r.a.createElement(f.Select,{style:{width:100},disabled:1===E.length,defaultValue:E.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ve)}))),le):r.a.createElement("div",{className:"small-12"},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("div",{className:"small-11 grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"exchange.price"}),r.a.createElement("div",{className:"small-9 buy-sell-label",style:{textAlign:"right"}},r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.props.setPrice.bind(this,a,_.sellPrice())},r.a.createElement(U,{price:y,quote:n,base:o})," "))),r.a.createElement("div",{className:"inputAddon small-11"},r.a.createElement(W.a,{id:a+"Price",value:N,onChange:p,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")})," / ",r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"small-6"},r.a.createElement("div",{className:"small-12 grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"exchange.total"}),r.a.createElement("div",{className:"small-9 buy-sell-label",style:{textAlign:"right"}},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"exchange.balance"})," ",r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._addBalance.bind(this,_e)},F.a.format_number(j.getAmount({real:!0}),b)," "))),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Total",value:M,onChange:m,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")}))})))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"transfer.amount"}),r.a.createElement("div",{className:"inputAddon small-11"},r.a.createElement(W.a,{id:a+"Amount",value:P,onChange:i,autoComplete:"off",placeholder:"0.0",addonAfter:r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")}))}))),r.a.createElement("div",{className:"small-6"},r.a.createElement(I.a,{className:"small-3 buy-sell-label",content:"transfer.fee"}),r.a.createElement("div",{className:"inputAddon small-12"},r.a.createElement(W.a,{id:a+"Fee",placeholder:"0.0",defaultValue:C?c.getAmount({real:!0}):v.a.translate("transfer.errors.insufficient"),disabled:!0,addonAfter:r.a.createElement(f.Select,{style:{width:100},disabled:1===E.length,defaultValue:E.indexOf(this.props.feeAsset),onChange:this.props.onChangeFeeAsset},ve)})))));var Ce=ie?o:n,Se=!!Ce.get("bitasset")&&Ce.get("bitasset").get("settlement_fund")>0;s.a.getState().currentAccount;return r.a.createElement("div",{className:g()(this.props.className),style:this.props.styles},r.a.createElement("div",{className:"buy-sell-container",style:{paddingRight:5}},S?null:r.a.createElement("div",{className:"exchange-content-header exchange-content-header--buy-sell-form "+a},r.a.createElement("span",null,r.a.createElement(q.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!0,keys:[{type:"asset",value:n.get("symbol"),arg:"asset"},{type:"translate",value:u?"exchange.short":ie?"exchange.buy":"exchange.sell",arg:"direction"}]})),this.props.onFlip&&!this.props.hideFunctionButtons?r.a.createElement("span",{onClick:this.props.onFlip,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇆"):null,this.props.onTogglePosition&&!this.props.hideFunctionButtons?r.a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,this.props.moveOrderForm&&!this.props.hideFunctionButtons?r.a.createElement(Q.a,{onClick:this.props.moveOrderForm,name:"thumb-tack",className:"icon-14px icon-fill order-book-button-v",style:{marginLeft:5}}):null),r.a.createElement("form",{ref:"order_form",className:(this.props.isOpen?"":"hide-container ")+"order-form",style:{fontSize:"14px"},noValidate:!0},r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},this.props.moveOrderForm&&A?r.a.createElement("div",{style:{width:"100%",textAlign:"right"},onClick:this.props.moveOrderForm},r.a.createElement(Q.a,{name:"thumb-tack",className:"icon-18px icon-fill order-book-button-v"})):null,we),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:O?"small-12 grid-block":"small-6"},r.a.createElement(I.a,{className:"small-4 buy-sell-label",content:"transaction.expiration"}),r.a.createElement("div",{className:"small-8 expiration-datetime-picker"},r.a.createElement(G.a,{ref:this.getDatePickerRef,className:"expiration-datetime-picker--hidden",showTime:!0,showToday:!1,disabledDate:function(e){return e<w()().add(59,"minutes")},value:"Specific"!==x?x:w()().add(1,"hour"),onChange:this.props.onExpirationCustomChange}),r.a.createElement("select",{className:"cursor-pointer",onChange:this.onExpirationSelectChange,onClick:this.onExpirationSelectClick,onBlur:this.onExpirationSelectBlur,"data-tip":ke&&w()(ke).format("Do MMM YYYY hh:mm A"),value:this.props.expirationType},Ee))),O?null:r.a.createElement("div",{className:"small-6"},le),r.a.createElement("div",{className:"small-12 medium-12 xlarge-12"},O?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-4 buy-sell-label",content:ie?"exchange.lowest_ask":"exchange.highest_bid"}),r.a.createElement("div",{className:"small-8 buy-sell-label"},r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.props.setPrice.bind(this,a,_.sellPrice())},r.a.createElement(U,{price:y,quote:n,base:o})," ",r.a.createElement(H.a,{name:o.get("symbol"),noTip:!0}),"/",r.a.createElement(H.a,{name:n.get("symbol"),noTip:!0})))):null,O?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement(I.a,{className:"small-4 buy-sell-label",content:"exchange.balance"}),r.a.createElement("div",{className:"small-8 buy-sell-label"},r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._addBalance.bind(this,_e)},F.a.format_number(j.getAmount({real:!0}),b)," ",r.a.createElement(H.a,{name:be,noTip:!0})))):null,r.a.createElement("div",{style:{marginTop:10}},r.a.createElement("div",null,r.a.createElement(f.Tooltip,{placement:"top",title:ge||""},r.a.createElement(f.Button,{className:me?null:fe,disabled:me,onClick:d.bind(this,!0),type:"primary",style:{margin:5}},ie?"Buy":"Sell")),this.props.currentBridges&&!this.props.backedCoin?r.a.createElement(f.Tooltip,{title:l.a.isDown("TRADE")?v.a.translate("external_service_provider.is_down"):v.a.translate("exchange.quick_deposit_bridge",{target:ie?$:ne})},r.a.createElement(f.Button,{style:{margin:5},onClick:this.props.onBuy.bind(this),disabled:l.a.isDown("TRADE")||!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},r.a.createElement(I.a,{content:"exchange.quick_deposit",asset:ie?$:ne}))):null,this.props.backedCoin&&!this.props.currentBridges?r.a.createElement(f.Tooltip,{title:l.a.isDown("OPEN")?v.a.translate("external_service_provider.is_down"):v.a.translate("tooltip.gateway")},r.a.createElement(f.Button,{style:{margin:5},onClick:this.props.onDeposit.bind(this),disabled:l.a.isDown("OPEN")||!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},r.a.createElement(I.a,{content:"exchange.quick_deposit",asset:ie?$:ne}))):null,this.props.currentBridges&&this.props.backedCoin?r.a.createElement(f.Popover,{title:r.a.createElement(I.a,{content:"exchange.quick_deposit",asset:ie?$:ne}),trigger:"click",visible:this.state.isQuickDepositVisible,onVisibleChange:this.handleQuickDepositVisibleChange,content:r.a.createElement("div",null,r.a.createElement(f.Tooltip,{title:l.a.isDown("OPEN")?v.a.translate("external_service_provider.is_down"):v.a.translate("exchange.quick_deposit_gateway",{asset:ie?$:ne})},r.a.createElement(f.Button,{style:{marginRight:5},onClick:this.onDeposit.bind(this),disabled:l.a.isDown("OPEN")},r.a.createElement(I.a,{content:"exchange.quick_deposit_gateway_button"}))),r.a.createElement(f.Tooltip,{title:l.a.isDown("TRADE")?v.a.translate("external_service_provider.is_down"):v.a.translate("exchange.quick_deposit_bridge",{target:ie?$:ne})},r.a.createElement(f.Button,{onClick:this.onBuy.bind(this),disabled:l.a.isDown("TRADE")},r.a.createElement(I.a,{content:"exchange.quick_deposit_bridge_button"}))))},r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.quick_deposit_tooltip",{asset:ie?$:ne})},r.a.createElement(f.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id")},r.a.createElement(I.a,{content:"exchange.quick_deposit",asset:ie?$:ne})))):null,this.props.onBorrow&&!Se?r.a.createElement(f.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id"),onClick:this.props.onBorrow},r.a.createElement(I.a,{content:"exchange.borrow"})):null,Se?r.a.createElement(f.Button,{style:{margin:5},disabled:!this.props.currentAccount||"1.2.3"===this.props.currentAccount.get("id"),onClick:this.showSettleModal,"data-tip":v.a.translate("exchange.settle_globally_settled_tooltip")},r.a.createElement(I.a,{content:"exchange.settle_globally_settled"})):null)))),r.a.createElement("div",null,r.a.createElement("div",{className:"grid-content clear-fix no-padding"},ge&&u?r.a.createElement(f.Tooltip,{title:ge,placement:"right"},r.a.createElement("div",{style:{paddingRight:10},className:"float-right"},r.a.createElement("input",{style:{margin:0},className:fe,type:"submit",onClick:d.bind(this,!1),value:ue}))):u?r.a.createElement(f.Tooltip,{title:"",placement:"right"},r.a.createElement("div",{style:{paddingRight:10},className:"float-right"},r.a.createElement("input",{style:{margin:0},className:fe,type:"submit",onClick:d.bind(this,!1),value:ue}))):null)))),Se&&!!this.props.currentAccount&&r.a.createElement(K.a,{visible:this.state.isSettleModalVisible,hideModal:this.hideSettleModal,showModal:this.showSettleModal,asset:Ce.get("id"),account:this.props.currentAccount}))}}]),t}(r.a.Component);X.propTypes={balance:R.a.ChainObject,type:x.a.string,amountChange:x.a.func.isRequired,priceChange:x.a.func.isRequired,onSubmit:x.a.func.isRequired,onExpirationTypeChange:x.a.func.isRequired,onExpirationCustomChange:x.a.func.isRequired},X.defaultProps={type:"bid"};var $=Object(L.a)(X),ee=a(360),te=a(170),ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},re={integer:function(e){return re.number(e)&&parseInt(e,10)===Number(e)},float:function(e){return re.number(e)&&!re.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(e){return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear},number:function(e){return!isNaN(e)&&!isNaN(Number(e))&&"number"==typeof Number(e)},object:function(e){return"object"===(void 0===e?"undefined":ae(e))&&!re.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&!!e.match(ne.email)&&e.length<255},url:function(e){return"string"==typeof e&&!!e.match(ne.url)},hex:function(e){return"string"==typeof e&&!!e.match(ne.hex)},string:function(e){return"string"==typeof e},boolean:function(e){return"boolean"==typeof e},enum:function(e,t){return Array.isArray(t)&&t.indexOf(e)>=-1}},oe=re,se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?v.a.translate("validation.messages.requiredNamed",{name:e}):v.a.translate("validation.messages.required")},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?v.a.translate("validation.messages.types."+e+"Named",{name:t,type:e}):v.a.translate("validation.messages.types."+e,{type:e})},ce=function(e,t,a){return a?v.a.translate("validation.messages.rangeNamed",{name:a,min:e,max:t}):v.a.translate("validation.messages.range",{min:e,max:t})},ue=function(e,t){return t?v.a.translate("validation.messages.minNamed",{name:t,min:e}):v.a.translate("validation.messages.min",{min:e})},pe=function(e,t){return t?v.a.translate("validation.messages.maxNamed",{name:t,max:e}):v.a.translate("validation.messages.max",{max:e})},de=function(e){return e?v.a.translate("validation.messages.numberNamed",{name:e}):v.a.translate("validation.messages.number")},he=function(e){return e?v.a.translate("validation.messages.integerNamed",{name:e}):v.a.translate("validation.messages.integer")},me=function(e){return e?v.a.translate("validation.messages.floatNamed",{name:e}):v.a.translate("validation.messages.float")},fe=function(e){return e?v.a.translate("validation.messages.emailNamed",{name:e}):v.a.translate("validation.messages.email")},be=function(e){return e?v.a.translate("validation.messages.urlNamed",{name:e}):v.a.translate("validation.messages.url")},ge=function(e,t){return e?v.a.translate("validation.messages.oneOfNamed",{name:e,list:t}):v.a.translate("validation.messages.oneOf",{list:t})},ye=function(e,t){return v.a.translate("validation.messages.balance",{balance:e,symbol:t})},ve={required:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";return t="string"==typeof e?e:e&&e.name,{required:!0,message:ie(t)}},type:function(e){var t="",a="";if("string"==typeof e&&(t=e),e&&e.type&&(t=e.type),e&&e.name&&(a=e.name),""===t)throw new Error("[Validation] Rules.Type the property type is missed");if(!oe[t])throw new Error("[Validation] Rules.Type the property type '"+(e&&e.type)+"' is not listed in supported types");return{validator:function(e,a,n){return oe[t](a)?n():n(!1)},message:le(t,a)}},range:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Number(e.max),a=Number(e.min);if(void 0===t||isNaN(t))throw new Error("[Validation] Rules.Range the property max '"+(e&&e.max)+"' is incorrect. Should be a number");if(void 0===a||isNaN(a))throw new Error("[Validation] Rules.Range the property min '"+(e&&e.min)+"' is incorrect. Should be a number");if(t<a)throw new Error("[Validation] Rules.Range the property min '"+(e&&e.min)+"' cannot be higher than max '"+(e&&e.max)+"'");return{validator:function(e,n,r){return n=Number(n),isNaN(n)||n<a||n>t?r(!1):r()},message:ce(a,t,e.name||"")}},min:function(e){var t=void 0;if(t="object"===(void 0===e?"undefined":se(e))?Number(e&&e.min):Number(e),void 0===t||isNaN(t))throw new Error("[Validation] Rules.Min the property min '"+(e&&e.min)+"' is incorrect. Should be a number");return{validator:function(a,n,r){if(n=Number(n),e&&e.higherThan){if(isNaN(n)||n<=t)return r(!1)}else if(isNaN(n)||n<t)return r(!1);return r()},message:ue(t,e.name||"")}},max:function(e){var t=void 0;if(t="object"===(void 0===e?"undefined":se(e))?Number(e&&e.max):Number(e),void 0===t||isNaN(t))throw new Error("[Validation] Rules.Min the property max '"+(e&&e.max)+"' is incorrect. Should be a number");return{validator:function(e,a,n){return a=Number(a),isNaN(a)||a>t?n(!1):n()},message:pe(t,e.name||"")}},number:function(e){return{validator:function(e,t,a){return oe.number(t)?a():a(!1)},message:de(e||"")}},integer:function(e){return{validator:function(e,t,a){return oe.integer(t)?a():a(!1)},message:he(e||"")}},float:function(e){return{validator:function(e,t,a){return oe.float(t)?a():a(!1)},message:me(e||"")}},email:function(e){return{validator:function(e,t,a){return oe.email(t)?a():a(!1)},message:fe(e||"")}},url:function(e){return{validator:function(e,t,a){return oe.url(t)?a():a(!1)},message:be(e||"")}},oneOf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0;if(!Array.isArray(e&&e.list))throw new Error("[Validation] Rules.oneOf the property list is missed or incorrect");return t=e.list,{validator:function(e,a,n){return-1===t.indexOf(a)?n(!1):n()},message:ge(e&&e.name||"",t.toString().replace(/,([a-z])/g,", $1"))}},balance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ve.range({min:0,max:e.balance});return{validator:t.validator,message:ye(e.balance,e.symbol)}}},_e={Rules:ve},ke=function(e){return function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return+e(t,a).toFixed(n)}},Ee=function(e,t){return e+t},we=function(e,t){return e-t},Ce=function(e,t){return e*t},Se=function(e,t){return e/t},Ae=function(e,t,a){return ke(Ee)(e,t,a)},xe=function(e,t,a){return ke(we)(e,t,a)},Oe=function(e,t,a){return ke(Ce)(e,t,a)},Pe=function(e,t,a){return ke(Se)(e,t,a)},Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ne=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var je=function(e){function t(e){Be(this,t);var a=Me(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getDatePickerRef=function(e){a.datePricker=e},a.onExpirationSelectChange=function(e){"SPECIFIC"===e.target.value?a.datePricker.picker.handleOpenChange(!0):a.datePricker.picker.handleOpenChange(!1),a.props.onExpirationTypeChange(e)},a.onExpirationSelectClick=function(e){"SPECIFIC"===e.target.value&&(a.firstClick&&(a.secondClick=!0),a.firstClick=!0,a.secondClick&&(a.datePricker.picker.handleOpenChange(!0),a.firstClick=!1,a.secondClick=!1))},a.onExpirationSelectBlur=function(){a.firstClick=!1,a.secondClick=!1},a.state={orderCount:1,feeAssets:[]},a.handleClickBalance=a.handleClickBalance.bind(a),a.handleCurrentPriceClick=a.handleCurrentPriceClick.bind(a),a}return Fe(t,e),Ne(t,[{key:"componentDidMount",value:function(){this._checkFeeAssets()}},{key:"componentDidUpdate",value:function(){var e=this,t=Number(this._getFormValues().orderCount||1),a=Number(this.state.orderCount);isNaN(a)||isNaN(t)||Number(this.state.orderCount)===t||this.setState({orderCount:t},(function(){e._checkFeeAssets()}))}},{key:"isFormValid",value:function(){var e=this._getFormValues();return!!e&&(!(!e.priceLower||isNaN(Number(e.priceLower))||Number(e.priceLower)<=0)&&(!(!e.amount||isNaN(Number(e.amount))||Number(e.amount)<=0)&&(!(!e.priceUpper||isNaN(Number(e.priceUpper))||Number(e.priceUpper)<=0||Number(e.priceUpper)<=Number(e.priceLower))&&!(!e.orderCount||isNaN(Number(e.orderCount))||Number(e.orderCount)<=1))))}},{key:"_getBaseAssetFlags",value:function(){return T.a.getFlagBooleans(this.props.baseAsset.getIn(["options","flags"]),this.props.baseAsset.has("bitasset_data_id"))}},{key:"_getQuoteAssetFlags",value:function(){return T.a.getFlagBooleans(this.props.quoteAsset.getIn(["options","flags"]),this.props.quoteAsset.has("bitasset_data_id"))}},{key:"_isMarketFeeVisible",value:function(){var e=this._getBaseAssetFlags(),t=this._getQuoteAssetFlags();return!(this._getFormValues().action!==ee.b.SELL||!e.charge_market_fee)||!(this._getFormValues().action!==ee.b.BUY||!t.charge_market_fee)}},{key:"_getFormValues",value:function(){return this.props.form.getFieldsValue()}},{key:"_filterFeeStatuses",value:function(e){return e.filter((function(e){return e&&e.hasPoolBalance&&e.hasBalance})).map((function(e){return{fee:e,amount:e.fee.getAmount()/Math.pow(10,e.fee.precision),asset:te.a.getAsset(e.fee.asset_id)}}))}},{key:"_checkFeeAssets",value:function(){var e=this;this._getAccountAssetsFeeStatus().then((function(t){var a=e._filterFeeStatuses(t);e.setState({feeAssets:a})}))}},{key:"_getAccountAssetsFeeStatus",value:function(){var e=this.props.currentAccount,t=this._getFormValues().orderCount;return!!(e&&e.get&&e.get("balances"))&&new Promise((function(a){var n=[];e.get("balances").forEach((function(a){var r=te.a.getObject(a),o=Object(M.b)({accountID:e.get("id"),feeID:r.get("asset_type"),type:"limit_order_create",operationsCount:t});n.push(o)})),Promise.all(n).then((function(e){a(e)}))}))}},{key:"_getFee",value:function(){var e=this._getFormValues(),t=0;return e&&e.feeCurrency&&this.state.feeAssets.forEach((function(a){a&&a.asset&&a.asset.get("symbol")===e.feeCurrency&&(t=a.amount)})),t}},{key:"_getMarketFee",value:function(){var e=this._getFormValues(),t=this.props.baseAsset,a=this.props.quoteAsset,n=Number(this._getTotal()),r=e.action;if(isNaN(n))return null;var o=null;if(r===ee.b.SELL&&(o=t),r===ee.b.BUY&&(o=a),!o||!o.get||!o.getIn)return null;var s=new B.a({amount:o.getIn(["options","max_market_fee"]),asset_id:o.get("asset_id"),precision:o.get("precision")}),i=this._getMarketFeePercentage();return n?Math.min(s.getAmount({real:!0}),n/100*i).toFixed(s.precision):0}},{key:"_getMarketFeePercentage",value:function(){var e=this._getFormValues().action,t=this.props.baseAsset,a=this.props.quoteAsset,n=null;return e===ee.b.SELL&&(n=t),e===ee.b.BUY&&(n=a),Number(n.getIn(["options","market_fee_percent"])/100)}},{key:"_getTotal",value:function(){var e=this._getFormValues(),t=Number(e.amount),a=Number(e.priceLower),n=Number(e.priceUpper),r=Number(e.orderCount),o=function(e){return!isNaN(e)};if(!o(a)||!o(n)||!o(t)||!o(r)||r<=1||r<=0||a>=n)return 0;for(var s=Pe(xe(n,a),xe(r,1)),i=Pe(t,r),l=0,c=0;c<r;c+=1)l=Ae(l,Oe(i,Ae(a,Oe(s,c))));return l}},{key:"_getQuantityFromTotal",value:function(e){var t=this._getFormValues(),a=Number(t.priceLower),n=Number(t.priceUpper),r=Number(t.orderCount),o=function(e){return!isNaN(e)};if(!o(a)||!o(n)||!o(e)||!o(r)||r<=0||a>=n)return 0;for(var s=Pe(xe(n,a),xe(r,1)),i=0,l=0;l<r;l+=1)i=Ae(i,Number(Pe(Ae(a,Oe(s,l)),r)));return Pe(e,i)}},{key:"_getPreviewDataSource",value:function(){var e=this._getFormValues(),t=[],a=e.action,n=Number(e.amount),r=Number(e.priceLower),o=Number(e.priceUpper),s=Number(e.orderCount),i=function(e){return!isNaN(e)};if(!i(r)||!i(o)||!i(n)||!i(s)||s<=0||r>=o)return[];for(var l=((o-r)/(s-1)).toFixed(6),c=n/s,u=0;u<s;u+=1)t.push({quote:c.toFixed(6),base:(c*(r+l*u)).toFixed(6),price:(r+l*u).toFixed(6)});return a===ee.b.BUY?t.reverse():t}},{key:"handleClickBalance",value:function(){"bid"===this.props.type?this.props.form.setFieldsValue({amount:this._getQuantityFromTotal(this.props.baseAssetBalance)}):this.props.form.setFieldsValue({amount:this.props.quoteAssetBalance})}},{key:"handleCurrentPriceClick",value:function(){this.props.form.setFieldsValue({priceLower:this.props.currentPrice})}},{key:"render",value:function(){var e=this,t=this.props,a=t.type,n=t.quoteAsset,o=t.baseAsset,s=t.expirationCustomTime,i="bid"===a,l=n,c=o,u=this.props.form.getFieldDecorator,p=i?r.a.createElement(H.a,{name:this.props.quoteAsset.get("symbol")}):r.a.createElement(H.a,{name:this.props.baseAsset.get("symbol")}),d=r.a.createElement(H.a,{name:this.props.quoteAsset.get("symbol")}),h=r.a.createElement(H.a,{name:this.props.baseAsset.get("symbol")}),m=r.a.createElement("span",null,r.a.createElement(H.a,{dataPlace:"right",name:o.get("symbol")})," / ",r.a.createElement(H.a,{dataPlace:"right",name:n.get("symbol")})),b={labelCol:{span:6},wrapperCol:{span:16,offset:2}},g=(u("action",{initialValue:i?ee.b.BUY:ee.b.SELL})(r.a.createElement(f.Radio.Group,null,r.a.createElement(f.Radio,{value:ee.b.BUY},v.a.translate("scaled_orders.action.buy")),r.a.createElement(f.Radio,{value:ee.b.SELL},v.a.translate("scaled_orders.action.sell")))),u("priceLower",{validateFirst:!0,validateTrigger:"onBlur",rules:[_e.Rules.required(),_e.Rules.number(),_e.Rules.min({min:0,name:"Price",higherThan:!0})]})(r.a.createElement(f.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:m}))),y=this._getFormValues(),_=Number(y&&y.priceLower||0),k=u("priceUpper",{validateFirst:!0,validateTrigger:"onBlur",rules:[_e.Rules.required(),_e.Rules.number(),_e.Rules.min({min:_,name:"Price",higherThan:!0})]})(r.a.createElement(f.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:m})),E=u("feeCurrency",{initialValue:te.a.getAsset("1.3.0")&&te.a.getAsset("1.3.0").get&&te.a.getAsset("1.3.0").get("symbol")})(r.a.createElement(f.Select,{showSearch:!0,dropdownMatchSelectWidth:!1,style:{minWidth:"80px",maxWidth:"120px"}},this.state.feeAssets&&this.state.feeAssets.map&&this.state.feeAssets.map((function(e){return r.a.createElement(f.Select.Option,{key:e.asset.get("symbol"),value:""+e.asset.get("symbol")},r.a.createElement(H.a,{name:e.asset.get("symbol"),noTip:!0}))})))),C=r.a.createElement(f.Input,{disabled:!0,placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:E,value:this._getFee()}),S=r.a.createElement(f.Input,{disabled:!0,style:{width:"100%"},autoComplete:"off",addonAfter:p,value:this._getMarketFee()}),A=r.a.createElement(f.Input,{disabled:!0,style:{width:"100%"},autoComplete:"off",addonAfter:h,value:this._getTotal()}),x=_e.Rules.balance({balance:this.props.baseAssetBalance,symbol:this.props.baseAsset.get("symbol")}),O=x.validator(null,this._getTotal(),(function(e){return void 0===e})),P=i&&!O?x.message:null,T=i&&!O?"error":"",N=[_e.Rules.required(),_e.Rules.number(),_e.Rules.min({min:0,higherThan:!0,name:"Quantity"})];i||N.push(_e.Rules.balance({balance:this.props.quoteAssetBalance,symbol:this.props.quoteAsset.get("symbol")}));var B=u("amount",{validateFirst:!0,validateTrigger:"onBlur",rules:N})(r.a.createElement(f.Input,{placeholder:"0.0",style:{width:"100%"},autoComplete:"off",addonAfter:d})),M=u("orderCount",{validateFirst:!0,rules:[_e.Rules.required(),_e.Rules.number(),_e.Rules.min({min:1,name:"Orders Count",higherThan:!0})]})(r.a.createElement(f.Input,{style:{width:"100%"},placeholder:"0",autoComplete:"off",addonAfter:v.a.translate("scaled_orders.order_s")})),F=v.a.translate(i?"exchange.lowest_ask":"exchange.highest_bid"),j=void 0;"SPECIFIC"!==this.props.expirationType&&(j=this.props.expirations[this.props.expirationType].get());var I=Object.keys(this.props.expirations).map((function(t){return r.a.createElement("option",{value:t,key:t},"SPECIFIC"===t&&"Specific"!==s?w()(s).format("Do MMM YYYY hh:mm A"):e.props.expirations[t].title)}));return r.a.createElement("div",{className:"buy-sell-container",style:{padding:"5px"}},r.a.createElement(f.Form,{className:"order-form",layout:"horizontal",hideRequiredMark:!0,style:{padding:"8px 15px"}},r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.price_lower")}),g),r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.price_upper")}),k),r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.quantity")}),B),r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.order_count")}),M),r.a.createElement(f.Form.Item,Te({},b,{help:P,validateStatus:T,label:v.a.translate("scaled_orders.total")}),A),r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.fee")}),C),this._isMarketFeeVisible()?r.a.createElement(f.Form.Item,Te({},b,{label:v.a.translate("scaled_orders.market_fee")+" "+this._getMarketFeePercentage()+"%"}),S):null,r.a.createElement(f.Form.Item,Te({label:v.a.translate("transaction.expiration")},b),r.a.createElement("div",{className:"expiration-datetime-picker scaled-orders",style:{marginTop:"5px"}},r.a.createElement(G.a,{ref:this.getDatePickerRef,className:"expiration-datetime-picker--hidden",showTime:!0,showToday:!1,disabledDate:function(e){return e<w()().add(59,"minutes")},value:"Specific"!==s?s:w()().add(1,"hour"),onChange:this.props.onExpirationCustomChange}),r.a.createElement("select",{className:"cursor-pointer",style:{marginTop:"5px"},onChange:this.onExpirationSelectChange,onClick:this.onExpirationSelectClick,onBlur:this.onExpirationSelectBlur,"data-tip":j&&w()(j).format("Do MMM YYYY hh:mm A"),value:this.props.expirationType},I))),r.a.createElement(f.Form.Item,Te({label:F},b),r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.handleCurrentPriceClick},r.a.createElement(U,{price:this.props.currentPrice,quote:l,base:c})," ",r.a.createElement(H.a,{name:c.get("symbol"),noTip:!0}),"/",r.a.createElement(H.a,{name:l.get("symbol"),noTip:!0}))),r.a.createElement(f.Form.Item,Te({label:v.a.translate("exchange.balance")},b),r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.handleClickBalance},i?this.props.baseAssetBalance:this.props.quoteAssetBalance," ",r.a.createElement(H.a,{name:i?c.get("symbol"):l.get("symbol"),noTip:!0}))),r.a.createElement(f.Button,{onClick:this.props.handleSubmit,type:"primary",disabled:!this.isFormValid()},v.a.translate(i?"scaled_orders.action.buy":"scaled_orders.action.sell"))))}}]),t}(n.Component);je=f.Form.create({})(je);var Ie=function(e){function t(e){Be(this,t);var a=Me(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.saveFormRef=a.saveFormRef.bind(a),a.handleSubmit=a.handleSubmit.bind(a),a.handleCancel=a.handleCancel.bind(a),a}return Fe(t,e),Ne(t,[{key:"componentDidUpdate",value:function(e){this.props.baseAsset&&e.baseAsset&&this.props.baseAsset.get&&e.baseAsset.get&&this.props.baseAsset.get("id")!==e.baseAsset.get("id")&&this.formRef&&this.formRef.props&&this.formRef.props.form&&this.formRef.props.form.resetFields(),this.props.lastClickedPrice&&this.props.lastClickedPrice!==e.lastClickedPrice&&this.formRef&&this.formRef.props&&this.formRef.props.form&&this.formRef.props.form.setFieldsValue&&this.formRef.props.form.setFieldsValue({priceLower:Number(this.props.lastClickedPrice)})}},{key:"prepareOrders",value:function(e){var t=[],a=Number(e.amount),n=Number(e.priceLower),r=Number(e.priceUpper),o=Number(e.orderCount),s=null;s=(this.props.expirationType,this.props.expirations[this.props.expirationType].get(this.props.type));var i=function(e){return!isNaN(e)};if(!i(n)||!i(r)||!i(a)||!i(o)||o<=0||n>=r)return[];for(var l=((r-n)/(o-1)).toPrecision(5),c=a/o,u=e.action===ee.b.SELL?this.props.quoteAsset:this.props.baseAsset,p=e.action===ee.b.BUY?this.props.quoteAsset:this.props.baseAsset,d=function(t){var a=c*(n+l*t);return e.action===ee.b.BUY?Number(a.toPrecision(5))*Math.pow(10,u.get("precision")):Number(c.toPrecision(5))*Math.pow(10,u.get("precision"))},h=function(t){var a=c*(n+l*t);return e.action===ee.b.SELL?Number(a.toPrecision(5))*Math.pow(10,p.get("precision")):Number(c.toPrecision(5))*Math.pow(10,p.get("precision"))},m=0;m<o;m+=1)t.push({for_sale:new B.a({asset_id:u.get("id"),precision:u.get("precision"),amount:d(m)}),to_receive:new B.a({asset_id:p.get("id"),precision:p.get("precision"),amount:h(m)}),expirationTime:s});this.props.createScaledOrder(t,te.a.getAsset(e.feeCurrency).get("id"))}},{key:"handleSubmit",value:function(){var e=this;this.formRef.props.form.validateFields((function(t,a){t||e.prepareOrders(a)}))}},{key:"handleCancel",value:function(){this.props.hideModal()}},{key:"saveFormRef",value:function(e){this.formRef=e}},{key:"_getBalanceByAssetId",value:function(e,t){var a=0,n=this.props.currentAccount.get("balances");void 0!==n.get(e)&&(a=te.a.getObject(n.get(e)).get("balance")/Math.pow(10,t));return a}},{key:"render",value:function(){var e=this._getBalanceByAssetId(this.props.baseAsset.get("id"),this.props.baseAsset.get("precision")),t=this._getBalanceByAssetId(this.props.quoteAsset.get("id"),this.props.quoteAsset.get("precision"));return r.a.createElement(je,Te({},this.props,{wrappedComponentRef:this.saveFormRef,baseAssetBalance:e,quoteAssetBalance:t,handleSubmit:this.handleSubmit}))}}]),t}(n.Component),qe=a(102),Re=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Le=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={change:null,curMarket:null,marketChange:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Re(t,[{key:"shouldComponentUpdate",value:function(e){return!(!e.volume2||e.volume2===this.props.volume2)||(e.price!==this.props.price||e.ready!==this.props.ready)}},{key:"componentWillReceiveProps",value:function(e){var t={change:0},a=e.market,n=this.state.curMarket!==a,r=null!=this.state.curMarket&&n;t.marketChange=r,t.curMarket=a,t.prevAsset=this.state.marketAsset,e.ready&&this.props.ready&&(t.change=parseFloat(e.price)-parseFloat(this.props.price)),this.setState(t)}},{key:"componentDidUpdate",value:function(){Y.a.rebuild()}},{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.price,o=e.content,s=e.ready,i=e.volume,l=e.toolTip,c=e.ignoreColorChange,u=this.state,p=u.change,d=null;!u.marketChange&&p&&null!==p&&!0!==c&&(d=p>0?"pulsate green":"pulsate red");var h=i?F.a.format_volume(n):F.a.price_text(n,a,t);return r.a.createElement("li",{className:g()("stressed-stat",this.props.className,d),onClick:this.props.onClick},r.a.createElement(f.Tooltip,{placement:"bottom",title:l},r.a.createElement("span",null,r.a.createElement("span",{className:"value stat-primary"},s?h:0," "),r.a.createElement("span",{className:"symbol-text"},r.a.createElement(H.a,{name:t.get("symbol")}))),o?r.a.createElement("div",{className:"stat-text"},r.a.createElement(I.a,{content:o})):null))}}]),t}(r.a.Component),De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ve=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function He(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var We=function(e){function t(){return ze(this,t),Ue(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return He(t,e),Ve(t,[{key:"_getFeedPrice",value:function(){return this.props?1/F.a.get_asset_price(T.a.extractRawFeedPrice(this.props.debtAsset).getIn(["quote","amount"]),this.props.collateralAsset,T.a.extractRawFeedPrice(this.props.debtAsset).getIn(["base","amount"]),this.props.debtAsset):1}},{key:"_getCollateralRatio",value:function(){var e=this.props.object.toJS();return F.a.get_asset_amount(e.collateral,this.props.collateralAsset)/(F.a.get_asset_amount(e.debt,this.props.debtAsset)/this._getFeedPrice())}},{key:"_getMR",value:function(){return this.props.debtAsset.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3}},{key:"_getStatusClass",value:function(){var e=this._getCollateralRatio(),t=this._getMR();return isNaN(e)?null:e<t?"danger":e<t+.5?"warning":""}},{key:"_getCRTip",value:function(){var e=this._getStatusClass(),t=this._getMR();return e&&""!==e?"danger"===e?v.a.translate("tooltip.cr_danger",{mr:t}):"warning"===e?v.a.translate("tooltip.cr_warning",{mr:t}):null:null}},{key:"render",value:function(){var e=this.props.object.toJS(),t=this._getCollateralRatio(),a=(F.a.get_asset_amount(e.debt,this.props.debtAsset),this._getStatusClass());return r.a.createElement(f.Tooltip,{placement:"bottom",title:this._getCRTip()},r.a.createElement("li",{className:g()("stressed-stat",this.props.className),onClick:this.props.onClick},r.a.createElement("span",null,r.a.createElement("span",{className:g()("value stat-primary",a)},F.a.format_number(t,2))),r.a.createElement("div",{className:"stat-text"},r.a.createElement(I.a,{content:"header.collateral_ratio"}))))}}]),t}(r.a.Component);We.propTypes={debtAsset:R.a.ChainAsset.isRequired,collateralAsset:R.a.ChainAsset.isRequired},We=Object(L.a)(We);var Ge=function(e){function t(){return ze(this,t),Ue(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return He(t,e),Ve(t,[{key:"render",value:function(){var e=this.props,t=e.object,a=e.account,n=t.getIn(["call_price","quote","asset_id"]),o=t.getIn(["call_price","base","asset_id"]);return r.a.createElement(We,De({debtAsset:n,collateralAsset:o,account:a},this.props))}}]),t}(r.a.Component);Ge.propTypes={object:R.a.ChainObject.isRequired};var Qe=Ge=Object(L.a)(Ge),Ke=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Je=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={isModalVisible:!1,volumeShowQuote:!0,selectedMarketPickerAsset:e.selectedMarketPickerAsset},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ke(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({selectedMarketPickerAsset:e.selectedMarketPickerAsset})}},{key:"shouldComponentUpdate",value:function(e){return!!e.marketReady}},{key:"_addMarket",value:function(e,t){var a=e+"_"+t;this.props.starredMarkets.has(a)?O.a.removeStarMarket(e,t):O.a.addStarMarket(e,t)}},{key:"changeVolumeBase",value:function(){this.setState({volumeShowQuote:!this.state.volumeShowQuote})}},{key:"marketPicker",value:function(e){var t=this.state.selectedMarketPickerAsset;t=t&&t==e?null:e,this.setState({selectedMarketPickerAsset:t}),this.props.onToggleMarketPicker(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.quoteAsset,o=t.baseAsset,s=t.starredMarkets,i=t.hasPrediction,l=t.feedPrice,c=t.showCallLimit,u=t.lowestCallPrice,p=t.marketReady,d=t.latestPrice,h=t.marketStats,b=t.account,g=o.get("symbol"),y=n.get("symbol"),_=y+"_"+g,k=s.has(_)?"gold-star":"grey-star",E=h.get("change"),w=0===parseFloat(E)||isNaN(E)?"":parseFloat(E)<0?"negative":"positive",C=h.get("volumeBase"),S=h.get("volumeQuote"),A=isNaN(E)?void 0:E>0?"+"+E:E,x=this.state.volumeShowQuote?S:C,O=this.state.volumeShowQuote?n:o,T=!1,N=n.get("id"),M=o.get("id"),F="1.3.0"===N?M:"1.3.0"===M?N:null,j=F?m.ChainStore.getAsset(F):null,q="",R=null,L="exchange.settle",D="tooltip.settle_price";if(!!j&&!!j.get("bitasset")){if(b.toJS&&b.has("call_orders"))for(var V=b.get("call_orders").toJS(),z=0;z<V.length;z++){var U=V[z];if(m.ChainStore.getObject(U).getIn(["call_price","quote","asset_id"])===F){q=U,T=!0;break}}var W="1.3.0"==M?n:"1.3.0"==N?o:n;if(j.get("bitasset").get("settlement_fund")>0)L="exchange.global_settle",D="tooltip.global_settle_price",(R=j.get("bitasset").get("settlement_price").toJS()).base.asset_id==o.get("id")?(R.base.precision=o.get("precision"),R.quote.precision=n.get("precision")):(R.quote.precision=o.get("precision"),R.base.precision=n.get("precision")),R=new B.i({quote:new B.a({asset_id:R.quote.asset_id,precision:R.quote.precision,amount:R.quote.amount}),base:new B.a({asset_id:R.base.asset_id,precision:R.base.precision,amount:R.base.amount})}).toReal(),R="1.3.0"==M?1/R:R;else if(W&&l){var G=W.getIn(["bitasset","options"]).toJS().force_settlement_offset_percent;R="1.3.0"==M?l.toReal()/(1+G/1e4):l.toReal()*(1+G/1e4)}}var K=a(5),J=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==y,Y=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==g,Z=this.props.hasAnyPriceAlert?"exchange--price-alert--show-modal--active":"";return r.a.createElement("div",{className:"grid-block shrink no-padding overflow-visible top-bar"},r.a.createElement("div",{className:"grid-block overflow-visible"},r.a.createElement("div",{className:"grid-block shrink"},r.a.createElement("div",{style:{padding:"10px"}},i?r.a.createElement("a",{className:"market-symbol"},r.a.createElement("span",null,y+" : "+g)):r.a.createElement("div",{style:{padding:"0 5px",fontSize:this.props.tinyScreen?"13px":"18px",marginTop:"1px"}},r.a.createElement(f.Icon,{onClick:this.props.showPriceAlertModal,type:"bell",className:"exchange--price-alert--show-modal "+Z,"data-intro":K.translate("walkthrough.price_alerts")}),r.a.createElement("span",{onClick:this.marketPicker.bind(this,y),className:"underline",style:{cursor:"pointer",color:J?"#2196f3":""}},r.a.createElement(H.a,{name:y,replace:!0,noTip:!0})),r.a.createElement("span",{style:{padding:"0 5px"}},"/"),r.a.createElement("span",{onClick:this.marketPicker.bind(this,g),className:"underline",style:{cursor:"pointer",color:Y?"#2196f3":""}},r.a.createElement(H.a,{name:g,replace:!0,noTip:!0}))),r.a.createElement("div",{className:"label-actions"},r.a.createElement(I.a,{component:"span",style:{padding:"5px 0 0 5px"},className:"stat-text",content:"exchange.trading_pair"}),r.a.createElement(qe.a,{onClick:function(){P.a.switchMarket()},to:"/market/"+g+"_"+y,"data-intro":K.translate("walkthrough.switch_button")},r.a.createElement(Q.a,{className:"shuffle",name:"shuffle",title:"icons.shuffle"})),r.a.createElement("a",{onClick:function(){e._addMarket(e.props.quoteAsset.get("symbol"),e.props.baseAsset.get("symbol"))},"data-intro":K.translate("walkthrough.favourite_button")},r.a.createElement(Q.a,{className:k,name:"fi-star",title:"icons.fi_star.market"}))))),r.a.createElement("div",{className:"grid-block vertical",style:{overflow:"visible"}},r.a.createElement("div",{className:"grid-block wrap market-stats-container"},r.a.createElement("ul",{className:"market-stats stats top-stats"},d?r.a.createElement(Le,{ignoreColorChange:!0,ready:p,price:d,quote:n,base:o,market:_,content:"exchange.latest"}):null,r.a.createElement("li",{className:"hide-order-1 stressed-stat daily_change "+w},r.a.createElement("span",null,r.a.createElement("b",{className:"value"},A?p?A:0:"-"),A&&r.a.createElement("span",null," %")),r.a.createElement(I.a,{component:"div",className:"stat-text",content:"account.hour_24"})),C>=0?r.a.createElement(Le,{ignoreColorChange:!0,onClick:this.changeVolumeBase.bind(this),ready:p,decimals:0,volume:!0,price:x,className:"hide-order-2 clickable",base:O,market:_,content:"exchange.volume_24"}):null,!i&&l?r.a.createElement(Le,{ignoreColorChange:!0,toolTip:v.a.translate("tooltip.feed_price"),ready:p,className:"hide-order-3",price:l.toReal(),quote:n,base:o,market:_,content:"exchange.feed_price"}):null,!i&&R?r.a.createElement(Le,{ignoreColorChange:!0,toolTip:v.a.translate(D),ready:p,className:"hide-order-4",price:R,quote:n,base:o,market:_,content:L}):null,T?r.a.createElement(Qe,{object:q,account:b,className:"hide-order-1"}):null,u&&c?r.a.createElement(Le,{toolTip:v.a.translate("tooltip.call_limit"),ready:p,className:"hide-order-5 is-call",price:u,quote:n,base:o,market:_,content:"explorer.block.call_limit"}):null,l&&c?r.a.createElement(Le,{toolTip:v.a.translate("tooltip.margin_price"),ready:p,className:"hide-order-6 is-call",price:l.getSqueezePrice({real:!0}),quote:n,base:o,market:_,content:"exchange.squeeze"}):null),r.a.createElement("ul",{className:"market-stats stats top-stats","data-position":"left","data-step":"1","data-intro":K.translate("walkthrough.personalize")},r.a.createElement("li",{className:"stressed-stat input clickable",style:{padding:"16px 16px 16px 0px"},onClick:this.props.onTogglePersonalize.bind(this)},r.a.createElement(f.Icon,{type:"setting",style:{paddingRight:5}}),r.a.createElement(I.a,{className:"hide-order-2",content:"exchange.settings.header.title"})))))))}}]),t}(r.a.Component),Ye=a(2074),Ze=a.n(Ye),Xe=a(2046),$e=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function at(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(function(e){function t(){return et(this,t),tt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return at(t,e),$e(t,[{key:"render",value:function(){var e=this.props,t=e.baseSymbol,a=e.quoteSymbol;return r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(I.a,{content:"exchange.price"}),r.a.createElement("br",null),t?r.a.createElement("span",{className:"header-sub-title"},"(",r.a.createElement(H.a,{name:t}),"/",r.a.createElement(H.a,{name:a}),")"):null),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(I.a,{content:"transfer.amount"}),r.a.createElement("br",null),a?r.a.createElement("span",{className:"header-sub-title"},"(",r.a.createElement(H.a,{name:a}),")"):null),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(I.a,{content:"transaction.settlement_date"}),r.a.createElement("br",null),r.a.createElement("span",{style:{visibility:"hidden"},className:"header-sub-title"},"d"))))}}]),t}(r.a.Component)).defaultProps={quoteSymbol:null,baseSymbol:null};var nt=function(e){function t(){return et(this,t),tt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return at(t,e),$e(t,[{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.order,o=e.showSymbols,s="1.3.0"==t.get("id")?n.getPrice()/(1+n.offset_percent/1e4):n.getPrice()*(1+n.offset_percent/1e4),i=o?" "+a.get("symbol"):null;return r.a.createElement("tr",null,r.a.createElement("td",{className:"text-center",style:{width:"6%"}}," "),r.a.createElement("td",null,F.a.format_number(s,a.get("precision"))," ",i),r.a.createElement("td",null,F.a.format_number(n[n.isBid()?"amountToReceive":"amountForSale"]().getAmount({real:!0}),a.get("precision"))),r.a.createElement("td",null,F.a.format_number(n[n.isBid()?"amountForSale":"amountToReceive"]().getAmount({real:!0}),t.get("precision"))),r.a.createElement("td",null,r.a.createElement(f.Tooltip,{title:new Date(n.settlement_date).toString()},r.a.createElement("div",{style:{textAlign:"right",whiteSpace:"nowrap"}},v.a.localize(new Date(n.settlement_date),{type:"date",format:-1!==Ze()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history"})))))}}]),t}(r.a.Component);nt.defaultProps={showSymbols:!1,invert:!1};var rt=function(e){function t(){return et(this,t),tt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return at(t,e),$e(t,[{key:"shouldComponentUpdate",value:function(e){return e.currentAccount!==this.props.currentAccount||e.orders!==this.props.orders}},{key:"render",value:function(){var e=this.props,t=e.orders,a=e.base,n=e.quote,o=null,s=r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},r.a.createElement(I.a,{content:"account.no_orders"}))));return t.size>0&&a&&n&&(o=t.sort((function(e,t){return e.isBefore(t)?-1:1})).map((function(e){return r.a.createElement(nt,{key:e.id,order:e,base:a,quote:n})})).toArray()),r.a.createElement(Xe.a,{ref:"contentTransition",component:"tbody",transitionName:"newrow"},o||s)}}]),t}(r.a.Component);rt.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},rt.propTypes={base:x.a.object.isRequired,quote:x.a.object.isRequired,orders:x.a.object.isRequired,quoteSymbol:x.a.string.isRequired,baseSymbol:x.a.string.isRequired};var ot=rt,st=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ct={textAlign:"right"};function ut(e){var t=e.baseSymbol,a=e.quoteSymbol,n=e.selected,o=e.onCancelToggle;return r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"6%",textAlign:"center"}},o?r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.cancel_order_select_all"),placement:"left"},r.a.createElement(f.Checkbox,{className:"order-cancel-toggle",checked:n,onChange:o})):null),r.a.createElement("th",{style:ct},r.a.createElement(I.a,{className:"header-sub-title",content:"exchange.price"})),r.a.createElement("th",{style:ct},t?r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:a})):null),r.a.createElement("th",{style:ct},t?r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:t})):null),r.a.createElement("th",{style:ct},r.a.createElement(I.a,{className:"header-sub-title",content:"transaction.expiration"}))))}function pt(e){var t=e.order,a=e.selected,n=e.base,o=e.quote,s=e.onCheckCancel,i=t.isBid(),l=t.isCall(),c=l?"orderHistoryCall":i?"orderHistoryBid":"orderHistoryAsk";return r.a.createElement("tr",{key:t.id},r.a.createElement("td",{className:"text-center",style:{width:"6%"}},l?null:r.a.createElement(f.Checkbox,{className:"orderCancel",checked:a,onChange:s})),r.a.createElement("td",{className:c,style:{paddingLeft:10}},r.a.createElement(U,{price:t.getPrice(),base:n,quote:o})),r.a.createElement("td",null,F.a.format_number(t[i?"amountToReceive":"amountForSale"]().getAmount({real:!0}),o.get("precision"))," "),r.a.createElement("td",null,F.a.format_number(t[i?"amountForSale":"amountToReceive"]().getAmount({real:!0}),n.get("precision"))," "),r.a.createElement("td",null,r.a.createElement(f.Tooltip,{title:t.expiration.toLocaleString()},r.a.createElement("div",{style:{textAlign:"right",whiteSpace:"nowrap"}},l?null:v.a.localize(new Date(t.expiration),{type:"date",format:"short_custom"})))))}ut.defaultProps={quoteSymbol:null,baseSymbol:null};var dt=function(e){function t(){return it(this,t),lt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),st(t,[{key:"render",value:function(){var e=this.props,t=e.style,a=e.className,n=e.innerClass,o=e.innerStyle,s=e.headerStyle,i=e.noHeader,l=e.isSelected,c=e.tinyScreen,u=e.activeTab,p=e.baseSymbol,d=e.quoteSymbol,h=e.contentContainer,m=e.footerContainer,f=e.onCancelToggle;return r.a.createElement("div",{style:t,key:"open_orders",className:a},r.a.createElement("div",{className:n,style:o},i?null:r.a.createElement("div",{style:s,className:"exchange-content-header"},"my_orders"==u?r.a.createElement(I.a,{content:"exchange.my_orders"}):null,"open_settlement"==u?r.a.createElement(I.a,{content:"exchange.settle_orders"}):null),r.a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},r.a.createElement("table",{className:"table order-table text-right fixed-table market-right-padding"},r.a.createElement(ut,{baseSymbol:p,quoteSymbol:d,selected:l,onCancelToggle:"my_orders"==u?f:null}))),r.a.createElement("div",{className:"table-container grid-block market-right-padding-only no-overflow",ref:"container",style:{overflow:"hidden",minHeight:c?260:0,maxHeight:260,lineHeight:"13px"}},r.a.createElement("table",{className:"table order-table table-highlight-hover table-hover no-stripes text-right fixed-table market-right-padding"},h)),m))}}]),t}(r.a.Component),ht=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function mt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function gt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var yt=function(e){function t(){return ft(this,t),bt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return gt(t,e),ht(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.for_sale!==this.props.order.for_sale||e.order.id!==this.props.order.id||e.quote!==this.props.quote||e.base!==this.props.base||e.order.market_base!==this.props.order.market_base||e.selected!==this.props.selected}},{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.order,o=e.selected;return r.a.createElement(pt,{key:n.id,order:n,selected:o,base:t,quote:a,onCheckCancel:this.props.onCheckCancel.bind(this)})}}]),t}(r.a.Component),vt=function(e){function t(e){ft(this,t);var a=bt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={activeTab:e.activeTab,rowCount:20,showAll:!1,selectedOrders:[]},a._getOrders=a._getOrders.bind(a),a}return gt(t,e),ht(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.baseSymbol!==this.props.baseSymbol||e.quoteSymbol!==this.props.quoteSymbol||e.className!==this.props.className||e.activeTab!==this.props.activeTab||t.activeTab!==this.state.activeTab||t.showAll!==this.state.showAll||e.currentAccount!==this.props.currentAccount||t.selectedOrders!==this.state.selectedOrders||e.settleOrders!==this.props.settleOrders}},{key:"componentDidMount",value:function(){this.props.hideScrollbars||this.updateContainer(1)}},{key:"componentDidUpdate",value:function(e){var t=this.props.hideScrollbars,a=this.state.showAll;e.showAll!=a&&(a&&!t?this.updateContainer(2):a||t?a&&t?this.updateContainer(1):this.updateContainer(0):this.updateContainer(3))}},{key:"componentWillReceiveProps",value:function(e){e.activeTab!==this.state.activeTab&&this.changeTab(e.activeTab),e.baseSymbol===this.props.baseSymbol&&e.quoteSymbol===this.props.quoteSymbol||(this.setState({showAll:!1}),this.updateContainer(0),this.props.hideScrollbars||this.updateContainer(1)),e.hideScrollbars!==this.props.hideScrollbars&&(this.updateContainer(0),e.hideScrollbars||this.updateContainer(1))}},{key:"updateContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=this.refs.view.refs.container,a=this.refs.contentTransition;t&&(0==e?(t.scrollTop=0,S.a.destroy(t)):1==e?(S.a.initialize(t),this.updateContainer(3)):2==e?S.a.update(t):3==e&&(t.scrollTop=0,S.a.update(t)),a&&a.resetAnimation())}},{key:"_onSetShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"changeTab",value:function(e){O.a.changeViewSetting({ordersTab:e}),this.setState({activeTab:e}),this.updateContainer(3),setTimeout(Y.a.rebuild,1e3)}},{key:"onCheckCancel",value:function(e,t){var a=this.state.selectedOrders;if(t.target.checked)this.setState({selectedOrders:a.concat([e])});else{var n=a.indexOf(e);n>-1&&this.setState({selectedOrders:a.slice(0,n).concat(a.slice(n+1))})}}},{key:"cancelSelected",value:function(){this._cancelLimitOrders.call(this)}},{key:"resetSelected",value:function(){this.setState({selectedOrders:[]})}},{key:"onCancelToggle",value:function(e){var t=this._getOrders(),a=[];t.forEach((function(e){a.push(e.id)})),e.target.checked?this.setState({selectedOrders:a}):this.resetSelected()}},{key:"_cancelLimitOrders",value:function(){var e=this;P.a.cancelLimitOrders(this.props.currentAccount.get("id"),this.state.selectedOrders).then((function(){e.resetSelected()})).catch((function(e){console.log("cancel orders error:",e)}))}},{key:"_getOrders",value:function(){var e,t=this.props,a=t.currentAccount,n=t.base,r=t.quote,o=t.feedPrice,s=a.get("orders"),i=a.get("call_orders"),l=n.get("id"),c=r.get("id"),u=(mt(e={},n.get("id"),{precision:n.get("precision")}),mt(e,r.get("id"),{precision:r.get("precision")}),e),p=s.toArray().map((function(e){var t=m.ChainStore.getObject(e);if(!t)return null;var a=t.getIn(["sell_price","base","asset_id"]),n=t.getIn(["sell_price","quote","asset_id"]);return a===l&&n===c||a===c&&n===l?new B.g(t.toJS(),u,r.get("id")):void 0})).filter((function(e){return!!e})),d=i.toArray().map((function(e){try{var t=m.ChainStore.getObject(e);if(!t)return null;var a=t.getIn(["call_price","base","asset_id"]),n=t.getIn(["call_price","quote","asset_id"]);if(a===l&&n===c||a===c&&n===l)return o?new B.b(t.toJS(),u,r.get("id"),o):null}catch(e){return null}})).filter((function(e){return!!e})).filter((function(e){try{return e.isMarginCalled()}catch(e){return!1}}));return p.concat(d)}},{key:"render",value:function(){var e=this,t=this.props,a=t.base,n=t.quote,o=t.quoteSymbol,s=t.baseSymbol,i=t.settleOrders,l=this.state,c=l.activeTab,u=l.showAll,p=l.rowCount,d=l.selectedOrders;if(!a||!n)return null;var h=void 0,m=void 0,b=0;if(!c||"my_orders"==c){var g=this._getOrders(),y=g.filter((function(e){return e.isBid()})).sort((function(e,t){return t.getPrice()-e.getPrice()})).map((function(t){var o=t.getPrice();return r.a.createElement(yt,{price:o,key:t.id,order:t,base:a,quote:n,selected:e.state.selectedOrders.length>0&&e.state.selectedOrders.includes(t.id),onCancel:e.props.onCancel.bind(e,t.id),onCheckCancel:e.onCheckCancel.bind(e,t.id)})})),v=g.filter((function(e){return!e.isBid()})).sort((function(e,t){return e.getPrice()-t.getPrice()})).map((function(t){var o=t.getPrice();return r.a.createElement(yt,{price:o,key:t.id,order:t,base:a,quote:n,selected:e.state.selectedOrders.length>0&&e.state.selectedOrders.includes(t.id),onCancel:e.props.onCancel.bind(e,t.id),onCheckCancel:e.onCheckCancel.bind(e,t.id)})})),_=[];v.length&&(_=_.concat(v)),y.length&&(_=_.concat(y)),_.sort((function(e,t){return e.props.price-t.props.price})),(b=_.length)>0&&!u&&_.splice(p,_.length);var k=r.a.createElement("tr",null,r.a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},r.a.createElement(I.a,{content:"account.no_orders"}))),E=r.a.createElement("div",{style:{display:"grid"}},r.a.createElement(f.Button,{onClick:this.cancelSelected.bind(this)},r.a.createElement(I.a,{content:"exchange.cancel_selected_orders"})));h=r.a.createElement(Xe.a,{ref:"contentTransition",component:"tbody",transitionName:"newrow"},_.length?_:k),m=b>11?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onSetShowAll.bind(this)},r.a.createElement(I.a,{content:u?"exchange.hide":"exchange.show_all_orders",rowcount:b}))),d.length>0?E:null):d.length>0?E:null}c&&"open_settlement"==c&&((b=i.length)>0&&!u&&i.splice(p,i.length),h=r.a.createElement(ot,{key:"settle_orders",orders:i,base:a,quote:n,baseSymbol:s,quoteSymbol:o}),m=b>11&&r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onSetShowAll.bind(this)},r.a.createElement(I.a,{content:u?"exchange.hide":"exchange.show_all_orders",rowcount:b}))));var w=this.state.selectedOrders.length>0&&this.state.selectedOrders.length==b;return r.a.createElement(dt,{ref:"view",style:this.props.style,className:this.props.className,innerClass:this.props.innerClass,innerStyle:this.props.innerStyle,headerStyle:this.props.headerStyle,noHeader:this.props.noHeader,isSelected:w,tinyScreen:this.props.tinyScreen,activeTab:c,baseSymbol:s,quoteSymbol:o,contentContainer:h,footerContainer:m,onCancelToggle:this.onCancelToggle.bind(this)})}}]),t}(r.a.Component);vt.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},vt.propTypes={base:x.a.object.isRequired,quote:x.a.object.isRequired,orders:x.a.object.isRequired,quoteSymbol:x.a.string.isRequired,baseSymbol:x.a.string.isRequired};var _t=a(2175),kt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ct(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var St=function(e){function t(){return Et(this,t),wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ct(t,e),kt(t,[{key:"render",value:function(){var e=this.props,t=e.orderRows,a=e.noOrders,n=e.isBid,o=e.id;return r.a.createElement(Xe.a,{id:o,ref:n?"bidTransition":"askTransaction",className:"transition-container clickable",component:"div",transitionName:"newrow"},t.length>0?t:a||r.a.createElement("div",{className:"sticky-table-row"},r.a.createElement("td",{className:"cell no-orders",colSpan:"3"},n?r.a.createElement(I.a,{content:"exchange.no_bids"}):r.a.createElement(I.a,{content:"exchange.no_asks"}))))}}]),t}(r.a.Component);St.propTypes={orderRows:x.a.array.isRequired,noOrders:x.a.bool.isRequired,isBid:x.a.bool.isRequired};var At=function(e){function t(){return Et(this,t),wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ct(t,e),kt(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.market_base===this.props.order.market_base&&(e.order.ne(this.props.order)||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.isPanelActive!==this.props.isPanelActive||e.horizontal!==this.props.horizontal)}},{key:"render",value:function(){var e=this.props,t=e.order,a=e.quote,n=e.base,o=e.final,s=t.isBid(),i=t.isCall()?"orderHistoryCall":s?"orderHistoryBid":"orderHistoryAsk",l=r.a.createElement(U,{price:t.getPrice(),quote:a,base:n});return r.a.createElement("div",{onClick:this.props.onClick,className:g()("sticky-table-row order-row",{"final-row":o},{"my-order":t.isMine(this.props.currentAccount)})},r.a.createElement("div",{className:"cell left"},F.a.format_number(t[s?"amountForSale":"amountToReceive"]().getAmount({real:!0}),n.get("precision"))),r.a.createElement("div",{className:"cell"},F.a.format_number(t[s?"amountToReceive":"amountForSale"]().getAmount({real:!0}),a.get("precision"))),r.a.createElement("div",{className:"cell "+i+" right"},l))}}]),t}(r.a.Component),xt=function(e){return e?e.getBoundingClientRect().height:0},Ot=function(e){function t(){return Et(this,t),wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ct(t,e),kt(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.ne(this.props.order)||e.position!==this.props.position||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.quoteTotal!==this.props.quoteTotal}},{key:"render",value:function(){var e=this.props,t=e.order,a=e.quote,n=e.base,o=e.position,s=e.quoteTotal,i=t.isBid(),l=t.isCall()?"orderHistoryCall":i?"orderHistoryBid":"orderHistoryAsk",c=r.a.createElement(U,{price:t.getPrice(),quote:a,base:n}),u=i?F.a.format_number(t.amountToReceive().getAmount({real:!0}),a.get("precision")):F.a.format_number(t.amountForSale().getAmount({real:!0}),a.get("precision")),p=i?F.a.format_number(t.amountForSale().getAmount({real:!0}),n.get("precision")):F.a.format_number(t.amountToReceive().getAmount({real:!0}),n.get("precision")),d=s?t.totalToReceive():t.totalForSale(),h=s?t.totalForSale():t.totalToReceive(),m=s?a:n,f=i?F.a.format_number(d.getAmount({real:!0}),m.get("precision")):F.a.format_number(h.getAmount({real:!0}),m.get("precision"));return r.a.createElement("tr",{onClick:this.props.onClick,className:t.isMine(this.props.currentAccount)?"my-order":""},"left"===o?r.a.createElement("td",{className:"column-hide-xs"},f):r.a.createElement("td",{style:{width:"25%"},className:l},c),r.a.createElement("td",null,"left"===o?p:u),r.a.createElement("td",null,"left"===o?u:p),"right"===o?r.a.createElement("td",{className:"column-hide-xs"},f):r.a.createElement("td",{style:{width:"25%"},className:l},c))}}]),t}(r.a.Component),Pt=function(e){function t(){return Et(this,t),wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ct(t,e),kt(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.market_base===this.props.order.market_base&&(e.order.ne(this.props.order)||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount)}},{key:"render",value:function(){var e=this.props,t=e.order,a=e.quote,n=e.base,o=e.final,s=t.isBid(),i=s?"orderHistoryBid":"orderHistoryAsk",l=r.a.createElement(U,{price:t.getPrice(),quote:a,base:n});return r.a.createElement("div",{onClick:this.props.onClick,className:g()("sticky-table-row order-row",{"final-row":o})},r.a.createElement("div",{className:"cell left"},F.a.format_number(t[s?"amountForSale":"amountToReceive"]().getAmount({real:!0}),n.get("precision"))),r.a.createElement("div",{className:"cell"},F.a.format_number(t[s?"amountToReceive":"amountForSale"]().getAmount({real:!0}),a.get("precision"))),r.a.createElement("div",{className:"cell "+i+" right"},l))}}]),t}(r.a.Component),Tt=function(e){function t(){return Et(this,t),wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ct(t,e),kt(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.ne(this.props.order)||e.position!==this.props.position||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount||e.quoteTotal!==this.props.quoteTotal}},{key:"render",value:function(){var e=this.props,t=e.order,a=e.quote,n=e.base,o=e.position,s=e.quoteTotal,i=t.isBid(),l=i?"orderHistoryBid":"orderHistoryAsk",c=r.a.createElement(U,{price:t.getPrice(),quote:a,base:n}),u=i?F.a.format_number(t.amountToReceive().getAmount({real:!0}),a.get("precision")):F.a.format_number(t.amountForSale().getAmount({real:!0}),a.get("precision")),p=i?F.a.format_number(t.amountForSale().getAmount({real:!0}),n.get("precision")):F.a.format_number(t.amountToReceive().getAmount({real:!0}),n.get("precision")),d=s?t.totalToReceive():t.totalForSale(),h=s?t.totalForSale():t.totalToReceive(),m=s?a:n,f=i?F.a.format_number(d.getAmount({real:!0}),m.get("precision")):F.a.format_number(h.getAmount({real:!0}),m.get("precision"));return r.a.createElement("tr",{onClick:this.props.onClick},"left"===o?r.a.createElement("td",{className:"column-hide-xs"},f):r.a.createElement("td",{style:{width:"25%"},className:l},c),r.a.createElement("td",null,"left"===o?p:u),r.a.createElement("td",null,"left"===o?u:p),"right"===o?r.a.createElement("td",{className:"column-hide-xs"},f):r.a.createElement("td",{style:{width:"25%"},className:l},c))}}]),t}(r.a.Component),Nt=function(e){function t(){Et(this,t);var e=wt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={groupLimit:""},e}return Ct(t,e),kt(t,[{key:"render",value:function(){var e=this,t=0===this.props.trackedGroupsConfig.length,a=this.props.trackedGroupsConfig.map((function(t){return e.props.globalSettingsSelector?r.a.createElement(f.Select.Option,{value:t,key:t},t/100+"%"):r.a.createElement("option",{value:t,key:t},t/100+"%")}));return this.props.globalSettingsSelector?r.a.createElement(f.Select,{placeholder:"Select option",style:{width:"100%"},value:this.props.currentGroupOrderLimit,disabled:t,onChange:this.props.handleGroupOrderLimitChange.bind(this)},t?r.a.createElement(f.Select.Option,{value:0},r.a.createElement(I.a,{content:"tooltip.no_groups_available"})):r.a.createElement(f.Select.Option,{value:0},r.a.createElement(I.a,{content:"settings.disabled"})),a):r.a.createElement(f.Tooltip,{placement:"bottom",title:t?v.a.translate("tooltip.no_groups_available"):null},r.a.createElement("select",{value:this.state.groupLimit,onChange:this.props.handleGroupOrderLimitChange,className:"settings-select",style:t?{cursor:"not-allowed"}:null},r.a.createElement(I.a,{content:"exchange.group_order_limit",component:"option",value:"0"}),a))}}],[{key:"getDerivedStateFromProps",value:function(e){return{groupLimit:e.currentGroupOrderLimit}}}]),t}(r.a.Component),Bt=function(e){function t(e){Et(this,t);var a=wt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.queryStickyTable=function(e){return a.verticalStickyTable.current.table.querySelector(e)},a.verticalScrollBar=function(){return a.queryStickyTable("#y-scrollbar")},a.toggleSpreadValue=function(){a.setState({displaySpreadAsPercentage:!a.state.displaySpreadAsPercentage})},a.toggleAutoScroll=function(){a.setState({autoScroll:!a.state.autoScroll})},a.state={flip:e.flipOrderBook,showAllBids:!1,showAllAsks:!1,rowCount:20,autoScroll:e.autoScroll,quoteTotalBids:!1,quoteTotalAsks:!1},a.verticalStickyTable=r.a.createRef(),a.centerText=r.a.createRef(),a}return Ct(t,e),kt(t,[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.horizontal&&this.props.hideScrollbars&&t.showAllAsks!=this.state.showAllAsks){var a=this.refs.hor_asks;t.showAllAsks?(S.a.initialize(a),this.psUpdate()):S.a.destroy(a),this.refs.askTransition.resetAnimation(),this.refs.hor_asks&&(this.refs.hor_asks.scrollTop=0)}if(this.props.horizontal&&this.props.hideScrollbars&&t.showAllBids!=this.state.showAllBids){var n=this.refs.hor_bids;t.showAllBids?(S.a.initialize(n),this.psUpdate()):S.a.destroy(n),this.refs.bidTransition.resetAnimation(),this.refs.hor_bids&&(this.refs.hor_bids.scrollTop=0)}return!0}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props;n.base.get("id")===e.base.get("id")&&n.quote.get("id")===e.quote.get("id")||(this.refs.askTransition&&(this.refs.askTransition.resetAnimation(),this.refs.hor_asks&&(this.refs.hor_asks.scrollTop=0),this.refs.hor_bids&&(this.refs.hor_bids.scrollTop=0)),this.refs.bidTransition&&this.refs.bidTransition.resetAnimation(),this.refs.vert_bids&&(this.refs.vert_bids.scrollTop=0),this.props.horizontal||this.setState({autoScroll:this.state.autoScroll}));var r=this.refs.hor_bids,o=this.refs.hor_asks;this.props.horizontal&&n.hideScrollbars!==this.props.hideScrollbars&&n.hideScrollbars&&(S.a.destroy(r),S.a.destroy(o)),this.props.horizontal&&n.hideScrollbars!==this.props.hideScrollbars&&!n.hideScrollbars&&(S.a.initialize(r),S.a.initialize(o),this.refs.askTransition.resetAnimation(),this.refs.bidTransition.resetAnimation(),o&&(o.scrollTop=0),r&&(r.scrollTop=0),this.psUpdate()),this.centerVerticalScrollBar()}},{key:"componentDidMount",value:function(){if(this.props.horizontal){if(!this.props.hideScrollbars){var e=this.refs.hor_bids;S.a.initialize(e);var t=this.refs.hor_asks;S.a.initialize(t)}}else S.a.initialize(this.verticalScrollBar())}},{key:"centerVerticalScrollBar",value:function(){if(!this.props.horizontal&&this.state.autoScroll){var e=this.queryStickyTable("#sticky-table-y-wrapper"),t=this.queryStickyTable("#sticky-table-header"),a=this.centerText.current,n=xt(this.queryStickyTable(".order-row")),r=(0!==this.props.currentGroupOrderLimit?this.props.orderBookReversed?this.props.groupedBids:this.props.groupedAsks:this.props.orderBookReversed?this.props.combinedBids:this.props.combinedAsks).length*n,o=xt(e)-xt(t),s=r+xt(a)/2-o/2;e.scrollTop=s}}},{key:"psUpdate",value:function(){if(this.props.horizontal){var e=this.refs.hor_bids;S.a.update(e);var t=this.refs.hor_asks;S.a.update(t)}else S.a.update(this.verticalScrollBar())}},{key:"_onSetShowAll",value:function(e){"asks"===e?(this.setState({showAllAsks:!this.state.showAllAsks}),this.state.showAllAsks&&(this.refs.hor_asks.scrollTop=0)):(this.setState({showAllBids:!this.state.showAllBids}),this.state.showAllBids&&(this.refs.hor_bids.scrollTop=0))}},{key:"toggleTotalAsset",value:function(e){var t,a,n,r=e?"quoteTotalBids":"quoteTotalAsks";this.setState((t={},a=r,n=!this.state[r],a in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t))}},{key:"render",value:function(){var e=this,t=this.props,a=t.combinedBids,n=t.combinedAsks,o=t.highestBid,s=t.lowestAsk,i=t.quote,l=t.base,c=t.totalAsks,u=t.totalBids,p=t.quoteSymbol,d=t.baseSymbol,h=t.horizontal,m=t.trackedGroupsConfig,f=t.currentGroupOrderLimit,b=t.handleGroupOrderLimitChange,y=t.orderBookReversed,_=t.groupedBids,k=t.groupedAsks,E=t.flipOrderBook,w=this.state,C=w.showAllAsks,S=w.showAllBids,A=w.rowCount,x=w.displaySpreadAsPercentage,O=!s.sell_price&&!o.sell_price,P=!(!s.sell_price||!o.sell_price)&&(x?(100*(s._real_price/o._real_price-1)).toFixed(2)+"%":r.a.createElement(U,{price:s._real_price-o._real_price,base:l,quote:i})),T=null,N=null,B=0!==this.props.currentGroupOrderLimit?k:n,M=0!==this.props.currentGroupOrderLimit?_:a;if(h||y?!h&&y&&(M.sort((function(e,t){return e.getPrice()-t.getPrice()})),B.sort((function(e,t){return e.getPrice()-t.getPrice()}))):(M.sort((function(e,t){return t.getPrice()-e.getPrice()})),B.sort((function(e,t){return t.getPrice()-e.getPrice()}))),l&&i&&(0!==this.props.currentGroupOrderLimit?(T=M.map((function(t,a){return h?r.a.createElement(Tt,{index:a,key:t.getPrice()+(t.isBid()?"_bid":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,position:E?"right":"left",currentAccount:e.props.currentAccount,quoteTotal:e.state.quoteTotalBids}):r.a.createElement(Pt,{index:a,key:t.getPrice()+(t.isBid()?"_bid":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,final:0===a,currentAccount:e.props.currentAccount})})),N=B.map((function(t,a){return h?r.a.createElement(Tt,{index:a,key:t.getPrice()+(t.isBid()?"_bid":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,type:t.type,position:E?"left":"right",currentAccount:e.props.currentAccount,quoteTotal:e.state.quoteTotalAsks}):r.a.createElement(Pt,{index:a,key:t.getPrice()+(t.isBid()?"_bid":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,type:t.type,final:0===a,currentAccount:e.props.currentAccount})}))):(T=M.map((function(t,a){return h?r.a.createElement(Ot,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,position:E?"right":"left",currentAccount:e.props.currentAccount,quoteTotal:e.state.quoteTotalBids}):r.a.createElement(At,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,final:0===a,currentAccount:e.props.currentAccount})})),N=B.map((function(t,a){return h?r.a.createElement(Ot,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,type:t.type,position:E?"left":"right",currentAccount:e.props.currentAccount,quoteTotal:e.state.quoteTotalAsks}):r.a.createElement(At,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:l,quote:i,type:t.type,final:0===a,currentAccount:e.props.currentAccount})})))),this.props.horizontal){var j=T.length,q=N.length;S||T.splice(A,T.length),C||N.splice(A,N.length);var R=r.a.createElement("thead",null,r.a.createElement("tr",{key:"top-header",className:"top-header"},r.a.createElement("th",{className:"column-hide-xs"},r.a.createElement(I.a,{className:"header-sub-title",content:"exchange.total"}),r.a.createElement("a",{onClick:function(){return e.toggleTotalAsset(!0)},className:"header-sub-title underline-title"}," ",r.a.createElement(H.a,{dataPlace:"top",name:this.state.quoteTotalBids?p:d,noTip:!0}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:d}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:p}))),r.a.createElement("th",null,r.a.createElement(I.a,{className:(E?"ask-total":"bid-total")+" header-sub-title",content:"exchange.price"})))),L=r.a.createElement("thead",null,r.a.createElement("tr",{key:"top-header",className:"top-header"},r.a.createElement("th",null,r.a.createElement(I.a,{className:(E?"bid-total":"ask-total")+" header-sub-title",content:"exchange.price"})),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:p}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:d}))),r.a.createElement("th",{className:"column-hide-xs"},r.a.createElement(I.a,{className:"header-sub-title",content:"exchange.total"}),r.a.createElement("a",{onClick:function(){return e.toggleTotalAsset()},className:"header-sub-title underline-title"}," ",r.a.createElement(H.a,{dataPlace:"top",name:this.state.quoteTotalAsks?p:d,noTip:!0}))))),D=this.props.wrapperClass,V=this.props.innerClass;return r.a.createElement("div",{ref:"order_book",style:{marginRight:this.props.smallScreen?10:0},className:g()(D)},r.a.createElement("div",{className:g()(V,E?"order-1":"order-2")},r.a.createElement("div",null,r.a.createElement("div",{className:"exchange-content-header ask"},r.a.createElement(I.a,{content:"exchange.asks"}),E&&!this.props.hideFunctionButtons?r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("span",{onClick:this.props.onFlipOrderBook.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆")):null,E&&!this.props.hideFunctionButtons?r.a.createElement("div",{className:"float-right header-sub-title grouped_order"},m?r.a.createElement(Nt,{trackedGroupsConfig:m,handleGroupOrderLimitChange:b,currentGroupOrderLimit:f}):null):null,this.props.onTogglePosition&&!this.props.hideFunctionButtons?r.a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,E&&!this.props.hideFunctionButtons?r.a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},r.a.createElement(Q.a,{name:"thumb-tack",className:"icon-14px icon-fill"})):null,r.a.createElement("div",{style:{lineHeight:"16px"},className:"header-sub-title float-right"},r.a.createElement(I.a,{content:"exchange.market_depth"}),r.a.createElement("span",null,": "),F.a.format_number(c,i.get("precision")),r.a.createElement("span",null," ","(",r.a.createElement(H.a,{name:p}),")"))),r.a.createElement("div",{className:"market-right-padding-only"},r.a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},E?R:L)),r.a.createElement("div",{className:"grid-block",ref:"hor_asks",style:{paddingRight:"0.6rem",overflow:"hidden",maxHeight:260,lineHeight:"13px"}},r.a.createElement("table",{style:{paddingBottom:5},className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},r.a.createElement(Xe.a,{ref:"askTransition",className:"orderbook clickable",component:"tbody",transitionName:"newrow",id:"top-order-rows"},N))),q>11?r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onSetShowAll.bind(this,"asks")},r.a.createElement(I.a,{content:C?"exchange.hide":"exchange.show_asks",ordercount:q}))):null)),r.a.createElement("div",{className:g()(V,E?"order-2":"order-1")},r.a.createElement("div",null,r.a.createElement("div",{className:"exchange-content-header bid"},r.a.createElement(I.a,{content:"exchange.bids"}),E||this.props.hideFunctionButtons?null:r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("span",{onClick:this.props.onFlipOrderBook.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆")),E||this.props.hideFunctionButtons?null:r.a.createElement("div",{className:"float-right header-sub-title grouped_order"},m?r.a.createElement(Nt,{trackedGroupsConfig:m,handleGroupOrderLimitChange:b,currentGroupOrderLimit:f}):null),0!==f&&this.props.hideFunctionButtons&&r.a.createElement(Q.a,{name:"grouping",className:"float-right icon-14px",title:v.a.translate("icons.order_grouping"),style:{marginLeft:"0.5rem"}}),this.props.onTogglePosition&&!this.props.hideFunctionButtons?r.a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):null,E||this.props.hideFunctionButtons?null:r.a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},r.a.createElement(Q.a,{name:"thumb-tack",className:"icon-14px"})),r.a.createElement("div",{style:{lineHeight:"16px"},className:"float-right header-sub-title"},r.a.createElement(I.a,{content:"exchange.market_depth"}),r.a.createElement("span",null,": "),F.a.format_number(u,l.get("precision")),r.a.createElement("span",null," ","(",r.a.createElement(H.a,{name:d}),")"))),r.a.createElement("div",{className:"market-right-padding-only"},r.a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},E?L:R)),r.a.createElement("div",{className:"grid-block",ref:"hor_bids",style:{paddingRight:"0.6rem",overflow:"hidden",maxHeight:260,lineHeight:"13px"}},r.a.createElement("table",{style:{paddingBottom:5},className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},r.a.createElement(Xe.a,{ref:"bidTransition",className:"orderbook clickable",component:"tbody",transitionName:"newrow"},T))),j>A?r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onSetShowAll.bind(this,"bids")},r.a.createElement(I.a,{content:S?"exchange.hide":"exchange.show_bids",ordercount:j}))):null)))}return r.a.createElement("div",{className:"order-table-container"},r.a.createElement(_t.StickyTable,{stickyColumnCount:0,className:"order-table table",ref:this.verticalStickyTable},r.a.createElement("div",{className:"sticky-table-row top-header"},r.a.createElement("div",{className:"cell header-cell left"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{name:d}))),r.a.createElement("div",{className:"cell header-cell"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{name:p}))),r.a.createElement("div",{className:"cell header-cell right"},r.a.createElement(I.a,{className:"header-sub-title",content:"exchange.price"}))),y?r.a.createElement(St,{id:"top-order-rows",noOrders:O,orderRows:T,isBid:!0}):r.a.createElement(St,{id:"top-order-rows",noOrders:O,orderRows:N,isBid:!1}),O?r.a.createElement("div",{className:"sticky-table-row",ref:this.centerText},r.a.createElement("div",{className:"cell"}),r.a.createElement("div",{className:"cell no-orders padtop"},r.a.createElement(I.a,{content:"exchange.no_orders"}))):r.a.createElement("div",{className:"sticky-table-row orderbook-latest-price",ref:this.centerText,style:{padding:0}},r.a.createElement("div",{className:"cell right"},r.a.createElement("span",{className:"clickable left",onClick:this.toggleSpreadValue},r.a.createElement(I.a,{className:"orderbook-center-title",content:"exchange.spread"})," ",r.a.createElement("span",{className:"spread-value"},P||"0"))),r.a.createElement("div",{className:"cell cell-center"},r.a.createElement("span",{style:{width:75}},this.props.hideFunctionButtons?null:r.a.createElement(Q.a,{className:"lock-unlock clickable icon-fill",onClick:this.toggleAutoScroll,name:this.state.autoScroll?"locked":"unlocked",title:this.state.autoScroll?"icons.unlocked.disable_auto_scroll":"icons.locked.enable_auto_scroll"})," ",this.props.hideFunctionButtons?null:r.a.createElement(Q.a,{onClick:this.props.moveOrderBook,name:"thumb-tack",className:"icon-14px icon-fill order-book-button-v clickable",title:this.props.horizontal?"icons.thumb_tack":"icons.thumb_untack",style:{marginLeft:0}})," ",0==f?null:r.a.createElement(Q.a,{name:"grouping",className:"icon-14px",title:v.a.translate("icons.order_grouping"),style:{marginLeft:0}}))),r.a.createElement("div",{className:"cell",style:{textAlign:"center"}},!!this.props.latest&&r.a.createElement("span",{className:"right"},r.a.createElement("span",{className:this.props.changeClass?this.props.changeClass:"spread-value"},r.a.createElement(U,{price:this.props.latest,base:this.props.base,quote:this.props.quote}))))),y?r.a.createElement(St,{noOrders:O,orderRows:N,isBid:!1}):r.a.createElement(St,{noOrders:O,orderRows:T,isBid:!0})))}}]),t}(r.a.Component);Bt.defaultProps={bids:[],asks:[],orders:{}},Bt.propTypes={bids:x.a.array.isRequired,asks:x.a.array.isRequired,orders:x.a.object.isRequired};var Mt=a(9),Ft=a.n(Mt),jt=a(30),It=a(154),qt=a(267),Rt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Vt=function(e){function t(){return Lt(this,t),Dt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Rt(t,[{key:"componentWillMount",value:function(){this.props.blockHeader||qt.a.getHeader.defer(this.props.block_number)}},{key:"shouldComponentUpdate",value:function(e){return e.blockHeader&&!this.props.blockHeader&&setTimeout(Y.a.rebuild,1e3),e.blockHeader!==this.props.blockHeader}},{key:"render",value:function(){var e=this.props,t=e.blockHeader,a=e.tooltip,n=e.component,o=e.format;return t?r.a.createElement(n,{className:a?"tooltip":""},r.a.createElement(f.Tooltip,{title:a?t.timestamp.toString():"",placement:"left"},r.a.createElement("span",null,v.a.localize(t.timestamp,{type:"date",format:o})))):r.a.createElement(n)}}]),t}(r.a.Component);Vt.defaultProps={format:-1!==Ze()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history",tooltip:!1,component:"span"};var zt=Vt=Object(jt.a)(Vt,{listenTo:function(){return[It.a]},getProps:function(e){return{blockHeader:It.a.getState().blockHeaders.get(e.block_number)}}}),Ut=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Gt(e){var t=e.fill,a=e.base,n=e.quote,o=-1!==t.id.indexOf("5.0")?r.a.createElement("td",null,r.a.createElement(f.Tooltip,{title:t.time.toString(),placement:"left"},r.a.createElement("div",{className:"tooltip",style:{whiteSpace:"nowrap"}},v.a.localize(t.time,{type:"date",format:-1!==Ze()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history"})))):r.a.createElement(zt,{component:"td",block_number:t.block,tooltip:!0});return r.a.createElement("tr",null,r.a.createElement("td",{className:t.className},r.a.createElement(U,{price:t.getPrice(),base:a,quote:n})),r.a.createElement("td",null,t.amountToReceive()),r.a.createElement("td",null,t.amountToPay()),o)}var Qt=function(e){function t(){return Ht(this,t),Wt(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ut(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.innerClass,o=t.innerStyle,s=t.noHeader,i=t.headerStyle,l=t.activeTab,c=t.quoteSymbol,u=t.baseSymbol,p=t.tinyScreen,d=t.totalRows,h=t.historyRows,m=t.showAll,f=r.a.createElement("tr",null,r.a.createElement("td",{style:{textAlign:"center",lineHeight:4,fontStyle:"italic"},colSpan:"5"},r.a.createElement(I.a,{content:"account.no_orders"})));return r.a.createElement("div",{className:g()(a)},r.a.createElement("div",{className:n,style:o},s?null:r.a.createElement("div",{style:i,className:"exchange-content-header"},"my_history"===l?r.a.createElement(I.a,{content:"exchange.my_history"}):null,"history"===l?r.a.createElement(I.a,{content:"exchange.history"}):null),r.a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},r.a.createElement("table",{className:"table table-no-padding order-table text-left fixed-table market-right-padding"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(I.a,{className:"header-sub-title",content:"exchange.price"})),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:c}))),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(H.a,{dataPlace:"top",name:u}))),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(I.a,{className:"header-sub-title",content:"explorer.block.date"})))))),r.a.createElement("div",{className:"table-container grid-block market-right-padding-only no-overflow",ref:"history",style:{minHeight:p?0:260,maxHeight:260,overflow:"hidden",lineHeight:"13px"}},r.a.createElement("table",{className:"table order-table no-stripes table-hover fixed-table text-right no-overflow"},r.a.createElement(Xe.a,{ref:"historyTransition",component:"tbody",transitionName:"newrow",className:"orderbook"},h&&h.length>0?h:f))),h&&d>11?r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:function(t){return e.props.onSetShowAll(t)}},r.a.createElement(I.a,{content:m?"exchange.hide":"exchange.show_all_trades",rowcount:d}))):null))}}]),t}(r.a.Component),Kt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Jt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Yt=m.ChainTypes.operations,Zt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={activeTab:e.viewSettings.get("historyTab","history"),rowCount:20,showAll:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Kt(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Ft.a.is(e.history,this.props.history)||e.baseSymbol!==this.props.baseSymbol||e.quoteSymbol!==this.props.quoteSymbol||e.className!==this.props.className||e.activeTab!==this.props.activeTab||t.activeTab!==this.state.activeTab||t.showAll!==this.state.showAll||e.currentAccount!==this.props.currentAccount||e.isPanelActive!==this.props.isPanelActive||e.hideScrollbars!==this.props.hideScrollbars}},{key:"componentDidMount",value:function(){this.props.hideScrollbars||this.updateContainer(1)}},{key:"componentDidUpdate",value:function(e){var t=this.props.hideScrollbars,a=this.state.showAll;e.showAll!=a&&(a&&!t?this.updateContainer(2):a||t?a&&t?this.updateContainer(1):this.updateContainer(0):this.updateContainer(3))}},{key:"componentWillReceiveProps",value:function(e){e.activeTab!==this.props.activeTab&&this.changeTab(e.activeTab),e.baseSymbol===this.props.baseSymbol&&e.quoteSymbol===this.props.quoteSymbol||(this.setState({showAll:!1}),this.updateContainer(0),this.props.hideScrollbars||this.updateContainer(1)),e.hideScrollbars!==this.props.hideScrollbars&&(this.updateContainer(0),e.hideScrollbars||this.updateContainer(1))}},{key:"updateContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=this.refs.view.refs.history,a=this.refs.view.refs.historyTransition;t&&(0==e?(t.scrollTop=0,S.a.destroy(t)):1==e?(S.a.initialize(t),this.updateContainer(3)):2==e?S.a.update(t):3==e&&(t.scrollTop=0,S.a.update(t)),a&&a.resetAnimation())}},{key:"onSetShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"changeTab",value:function(e){O.a.changeViewSetting({historyTab:e}),this.setState({activeTab:e}),this.updateContainer(3),setTimeout(Y.a.rebuild,1e3)}},{key:"render",value:function(){var e=this.props,t=e.history,a=e.myHistory,n=e.base,o=e.quote,s=e.baseSymbol,i=e.quoteSymbol,l=e.isNullAccount,c=e.activeTab,u=this.state,p=u.rowCount,d=u.showAll,h=null;if(l&&(c="history"),"my_history"===c&&a&&a.size){var m,f=(Jt(m={},o.get("id"),{precision:o.get("precision")}),Jt(m,n.get("id"),{precision:n.get("precision")}),m);h=a.filter((function(e){return e.getIn(["op",0])===Yt.fill_order})).filter((function(e){var t=o.get("id"),a=n.get("id"),r=e.getIn(["op",1,"pays","asset_id"]),s=e.getIn(["op",1,"receives","asset_id"]);return(t===r||t===s)&&(a===r||a===s)})).sort((function(e,t){return t.get("block_num")-e.get("block_num")})).map((function(e){var t=new B.e(e.toJS(),f,o.get("id"));return r.a.createElement(Gt,{key:t.id,fill:t,base:n,quote:o})})).toArray()}else t&&t.size&&(h=this.props.history.take(100).map((function(e){return r.a.createElement(Gt,{key:e.id,fill:e,base:n,quote:o})})).toArray());var b=h?h.length:null;return!d&&h&&h.splice(p,h.length),r.a.createElement(Qt,{ref:"view",className:this.props.className,innerClass:this.props.innerClass,innerStyle:this.props.innerStyle,noHeader:this.props.noHeader,headerStyle:this.props.headerStyle,activeTab:c,quoteSymbol:i,baseSymbol:s,tinyScreen:this.props.tinyScreen,historyRows:h,totalRows:b,showAll:d,onSetShowAll:this.onSetShowAll.bind(this)})}}]),t}(r.a.Component);Zt.defaultProps={history:[]},Zt.propTypes={history:x.a.object.isRequired};var Xt=Object(jt.a)(Zt,{listenTo:function(){return[i.a]},getProps:function(){return{viewSettings:i.a.getState().viewSettings}}}),$t=a(2088),ea=a(472),ta=a(594),aa=a(2075),na=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ra=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},oa=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function sa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ia(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function la(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ca=function(e){function t(){return sa(this,t),ia(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return la(t,e),oa(t,[{key:"onKeyPress",value:function(e,t){"Enter"==t.key&&this.props.history.push(e)}},{key:"render",value:function(){var e=this.props,t=e.quoteSymbol,a=e.baseSymbol,n=e.market,o=e.marketPickerAsset,s=this.props.onClose,i=n[1].quote,l=t==o?"/market/"+i+"_"+a:"/market/"+t+"_"+i;return r.a.createElement("li",{key:n[0],style:{height:40},onKeyPress:this.onKeyPress.bind(this,l),tabIndex:this.props.tabIndex},r.a.createElement(qe.a,{style:{display:"flex"},onClick:s,to:l},r.a.createElement("div",{style:{flex:2}},r.a.createElement(H.a,{name:n[1].quote})),r.a.createElement("div",{style:{flex:3}},n[1].issuer)))}}]),t}(n.Component);ca.propTypes={onClose:x.a.func,quoteSymbol:x.a.string,baseSymbol:x.a.string,market:x.a.array,marketPickerAsset:x.a.string};var ua=function(e){function t(){sa(this,t);var e=ia(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=e.initialState(),e.getAssetList=Object(d.a)(ea.a.getAssetList.defer,150),e.setState=e.setState.bind(e),e._checkAndUpdateMarketList=e._checkAndUpdateMarketList.bind(e),e}return la(t,e),oa(t,[{key:"initialState",value:function(){return{marketsList:[],lookupQuote:null,inputValue:""}}},{key:"componentDidMount",value:function(){this.refs.marketPicker_input.focus()}},{key:"componentDidUpdate",value:function(){this.refs.marketPicker_input.focus()}},{key:"componentWillReceiveProps",value:function(e){e.marketPickerAsset!==this.props.marketPickerAsset&&this.setState(this.initialState()),e.searchAssets!==this.props.searchAssets&&Object(aa.a)({searchAssets:this.props.searchAssets,marketPickerAsset:this.props.marketPickerAsset,baseAsset:this.props.baseAsset,quoteAsset:this.props.quoteAsset},{inputValue:this.state.inputValue,lookupQuote:this.state.lookupQuote},this.setState,this._checkAndUpdateMarketList)}},{key:"shouldComponentUpdate",value:function(e,t){return e.visible!==this.props.visible||e.marketPickerAsset!==this.props.marketPickerAsset||e.searchAssets!==this.props.searchAssets||t.marketsList!==this.state.marketsList||!F.a.are_equal_shallow(t,this.state)}},{key:"componentWillUnmount",value:function(){this.intervalId&&clearInterval(this.intervalId)}},{key:"_onInputName",value:function(e,t){var a=this,n=t.target.value.trim().toUpperCase();m.ChainValidation.is_valid_symbol_error(n,!0)?this.setState({inputValue:n,activeSearch:!1,marketsList:[]}):(this.setState({inputValue:n,activeSearch:!0,marketsList:[]}),this.state.inputValue!==n&&this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){Object(aa.c)(n,e,a.getAssetList,a.setState)}),1500))}},{key:"_checkAndUpdateMarketList",value:function(e){var t=this;clearInterval(this.intervalId),this.intervalId=setInterval((function(){var a=0,n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value,c=ra(l,2)[1];c.issuer||(c.issuer=Object(aa.b)(c.issuerId),c.issuer||a++)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}a||(clearInterval(t.intervalId),t.setState({marketsList:e,activeSearch:!1}))}),300)}},{key:"renderSearchBar",value:function(){var e=this.state.inputValue,t=v.a.translate("exchange.market_picker.find_by_asset").toUpperCase();return r.a.createElement("div",{id:"filter"},r.a.createElement(f.Form.Item,{label:t},r.a.createElement(f.Input,{type:"text",ref:"marketPicker_input",value:e,onChange:this._onInputName.bind(this,!0),placeholder:v.a.translate("exchange.market_picker.search"),maxLength:"16",tabIndex:2})))}},{key:"renderResults",value:function(){var e=this,t=this.state.marketsList,a=this.state,n=a.activeSearch,o=a.inputValue,s=n&&0!=o.length,i=this.props.marketPickerAsset,l=this.props.baseAsset.get("symbol"),c=this.props.quoteAsset.get("symbol");return s?r.a.createElement(f.Icon,{style:{marginLeft:"8px"},type:"loading",theme:"outlined"}):r.a.createElement("div",{className:"results"},r.a.createElement("ul",{style:{marginLeft:0,minHeight:"20px"}},t.map((function(t,a){return r.a.createElement(ca,{key:a,tabIndex:a+100,baseSymbol:l,quoteSymbol:c,market:t,marketPickerAsset:i,history:e.props.history,onClose:e.props.onClose.bind(e)})}))))}},{key:"render",value:function(){var e=this.props.marketPickerAsset;return r.a.createElement("div",{className:"marketPicker"},r.a.createElement("div",{className:"marketPicker__subHeader"},r.a.createElement(I.a,{content:"exchange.market_picker.sub_title"})," ",r.a.createElement(qe.a,{to:"/asset/"+e,style:{cursor:"pointer",color:"lightblue !important"}},r.a.createElement(H.a,{name:e}))),this.renderSearchBar(),this.renderResults())}}]),t}(n.Component),pa=function(e){function t(){sa(this,t);var e=ia(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={open:!1,smallScreen:!1},e}return la(t,e),oa(t,[{key:"componentWillMount",value:function(){this.setState({smallScreen:window.innerWidth<=800})}},{key:"componentWillReceiveProps",value:function(e){this.props.quoteAsset.get("id")===e.quoteAsset.get("id")&&this.props.baseAsset.get("id")===e.baseAsset.get("id")||this.onClose()}},{key:"show",value:function(){this.props.showModal()}},{key:"onClose",value:function(){this.props.onToggleMarketPicker(null),this.props.hideModal()}},{key:"render",value:function(){return r.a.createElement(f.Modal,na({title:v.a.translate("exchange.market_picker.title"),closable:!1,visible:this.props.visible,id:this.props.modalId,overlay:!0,onCancel:this.onClose.bind(this),noHeaderContainer:!0,footer:null,ref:this.props.modalId},this.props),r.a.createElement(ua,na({onClose:this.onClose.bind(this)},this.props)))}}]),t}(n.Component),da=pa=Object(jt.a)(pa,{listenTo:function(){return[ta.a]},getProps:function(){return{searchAssets:ta.a.getState().assets,assetsLoading:ta.a.getState().assetsLoading}}}),ha=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ma=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.submit=a.submit.bind(a),a.cancel=a.cancel.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ha(t,[{key:"_onForce",value:function(e,t){t.preventDefault(),this.props.hideModal(),e&&this.props.onForce()}},{key:"submit",value:function(e){this._onForce(!0,e)}},{key:"cancel",value:function(e){this._onForce(!1,e)}},{key:"render",value:function(){var e=this.props,t=e.type,a=e.diff,n=e.hasOrders,o=[r.a.createElement(f.Button,{key:"submit",onClick:this.submit},v.a.translate("settings.yes")),r.a.createElement(f.Button,{key:"cancel",type:"primary",onClick:this.cancel},v.a.translate("settings.no"))];return r.a.createElement(f.Modal,{footer:o,visible:this.props.visible,onCancel:this.cancel,title:v.a.translate("transaction.confirm")},r.a.createElement("div",{className:"grid-block vertical"},n?r.a.createElement(I.a,{content:"exchange.confirm_"+t,diff:F.a.format_number(a,2)}):r.a.createElement(I.a,{content:"exchange.confirm_no_orders_"+t})))}}]),t}(r.a.Component),fa=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ba=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={open:!1,smallScreen:!1,autoScroll:e.viewSettings.get("global_AutoScroll",!0)},a.setChartHeight=a.setChartHeight.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),fa(t,[{key:"componentWillMount",value:function(){this.setState({smallScreen:window.innerWidth<=800})}},{key:"onClose",value:function(){this.props.hideModal()}},{key:"setChartHeight",value:function(e){this.props.onChangeChartHeight({value:e})}},{key:"setAutoscroll",value:function(e){var t=1==e;this.setState({autoScroll:t}),O.a.changeViewSetting({global_AutoScroll:t}),this.props.onSetAutoscroll(t)}},{key:"_getGroupingOptions",value:function(e){return r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},onChange:this.props.onSetPanelTabs.bind(this,e),value:this.props.panelTabs[e]},r.a.createElement(f.Select.Option,{value:0},r.a.createElement(I.a,{content:"exchange.settings.options.grouping_standalone"})),r.a.createElement(f.Select.Option,{value:1},r.a.createElement(I.a,{content:"exchange.settings.options.grouping_1"})),r.a.createElement(f.Select.Option,{value:2},r.a.createElement(I.a,{content:"exchange.settings.options.grouping_2"})))}},{key:"render",value:function(){var e=this.props,t=e.chartType,a=e.chartHeight;return r.a.createElement(f.Modal,{title:v.a.translate("exchange.settings.header.title"),visible:this.props.visible,id:this.props.modalId,overlay:!0,footer:[r.a.createElement(f.Button,{key:"close",onClick:this.onClose.bind(this)},v.a.translate("modal.close"))],onCancel:this.onClose.bind(this),noHeaderContainer:!0,ref:this.props.modalId},r.a.createElement(f.Form.Item,null,r.a.createElement("header",null,r.a.createElement(I.a,{content:"exchange.settings.header.chart_options"})),this.props.tinyScreen?null:r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.chart_type"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_type")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"}))," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_reload")},r.a.createElement(f.Icon,{type:"info-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:t,onChange:this.props.onToggleChart.bind(this)},r.a.createElement(f.Select.Option,{value:"market_depth"},v.a.translate("exchange.order_depth")),r.a.createElement(f.Select.Option,{value:"price_chart"},v.a.translate("exchange.price_history")),r.a.createElement(f.Select.Option,{value:"hidden_chart"},v.a.translate("exchange.settings.options.hidden_chart"))))),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.chart_height"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_height")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.InputNumber,{value:"number"==typeof a&&a,onChange:this.setChartHeight.bind(this)}))),!this.props.tinyScreen&&"price_chart"==t&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.chart_tools"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_tools")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"}))," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_reload")},r.a.createElement(f.Icon,{type:"info-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.chartTools,onChange:this.props.onChartTools.bind(this)}))),!this.props.tinyScreen&&"price_chart"==t&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.chart_zoom"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_zoom")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"}))," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_reload")},r.a.createElement(f.Icon,{type:"info-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.chartZoom,onChange:this.props.onChartZoom.bind(this)}))),r.a.createElement("header",null,r.a.createElement(I.a,{content:"exchange.settings.header.order_options"})),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.order_book_grouping"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.order_book_grouping")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},this.props.trackedGroupsConfig?r.a.createElement(Nt,{globalSettingsSelector:!0,trackedGroupsConfig:this.props.trackedGroupsConfig,handleGroupOrderLimitChange:this.props.handleGroupOrderLimitChange.bind(this),currentGroupOrderLimit:this.props.currentGroupOrderLimit}):null)),!this.props.tinyScreen&&!this.props.smallScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.order_style"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.order_style")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.verticalOrderBook.toString(),onSelect:this.props.onMoveOrderBook.bind(this)},r.a.createElement(f.Select.Option,{value:"true"},r.a.createElement(I.a,{content:"exchange.settings.options.vertical"})),r.a.createElement(f.Select.Option,{value:"false"},r.a.createElement(I.a,{content:"exchange.settings.options.horizontal"}))))),!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.position_order_form"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.position_order_form")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.flipBuySell.toString(),onSelect:this.props.onFlipBuySell.bind(this)},r.a.createElement(f.Select.Option,{value:"false"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_form_opt1"})),r.a.createElement(f.Select.Option,{value:"true"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_form_opt2"}))))):null,!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.position_order_orders"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.position_order_orders")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.flipOrderBook.toString(),onSelect:this.props.onFlipOrderBook.bind(this)},r.a.createElement(f.Select.Option,{value:"false"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_orders_opt1"})),r.a.createElement(f.Select.Option,{value:"true"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_orders_opt2"}))))):null,!this.props.tinyScreen&&!this.props.verticalOrderBook||this.props.smallScreen?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.position_order_asset"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.position_order_asset")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.buySellTop.toString(),onSelect:this.props.onToggleBuySellPosition.bind(this)},r.a.createElement(f.Select.Option,{value:"false"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_asset_opt1"})),r.a.createElement(f.Select.Option,{value:"true"},r.a.createElement(I.a,{content:"exchange.settings.options.position_order_asset_opt2"}))))):null,!this.props.tinyScreen&&this.props.verticalOrderBook?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingTop:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.orderbook_auto_scroll"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.orderbook_auto_scroll")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.state.autoScroll,onChange:this.setAutoscroll.bind(this)}))):null,!this.props.tinyScreen&&this.props.verticalOrderBook?r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.reverse_order_book"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.reverse_order_book")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.orderBookReversed,onChange:this.props.onOrderBookReversed.bind(this)}))):null,!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6",style:{paddingRight:5}},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.single_colum_order_form"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.single_colum_order_form")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.singleColumnOrderForm,onChange:this.props.onToggleSingleColumnOrderForm.bind(this)}))),!this.props.tinyScreen&&r.a.createElement("header",null,r.a.createElement(I.a,{content:"exchange.settings.header.panel_grouping"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.panel_grouping")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"}))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.my_trades"}))),r.a.createElement("div",{className:"small-6"},this._getGroupingOptions("my_history"))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.market_trades"}))),r.a.createElement("div",{className:"small-6"},this._getGroupingOptions("history"))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.open_orders"}))),r.a.createElement("div",{className:"small-6"},this._getGroupingOptions("my_orders"))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},r.a.createElement("div",{className:"small-6"},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.settlements"}))),r.a.createElement("div",{className:"small-6"},this._getGroupingOptions("open_settlement"))),!this.props.tinyScreen&&r.a.createElement("header",null,r.a.createElement(I.a,{content:"exchange.settings.header.general"})),!this.props.tinyScreen&&!this.props.smallScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink",style:{paddingBottom:"0.5em"}},r.a.createElement("div",{className:"small-6",style:{paddingRight:5}},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.market_location"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.market_location")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Select,{placeholder:v.a.translate("settings.placeholder_select"),style:{width:"100%"},value:this.props.mirrorPanels.toString(),onSelect:this.props.onMirrorPanels.bind(this)},r.a.createElement(f.Select.Option,{value:"false"},r.a.createElement(I.a,{content:"settings.left"})),r.a.createElement(f.Select.Option,{value:"true"},r.a.createElement(I.a,{content:"settings.right"}))))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6",style:{paddingRight:5}},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.reduce_scrollbars"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.reduce_scrollbars")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"}))," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.reload")},r.a.createElement(f.Icon,{type:"info-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.hideScrollbars,onChange:this.props.onToggleScrollbars.bind(this)}))),!this.props.tinyScreen&&r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"small-6",style:{paddingRight:5}},r.a.createElement("h6",{style:{margin:9}},r.a.createElement(I.a,{content:"exchange.settings.title.hide_function_buttons"})," ",r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.hide_function_buttons")},r.a.createElement(f.Icon,{type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"small-6"},r.a.createElement(f.Switch,{style:{margin:6},checked:this.props.hideFunctionButtons,onChange:this.props.onHideFunctionButtons.bind(this)})))))}}]),t}(r.a.Component),ga=a(2095),ya=a.n(ga),va=a(2182),_a=a.n(va),ka=a(107),Ea=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},wa=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Ca(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Sa=function e(t){Ca(this,e),this.name=t.ticker,this.ticker=t.ticker;var a=Object(ka.c)(t.quoteAsset),n=Object(ka.c)(t.baseAsset),r=a===n||a&&!n?a:!a&&n?n:a+" / "+n,o=F.a.replaceName(t.baseAsset),s=o.name,i=o.prefix,l=F.a.replaceName(t.quoteAsset),c=l.name,u=l.prefix;this.description=""+(u||"")+c+" / "+(i||"")+s+" "+(r?"("+r+")":""),this.type="bitcoin",this.session="24x7",this.timezone=_a.a.tz.guess(),this.data_status="streaming",this.supported_resolutions=t.resolutions,this.has_empty_bars=!0,this.pricescale=Math.pow(10,t.baseAsset.get("precision")),this.quoteAsset=t.quoteAsset,this.baseAsset=t.baseAsset,this.minmov=1,this.has_intraday=this.supported_resolutions.reduce((function(e,t){return e||!isNaN(parseInt(t,10))}),!1),this.intraday_multipliers=this.supported_resolutions.filter((function(e){return!isNaN(parseInt(e,10))})),this.has_seconds=this.supported_resolutions.reduce((function(e,t){return e||-1!==t.indexOf("S")}),!1),this.seconds_multipliers=this.supported_resolutions.filter((function(e){return-1!==e.indexOf("S")})),this.has_daily=this.supported_resolutions.reduce((function(e,t){return e||-1!==t.indexOf("D")}),!1),this.has_daily=this.supported_resolutions.reduce((function(e,t){return e||-1!==t.indexOf("D")}),!1)};function Aa(e){return e.map((function(e){var t=e/60,a=t/60/24,n=a/7;if(t<1)return e+"S";if(a<1&&parseInt(t,10)===t)return t.toString();if(n<1){if(a>=1&&parseInt(a,10)===a)return 1===a?"D":a+"D"}else if(n>=1&&parseInt(n,10)===n)return n+"D";return null})).filter((function(e){return!!e}))}var xa=function(){function e(){Ca(this,e)}return wa(e,[{key:"update",value:function(e){for(var t in e)switch(t){case"resolutions":this.supported_resolutions=Aa(e.resolutions);break;case"onMarketChange":o.a.unsubscribe("market_change"),o.a.subscribe("market_change",e[t]);break;default:this[t]=e[t]}}},{key:"clearSubs",value:function(){o.a.clearSubs()}},{key:"onReady",value:function(e){var t=this;setTimeout((function(){e({exchanges:[{value:"OPEN.",name:"Openledger",desc:"Openledger Gateway"}],symbols_types:[],supported_resolutions:t.supported_resolutions,supports_marks:!1,supports_search:!1,supports_time:!0})}),10)}},{key:"searchSymbols",value:function(e,t,a,n){console.log("searchSymbols",e,t,a),n([])}},{key:"resolveSymbol",value:function(e,t,a){var n=this,r=e.split("_"),o=Ea(r,2),s=o[0],i=o[1];Promise.all([Object(m.FetchChain)("getAsset",s),Object(m.FetchChain)("getAsset",i)]).then((function(a){var r=Ea(a,2),o=r[0],s=r[1];t(new Sa({ticker:e,quoteAsset:o,baseAsset:s,resolutions:n.supported_resolutions}))})).catch(a)}},{key:"getBars",value:function(e,t,a,n,r,o,s){var i=this;a*=1e3,n*=1e3;var l,c=this._getHistory();if(this.latestBar=c[c.length-1],c=c.filter((function(e){return e.time>=a&&e.time<=n})),this.interval!==t){if(!s)return;var u="D"===(l=t)?86400:-1!==l.indexOf("W")?7*parseInt(l.replace("D",""),10)*24*60*60:-1!==l.indexOf("D")?24*parseInt(l.replace("D",""),10)*60*60:-1!==l.indexOf("S")?parseInt(l.replace("S",""),10):60*parseInt(l,10);return P.a.changeBucketSize(u),P.a.unSubscribeMarket(e.quoteAsset.get("id"),e.baseAsset.get("id")).then((function(){P.a.subscribeMarket(e.baseAsset,e.quoteAsset,u).then((function(){var e=i._getHistory();if(i.latestBar=e[e.length-1],e=e.filter((function(e){return e.time>=a&&e.time<=n})),i.interval=t,!e.length)return r(e,{noData:!0});r(e)}))}))}if(this.interval=t,!c.length)return r(c,{noData:!0});r(c)}},{key:"_getHistory",value:function(){return o.a.getState().priceData}},{key:"subscribeBars",value:function(e,t,a,n,r){var s=this;o.a.unsubscribe("subscribeBars"),r(),o.a.subscribe("subscribeBars",(function(){var e=s._getHistory(),t=e.filter((function(e){return!s.latestBar||e.time>s.latestBar.time}));if(t.length)t.forEach((function(e){a(e)})),s.latestBar=t[t.length-1];else{var n=!1;for(var r in s.latestBar)s.latestBar[r]!==e[e.length-1][r]&&(n=!0);n&&a(e[e.length-1])}}))}},{key:"unsubscribeBars",value:function(){}},{key:"calculateHistoryDepth",value:function(e,t,a){}},{key:"getServerTime",value:function(e){e((new Date).getTime()/1e3)}}]),e}(),Oa=["America/Argentina/Buenos_Aires","America/Bogota","America/Caracas","America/Chicago","America/El_Salvador","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Almaty","Asia/Ashkhabad","Asia/Bangkok","Asia/Dubai","Asia/Hong_Kong","Asia/Kathmandu","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tehran","Asia/Tokyo","Australia/ACT","Australia/Adelaide","Australia/Brisbane","Australia/Sydney","Europe/Athens","Europe/Berlin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Warsaw","Europe/Zurich","Pacific/Auckland","Pacific/Chatham","Pacific/Fakaofo","Pacific/Honolulu","US/Mountain"];function Pa(){var e=_a.a.tz.guess();if(-1!==Oa.indexOf(e))return e;for(var t=_a()().toISOString(),a=_a.a.tz(t,e).format(),n=0;n<Oa.length;n++){if(_a.a.tz(t,Oa[n]).format()===a)return Oa[n]}return console.log("No matching timezone found for "+e+", setting to default value of Europe/London"),"Europe/London"}var Ta=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Na=a(2181),Ba=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={showSaveModal:!1,showLoadModal:!1,error:!1},a.layoutName=r.a.createRef(),a.hideModal=a.hideModal.bind(a),a.resetError=a.resetError.bind(a),a.loadLastChart=a.loadLastChart.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ta(t,[{key:"loadTradingView",value:function(e){var t=this,a=e.dataFeed,n=ya.a[e.theme],r=this;if(a&&!this.tvWidget){0,a.update({resolutions:e.buckets,ticker:e.quoteSymbol+"_"+e.baseSymbol,interval:Aa([e.bucketSize])[0]});var o=["symbol_info","symbol_search_hot_key","border_around_the_chart","header_symbol_search","header_compare","header_saveload"],s=[];!this.props.mobile&&this.props.chartZoom||(o.push("chart_scroll"),o.push("chart_zoom")),this.props.mobile||!this.props.chartTools?(o.push("left_toolbar"),o.push("chart_crosshair_menu"),o.push("chart_events"),o.push("footer_share_buttons"),o.push("footer_screenshot"),o.push("footer_publish_idea_button"),o.push("caption_buttons_text_if_possible"),o.push("line_tool_templates"),o.push("widgetbar_tabs"),o.push("support_manage_drawings"),o.push("support_multicharts"),o.push("right_bar_stays_on_scroll"),o.push("charts_auto_save"),o.push("edit_buttons_in_legend"),o.push("context_menus"),o.push("control_bar"),o.push("header_fullscreen_button"),o.push("header_widget"),o.push("symbollist_context_menu"),o.push("show_pro_features")):(s.push("study_templates"),s.push("keep_left_toolbar_visible_on_small_screens")),this.tvWidget=new Na.widget({fullscreen:!1,symbol:e.quoteSymbol+"_"+e.baseSymbol,interval:Aa([e.bucketSize])[0],library_path:"/charting_library/",datafeed:a,container_id:"tv_chart",charts_storage_url:"https://saveload.tradingview.com",charts_storage_api_version:"1.1",client_id:"tradingview.com",user_id:"public_user_id",autosize:!0,locale:e.locale,timezone:Pa(),toolbar_bg:n.bgColor,overrides:{"paneProperties.background":n.bgColor,"paneProperties.horzGridProperties.color":n.axisLineColor,"paneProperties.vertGridProperties.color":n.axisLineColor,"scalesProperties.lineColor":n.axisLineColor,"scalesProperties.textColor":n.textColor},custom_css_url:e.theme+".css",enabled_features:s,disabled_features:o,debug:!1,preset:this.props.mobile?"mobile":""}),this.tvWidget.onChartReady((function(){t.tvWidget.createButton().attr("title",v.a.translate("exchange.load_custom_charts")).addClass("apply-common-tooltip").on("click",(function(){r.setState({showLoadModal:!0})})).append("<span>"+v.a.translate("exchange.chart_load")+"</span>"),t.tvWidget.createButton().attr("title",v.a.translate("exchange.save_custom_charts")).addClass("apply-common-tooltip").on("click",(function(){r.setState({showSaveModal:!0})})).append("<span>"+v.a.translate("exchange.chart_save")+"</span>"),a.update({onMarketChange:t._setSymbol.bind(t)}),t.loadLastChart()})),this._onWheel=this._onWheel.bind(this)}}},{key:"componentWillReceiveProps",value:function(e){e.marketReady&&!this.props.dataFeed&&e.dataFeed&&this.loadTradingView(e)}},{key:"_setSymbol",value:function(e){this.tvWidget&&(this.tvWidget.chart().removeAllShapes(),this.loadLastChart(),this.tvWidget.setSymbol(e,Aa([this.props.bucketSize])[0]))}},{key:"componentDidMount",value:function(){this.loadTradingView(this.props)}},{key:"componentWillUnmount",value:function(){this.props.dataFeed.clearSubs()}},{key:"shouldComponentUpdate",value:function(e,t){return t.showLoadModal!==this.state.showLoadModal||t.showSaveModal!==this.state.showSaveModal||e.chartHeight!==this.props.chartHeight||this.props.charts.size!==e.charts.size||!this.tvWidget||e.marketReady}},{key:"_onWheel",value:function(e){console.log("Test wheel interception")}},{key:"onSubmitConfirmation",value:function(e){var t=this,a=this.layoutName,n=this.props.charts.some((function(e){return e.key===a.current.state.value&&e.symbol===t.props.quoteSymbol+"_"+t.props.baseSymbol})),r=this;n?this.setState({error:n}):(this.resetError(),this.tvWidget.save((function(e){var t={};t.key=a.current.state.value||"",t.object=e,t.name=a.current.state.value||"",t.symbol=r.props.quoteSymbol+"_"+r.props.baseSymbol,t.modified=(new Date).toLocaleDateString("en-US"),O.a.addChartLayout(t),r.setState({showSaveModal:!1},(function(){r.layoutName.current.state&&(r.layoutName.current.state.value=null)}))})))}},{key:"hideModal",value:function(){this.resetError(),this.setState({showSaveModal:!1,showLoadModal:!1})}},{key:"handleDelete",value:function(e){O.a.deleteChartLayout(e)}},{key:"resetError",value:function(){this.setState({error:!1})}},{key:"loadLastChart",value:function(){var e=this.props,t=e.charts,a=e.quoteSymbol,n=e.baseSymbol,r=t.toArray().filter((function(e){return e.symbol===a+"_"+n&&e.enabled}));r[0]&&this.tvWidget.load(r[0].object)}},{key:"render",value:function(){var e=this,t=this.props,a=t.charts,n=t.quoteSymbol,o=t.baseSymbol,s=this.state.error,i=s?"has-error":"",l=a.toArray().filter((function(e){return e.symbol===n+"_"+o})),c=[{title:v.a.translate("exchange.layout_name"),dataIndex:"name",key:"name"},{title:v.a.translate("exchange.modified"),dataIndex:"modified",key:"modified"},{title:v.a.translate("exchange.actions"),dataIndex:"actions",key:"actions",render:function(t,a){return r.a.createElement(f.Icon,{style:{width:"32px"},onClick:e.handleDelete.bind(e,a.name),type:"delete"})}}];return r.a.createElement("div",{className:"small-12"},r.a.createElement("div",{className:"exchange-bordered",style:{height:this.props.chartHeight+"px"},id:"tv_chart"}),r.a.createElement(f.Modal,{title:v.a.translate("exchange.load_chart_layout"),closable:!1,visible:this.state.showLoadModal,footer:[r.a.createElement(f.Button,{key:"cancel",onClick:this.hideModal},v.a.translate("modal.close"))]},r.a.createElement(f.Table,{dataSource:l||[],columns:c,onRow:function(t){return{onClick:function(a){"td"===a.target.localName?(e.hideModal(),O.a.addChartLayout(t),e.tvWidget.load(t.object)):1===a.currentTarget.parentElement.childElementCount&&e.hideModal()}}}})),r.a.createElement(f.Modal,{title:v.a.translate("exchange.save_new_chart_layout"),closable:!1,visible:this.state.showSaveModal,footer:[r.a.createElement(f.Button,{key:"submit",type:"primary",onClick:this.onSubmitConfirmation.bind(this)},v.a.translate("modal.save")),r.a.createElement(f.Button,{key:"cancel",onClick:this.hideModal},v.a.translate("modal.close"))]},r.a.createElement("div",null,s?r.a.createElement("span",{className:i},r.a.createElement(I.a,{content:"exchange.chart_error"})):null,r.a.createElement("span",{className:i,style:{borderBottom:"#A09F9F 1px dotted"}},r.a.createElement(f.Input,{placeholder:v.a.translate("exchange.enter_chart_layout_name"),ref:this.layoutName,onChange:this.resetError,onPressEnter:this.onSubmitConfirmation.bind(this)})))))}}]),t}(r.a.Component),Ma=Object(jt.a)(Ba,{listenTo:function(){return[i.a]},getProps:function(){return{charts:i.a.getState().chartLayouts}}}),Fa=a(612),ja=a(2065),Ia=a.n(ja),qa=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Ra(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function La(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Da=function(e){function t(){return Ra(this,t),La(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),qa(t,[{key:"shouldComponentUpdate",value:function(e){var t=!isNaN(e.feedPrice)&&e.feedPrice!==this.props.feedPrice;return Object(B.k)(e.orders,this.props.orders)||Object(B.k)(e.call_orders,this.props.call_orders)||t||e.feedPrice!==this.props.feedPrice||e.height!==this.props.height||e.isPanelActive!==this.props.isPanelActive||e.activePanels!==this.props.activePanels||e.LCP!==this.props.LCP||e.showCallLimit!==this.props.showCallLimit||e.hasPrediction!==this.props.hasPrediction||e.feedPrice!==this.props.feedPrice||e.marketReady!==this.props.marketReady}},{key:"componentDidMount",value:function(){this.reflowChart(500)}},{key:"componentWillReceiveProps",value:function(e){this.refs.depthChart&&e.activePanels!==this.props.activePanels&&this.reflowChart(100)}},{key:"componentWillUpdate",value:function(){this.props.centerRef&&(this.tempScroll=this.props.centerRef.scrollTop)}},{key:"componentDidUpdate",value:function(){this.props.centerRef&&(this.props.centerRef.scrollTop=this.tempScroll)}},{key:"reflowChart",value:function(e){var t=this;setTimeout((function(){t.refs.depthChart&&t.refs.depthChart.chart.reflow()}),e)}},{key:"_getThemeColors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return ya.a[e.theme]}},{key:"render",value:function(){var e=this.props,t=e.flat_bids,a=e.flat_asks,n=e.flat_calls,o=e.flat_settles,s=e.totalBids,i=e.totalAsks,l=e.base,c=e.quote,u=e.feedPrice,p=this._getThemeColors(),d=p.primaryText,h=p.callColor,m=p.settleColor,f=p.settleFillColor,b=p.bidColor,g=p.bidFillColor,y=p.askColor,_=p.askFillColor,k=p.axisLineColor,E=F.a.replaceName(l),w=E.name,C=E.prefix,S=F.a.replaceName(c),A=S.name,x=S.prefix;w=(C||"")+w,A=(x||"")+A;var O=Object(Fa.a)(t),P=Object(Fa.a)(a),T=Object(Fa.a)(n),N=Object(Fa.a)(o),B={chart:{type:"area",backgroundColor:"rgba(255, 0, 0, 0)",spacing:[10,0,5,0]},title:{text:null},credits:{enabled:!1},legend:{enabled:!1},rangeSelector:{enabled:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},dataGrouping:{enabled:!1},tooltip:{shared:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",useHTML:!0,formatter:function(){return"\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>"+v.a.translate("exchange.price")+':</td>\n\t\t\t\t\t\t\t<td style="text-align: right">'+F.a.format_number(this.x,l.get("precision"))+" "+w+"/"+A+"</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>"+v.a.translate("exchange.quantity")+':</td>\n\t\t\t\t\t\t\t<td style="text-align: right">'+F.a.format_number(this.y,c.get("precision"))+" "+A+"</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t"},style:{color:"#FFFFFF"}},series:[],yAxis:{labels:{enabled:!0,style:{color:d},formatter:function(){return F.a.format_number(this.value,c.get("precision"))}},opposite:!1,title:{text:null,style:{color:"#FFFFFF"}},gridLineWidth:1,gridLineColor:"rgba(196, 196, 196, 0.30)",gridZIndex:1,crosshair:{snap:!1},currentPriceIndicator:{enabled:!1}},xAxis:{labels:{style:{color:d}},ordinal:!1,lineColor:"#000000",title:{text:null},plotLines:[]},plotOptions:{area:{animation:!1,marker:{enabled:!1},series:{enableMouseTracking:!1}}}};if(O.length>0&&P.length>0){var M=(P[0][0]+O[O.length-1][0])/2;B.xAxis.min=.4*M,B.xAxis.max=1.6*M,B.xAxis.max<P[0][0]&&(B.xAxis.max=1.5*P[0][0]),B.xAxis.min>O[O.length-1][0]&&(B.xAxis.min=.5*O[O.length-1][0]);var j=0;O.forEach((function(e){e[0]>=B.xAxis.min&&(j=Math.max(e[1],j))})),P.forEach((function(e){e[0]<=B.xAxis.max&&(j=Math.max(e[1],j))})),B.yAxis.max=1.15*j;var q=j>10?0:j>1?2:5;B.yAxis.labels.formatter=function(){return F.a.format_number(this.value,q)}}else O.length&&!P.length?(B.xAxis.min=.4*O[O.length-1][0],B.xAxis.max=1.6*O[O.length-1][0]):P.length&&!O.length&&(B.xAxis.min=0,B.xAxis.max=2*P[0][0]);if(this.props.hasPrediction&&(B.xAxis.min=-.05,B.xAxis.max=1.05),this.props.LCP){var R=l.get("bitasset_data_id")?l:c,L=R.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3,D=R.getIn(["bitasset","current_feed","maximum_short_squeeze_ratio"])/1e3,V=this.props.invertedCalls?this.props.LCP/L*D:this.props.LCP*L/D;B.xAxis.plotLines.push({color:k,id:"plot_line",dashStyle:"longdash",value:this.props.LCP,label:{text:v.a.translate("explorer.block.call_limit",{price:this.props.LCP.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?5:-10},width:2,zIndex:5}),B.xAxis.plotLines.push({color:k,id:"plot_line",dashStyle:"longdash",value:V,label:{text:v.a.translate("explorer.block.gs_support",{price:V.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?-10:5},width:2,zIndex:5})}if(u){var z=l.has("bitasset")?y:b;B.xAxis.plotLines.push({color:z,id:"plot_line",dashStyle:"solid",value:u,label:{text:v.a.translate("explorer.block.feed_price",{price:u.toFixed(4)}),style:{color:d,fontWeight:"bold"},x:this.props.invertedCalls?5:-10},width:2,zIndex:5}),T&&T.length&&B.series.push({name:"Call "+A,data:T,color:h})}return u&&N&&N.length&&B.series.push({name:"Settle "+A,data:N,color:m,fillColor:f}),O.length&&B.series.push({step:"right",name:"Bid "+A,data:O,color:b,fillColor:g}),P.length&&B.series.push({step:"left",name:"Ask "+A,data:P,color:y,fillColor:_}),this.props.height?B.chart.height=this.props.height:B.chart.height="400px",this.props.onClick&&(B.chart.events={click:this.props.onClick.bind(this)}),this.props.noFrame?r.a.createElement("div",{className:"grid-content no-overflow no-padding"},O.length||P.length||T.length?null:r.a.createElement("span",{className:"no-data"},r.a.createElement(I.a,{content:"exchange.no_data"})),this.props.noText?null:r.a.createElement("p",{className:"bid-total"},F.a.format_number(s,l.get("precision"))," ",w),this.props.noText?null:r.a.createElement("p",{className:"ask-total"},F.a.format_number(i,c.get("precision"))," ",A),O||P||T?r.a.createElement(Ia.a,{config:B}):null):r.a.createElement("div",{className:"grid-content no-overflow no-padding middle-content"},r.a.createElement("div",{className:"exchange-bordered",id:"depth_chart"},r.a.createElement("div",{className:"exchange-content-header"},this.props.noText?null:r.a.createElement("span",{className:"bid-total"},F.a.format_number(s,l.get("precision"))," ",r.a.createElement(H.a,{name:l.get("symbol")})),this.props.noText?null:r.a.createElement("span",{className:"ask-total float-right"},F.a.format_number(i,c.get("precision"))," ",r.a.createElement(H.a,{name:c.get("symbol")}))),O.length||P.length||T.length?null:r.a.createElement("span",{className:"no-data"},r.a.createElement(I.a,{content:"exchange.no_data"})),O||P||T?r.a.createElement(Ia.a,{ref:"depthChart",config:B}):null))}}]),t}(r.a.Component);Da.defaultProps={flat_bids:[],flat_asks:[],orders:{},noText:!1,noFrame:!0},Da.propTypes={flat_bids:x.a.array.isRequired,flat_asks:x.a.array.isRequired,orders:x.a.object.isRequired};var Va=Da,za=a(41),Ua=a(2063),Ha=a(2186),Wa=a.n(Ha),Ga=a(148),Qa=a.n(Ga),Ka=a(604),Ja=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Za(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Xa=m.ChainTypes.operations,$a=Object.keys(Xa),en=function(e){function t(){return Ya(this,t),Za(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ja(t,[{key:"componentWillReceiveProps",value:function(e){if(e.account&&e.account.size&&this.props.account&&this.props.account.get("history")){var t=this.props.account.get("history")&&this.props.account.get("history").first()?this.props.account.get("history").first().toJS():null,a=e.account.get("history")&&e.account.get("history").first()?e.account.get("history").first().toJS():null;a&&t&&"fill_order"===$a[a.op[0]]&&(!t&&a.id||a.id!==t.id)&&(Qa.a.publish("account-notify","open"),setTimeout((function(){Qa.a.publish("account-notify","close")}),5e3))}}},{key:"shouldComponentUpdate",value:function(e){return!(!e.account||!this.props.account)&&(!Ft.a.is(e.account.get("history"),this.props.account.get("history"))||!Ft.a.is(e.account,this.props.account))}},{key:"render",value:function(){var e=this.props.account;if(!e)return r.a.createElement("div",null);var t=void 0,a=void 0;return this.props.account.get("history")&&this.props.account.get("history").size&&(t=this.props.account.get("history").first().toJS())&&(a=r.a.createElement(Ka.a,{key:t.id,op:t.op,result:t.result,block:t.block_num,current:e.get("id"),hideDate:!0,hideFee:!0})),t?r.a.createElement(Wa.a.Static,{id:"account-notify",title:null,image:"",wrapperElement:"div"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,a))):r.a.createElement("div",null)}}]),t}(r.a.Component);en.propTypes={account:R.a.ChainAccount.isRequired};var tn=en=Object(L.a)(en),an=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var on=function(e){function t(){return nn(this,t),rn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),an(t,[{key:"render",value:function(){return r.a.createElement(p.a,{stores:[s.a],inject:{account:function(){return s.a.getState().currentAccount}}},r.a.createElement(tn,null))}}]),t}(r.a.Component),sn=a(2192),ln=a(2076),cn=a(127),un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},pn=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var dn=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={rules:[].concat([])},a.handleSave=a.handleSave.bind(a),a.handleAddRule=a.handleAddRule.bind(a),a.handleTypeChange=a.handleTypeChange.bind(a),a.handleDeleteRule=a.handleDeleteRule.bind(a),a.handlePriceChange=a.handlePriceChange.bind(a),a.handlePriceFieldBlur=a.handlePriceFieldBlur.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),pn(t,[{key:"componentDidUpdate",value:function(e){if(!e.visible&&this.props.visible){var t={type:ee.a.HIGHER_THAN,price:this.props.latestPrice?Number(this.props.latestPrice):null},a=[];a=this.props.rules.length?this.props.rules:this.state.openedPreviously?[]:[t],this.setState({rules:a,openedPreviously:!0})}}},{key:"handleTypeChange",value:function(e){var t=this;return function(a){var n=t.state.rules.map((function(n,r){if(Number(e)!==Number(r))return n;var o=t.validatePrice(a,Number(n.price),Number(t.props.latestPrice));return un({},n,o,{type:String(a)})}));t.setState({rules:n})}}},{key:"validatePrice",value:function(e,t,a){return e===ee.a.HIGHER_THAN&&t<a?{validateStatus:"error",help:"Price of Alert should be higher than current price"}:e===ee.a.LOWER_THAN&&t>a?{validateStatus:"error",help:"Price of Alert  should be lower than current price"}:{validateStatus:"success",help:""}}},{key:"validatePriceFieldByKey",value:function(e){var t=this,a=this.state.rules.map((function(a,n){if(Number(e)!==Number(n))return a;var r=t.validatePrice(a.type,Number(a.price),Number(t.props.latestPrice));return un({},a,{validateStatus:r.validateStatus,help:r.help})}));this.setState({rules:a})}},{key:"handlePriceFieldBlur",value:function(e){var t=this;return function(){t.validatePriceFieldByKey(e)}}},{key:"handlePriceChange",value:function(e){var t=this;return function(a){var n=t.state.rules.map((function(n,r){if(Number(e)!==Number(r))return n;var o={};return n.validateStatus&&(o=t.validatePrice(n.type,Number(a.target.value),Number(t.props.latestPrice))),un({},n,o,{price:a.target.value})}));t.setState({rules:n})}}},{key:"handleAddRule",value:function(){var e=[].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(this.state.rules));e.push({type:ee.a.HIGHER_THAN,price:this.props.latestPrice?Number(this.props.latestPrice):null}),this.setState({rules:e})}},{key:"handleDeleteRule",value:function(e){var t=this;return function(){var a=t.state.rules.filter((function(t,a){return Number(a)!==Number(e)}));t.setState({rules:a})}}},{key:"handleSave",value:function(){this.props.onSave(this.state.rules)}},{key:"render",value:function(){var e=this;if(!(this.props.quoteAsset&&this.props.quoteAsset.get&&this.props.baseAsset&&this.props.baseAsset.get))return null;var t=[r.a.createElement(f.Button,{key:"submit",type:"primary",onClick:this.handleSave},v.a.translate("modal.save")),r.a.createElement(f.Button,{key:"cancel",onClick:this.props.hideModal},v.a.translate("modal.cancel"))],a=this.props.baseAsset.get("symbol"),n=this.props.quoteAsset.get("symbol"),o=n+"_"+a;return r.a.createElement(f.Modal,{visible:this.props.visible,onCancel:this.props.hideModal,title:v.a.translate("exchange.price_alert.title"),footer:t},r.a.createElement("div",{className:"exchange--price-alert"},r.a.createElement("div",{className:"exchange--price-alert--description"},this.state.rules.length?r.a.createElement("div",null,v.a.translate("exchange.price_alert.alert_when")," ",r.a.createElement(qe.a,{to:o},r.a.createElement(H.a,{name:n}),"/",r.a.createElement(H.a,{name:a}))," ","price:"):r.a.createElement("div",null,v.a.translate("exchange.price_alert.use_button"),r.a.createElement(qe.a,{to:o},r.a.createElement(H.a,{name:n}),"/",r.a.createElement(H.a,{name:a})),":"),r.a.createElement(f.Form,{layout:"vertical"},r.a.createElement("div",{className:"exchange--price-alert--items"},this.state.rules.map((function(t,n){return r.a.createElement(f.Form.Item,{key:n,validateStatus:t.validateStatus||null,help:t.help||null},r.a.createElement(f.Input.Group,{className:"exchange--price-alert--item",compact:!0},r.a.createElement(f.Select,{value:t.type,style:{width:"200px"},onChange:e.handleTypeChange(n)},r.a.createElement(f.Select.Option,{value:ee.a.HIGHER_THAN,key:"1"},v.a.translate("exchange.price_alert.higher_than")),r.a.createElement(f.Select.Option,{value:ee.a.LOWER_THAN,key:"2"},v.a.translate("exchange.price_alert.lower_than"))),r.a.createElement(f.Input,{onBlur:e.handlePriceFieldBlur(n),style:{width:"calc(100% - 200px - 32px)",marginTop:"1px"},onChange:e.handlePriceChange(n),value:t.price,className:"exchange--price-alert--item--price",placeholder:v.a.translate("exchange.price_alert.price"),addonAfter:r.a.createElement(H.a,{name:a})}),r.a.createElement(f.Button,{style:{width:"32px"},onClick:e.handleDeleteRule(n),className:"exchange--price-alert--item--control",type:"icon",icon:"delete"})))}))),r.a.createElement("div",{className:"exchange--price-alert--items--add"},r.a.createElement("a",{href:"javascript:void(0)",onClick:this.handleAddRule},r.a.createElement(f.Icon,{type:"plus"})," ",v.a.translate("exchange.price_alert.add_rule")))))))}}]),t}(r.a.Component),hn=dn=Object(cn.a)(dn,{propNames:["quoteAsset","baseAsset"]}),mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},gn=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function yn(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function vn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _n=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.EXPIRATIONS={HOUR:{title:"1 hour",get:function(){return w()().add(1,"hour").valueOf()}},"12HOURS":{title:"12 hours",get:function(){return w()().add(12,"hour").valueOf()}},"24HOURS":{title:"24 hours",get:function(){return w()().add(1,"day").valueOf()}},"7DAYS":{title:"7 days",get:function(){return w()().add(7,"day").valueOf()}},MONTH:{title:"30 days",get:function(){return w()().add(30,"day").valueOf()}},YEAR:{title:"1 year",get:function(){return w()().add(1,"year").valueOf()}},SPECIFIC:{title:"Specific",get:function(e){return a.state.expirationCustomTime[e].valueOf()}}},a._chartZoom=function(){O.a.changeViewSetting({chartZoom:!a.state.chartZoom});var e=a.state.chartType;a.setState({chartZoom:!a.state.chartZoom,chartType:"hidden_chart"}),setTimeout((function(){a.setState({chartType:e})}),100)},a._chartTools=function(){O.a.changeViewSetting({chartTools:!a.state.chartTools});var e=a.state.chartType;a.setState({chartTools:!a.state.chartTools,chartType:"hidden_chart"}),setTimeout((function(){a.setState({chartType:e})}),100)},a._flipOrderBook=function(){O.a.changeViewSetting({flipOrderBook:!a.state.flipOrderBook}),a.setState({flipOrderBook:!a.state.flipOrderBook})},a._orderBookReversed=function(){O.a.changeViewSetting({orderBookReversed:!a.state.orderBookReversed}),a.setState({orderBookReversed:!a.state.orderBookReversed})},a._hideFunctionButtons=function(){O.a.changeViewSetting({hideFunctionButtons:!a.state.hideFunctionButtons}),a.setState({hideFunctionButtons:!a.state.hideFunctionButtons})},a.state=bn({},a._initialState(e),{expirationType:{bid:e.exchange.getIn(["lastExpiration","bid"])||"YEAR",ask:e.exchange.getIn(["lastExpiration","ask"])||"YEAR"},expirationCustomTime:{bid:"Specific",ask:"Specific"},feeStatus:{}}),a._getWindowSize=Object(d.a)(a._getWindowSize.bind(a),150),a._checkFeeStatus=a._checkFeeStatus.bind(a),a._handleExpirationChange=a._handleExpirationChange.bind(a),a._handleCustomExpirationChange=a._handleCustomExpirationChange.bind(a),a.showPersonalizeModal=a.showPersonalizeModal.bind(a),a.hidePersonalizeModal=a.hidePersonalizeModal.bind(a),a.showConfirmSellOrderModal=a.showConfirmSellOrderModal.bind(a),a.hideConfirmSellOrderModal=a.hideConfirmSellOrderModal.bind(a),a.showConfirmBuyOrderModal=a.showConfirmBuyOrderModal.bind(a),a.hideConfirmBuyOrderModal=a.hideConfirmBuyOrderModal.bind(a),a.showMarketPickerModal=a.showMarketPickerModal.bind(a),a.hideMarketPickerModal=a.hideMarketPickerModal.bind(a),a.showDepositBridgeModal=a.showDepositBridgeModal.bind(a),a.hideDepositBridgeModal=a.hideDepositBridgeModal.bind(a),a.showDepositModal=a.showDepositModal.bind(a),a.hideDepositModal=a.hideDepositModal.bind(a),a.showBorrowQuoteModal=a.showBorrowQuoteModal.bind(a),a.hideBorrowQuoteModal=a.hideBorrowQuoteModal.bind(a),a.showBorrowBaseModal=a.showBorrowBaseModal.bind(a),a.hideBorrowBaseModal=a.hideBorrowBaseModal.bind(a),a.showPriceAlertModal=a.showPriceAlertModal.bind(a),a.hidePriceAlertModal=a.hidePriceAlertModal.bind(a),a.showScaledOrderModal=a.showScaledOrderModal.bind(a),a.hideScaledOrderModal=a.hideScaledOrderModal.bind(a),a.handlePriceAlertSave=a.handlePriceAlertSave.bind(a),a._createScaledOrder=a._createScaledOrder.bind(a),a.psInit=!0,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),gn(t,[{key:"handleOrderTypeTabChange",value:function(e,t){O.a.changeViewSetting(vn({},"order-form-"+e,t))}},{key:"handlePriceAlertSave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t=t.map((function(t){return{type:t.type,price:t.price,baseAssetSymbol:e.props.baseAsset.get("symbol"),quoteAssetSymbol:e.props.quoteAsset.get("symbol")}}));var a=this.props.priceAlert.filter((function(t){return t&&e.props.baseAsset&&e.props.quoteAsset&&(t.get("baseAssetSymbol")!==e.props.baseAsset.get("symbol")||t.get("quoteAssetSymbol")!==e.props.quoteAsset.get("symbol"))}));a=[].concat(yn(a),yn(t)),O.a.setPriceAlert(a),this.hidePriceAlertModal()}},{key:"getPriceAlertRules",value:function(){var e=this;return this.props.priceAlert.filter((function(t){return t&&e.props.baseAsset&&e.props.quoteAsset&&t.get("baseAssetSymbol")===e.props.baseAsset.get("symbol")&&t.get("quoteAssetSymbol")===e.props.quoteAsset.get("symbol")})).toJS()}},{key:"_handleExpirationChange",value:function(e,t){var a=bn({},this.state.expirationType,vn({},e,t.target.value));"SPECIFIC"!==t.target.value&&O.a.setExchangeLastExpiration(bn({},this.props.exchange.has("lastExpiration")&&this.props.exchange.get("lastExpiration").toJS()||{},vn({},e,t.target.value))),this.setState({expirationType:a})}},{key:"_handleCustomExpirationChange",value:function(e,t){var a=bn({},this.state.expirationCustomTime,vn({},e,t));this.setState({expirationCustomTime:a})}},{key:"_initialOrderState",value:function(e){var t={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new B.a({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")}),to_receive:new B.a({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")})};t.price=new B.i({base:t.for_sale,quote:t.to_receive});var a={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new B.a({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")}),to_receive:new B.a({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")})};return a.price=new B.i({base:a.for_sale,quote:a.to_receive}),{ask:a,bid:t}}},{key:"_initialState",value:function(e){var t=e.viewSettings,a=this._initialOrderState(e),n=a.ask,r=a.bid,o=t.get("chartHeight",620);return 620==o&&window.innerWidth<640&&(o=425),{isDepositBridgeModelLoaded:!1,isDepositModalLoaded:!1,isPersonalizeModalLoaded:!1,isMarketPickerModalLoaded:!1,isBorrowQuoteModalLoaded:!1,isBorrowBaseModalLoaded:!1,isDepositBridgeModalVisible:!1,isDepositModalVisible:!1,isPersonalizeModalVisible:!1,isMarketPickerModalVisible:!1,isBorrowQuoteModalVisible:!1,isBorrowBaseModalVisible:!1,history:[],isConfirmBuyOrderModalVisible:!1,isConfirmBuyOrderModalLoaded:!1,isConfirmSellOrderModalVisible:!1,isPriceAlertModalVisible:!1,isScaledOrderModalVisible:!1,isConfirmSellOrderModalLoaded:!1,tabVerticalPanel:t.get("tabVerticalPanel","my-market"),tabBuySell:t.get("tabBuySell","buy"),buySellOpen:t.get("buySellOpen",!0),bid:r,ask:n,height:window.innerHeight,width:window.innerWidth,favorite:!1,buyDiff:!1,sellDiff:!1,autoScroll:t.get("global_AutoScroll",!0),buySellTop:t.get("buySellTop",!0),buyFeeAssetIdx:t.get("buyFeeAssetIdx",0),sellFeeAssetIdx:t.get("sellFeeAssetIdx",0),verticalOrderBook:t.get("verticalOrderBook",!1),verticalOrderForm:t.get("verticalOrderForm",!1),hidePanel:t.get("hidePanel",!1),hideScrollbars:t.get("hideScrollbars",!1),singleColumnOrderForm:t.get("singleColumnOrderForm",!0),flipOrderBook:t.get("flipOrderBook",!1),flipBuySell:t.get("flipBuySell",!1),orderBookReversed:t.get("orderBookReversed",!1),chartType:t.get("chartType","price_chart"),chartHeight:o,chartZoom:t.get("chartZoom",!0),chartTools:t.get("chartTools",!0),hideFunctionButtons:t.get("hideFunctionButtons",!0),currentPeriod:t.get("currentPeriod",7776e3),showMarketPicker:!1,activePanels:t.get("activePanels",["left","right"]),mobileKey:[""],forceReRender:0,panelWidth:0,mirrorPanels:t.get("mirrorPanels",!1),panelTabs:t.get("panelTabs",{my_history:1,history:1,my_orders:2,open_settlement:2}),panelTabsActive:t.get("panelTabsActive",{1:"my_history",2:"my_orders"})}}},{key:"showMarketPickerModal",value:function(){this.setState({isMarketPickerModalVisible:!0,isMarketPickerModalLoaded:!0})}},{key:"hideMarketPickerModal",value:function(){this.setState({isMarketPickerModalVisible:!1})}},{key:"showPersonalizeModal",value:function(){this.setState({isPersonalizeModalVisible:!0,isPersonalizeModalLoaded:!0})}},{key:"hidePersonalizeModal",value:function(){this.setState({isPersonalizeModalVisible:!1})}},{key:"showPriceAlertModal",value:function(){this.setState({isPriceAlertModalVisible:!0})}},{key:"hidePriceAlertModal",value:function(){this.setState({isPriceAlertModalVisible:!1})}},{key:"showScaledOrderModal",value:function(){this.setState({isScaledOrderModalVisible:!0})}},{key:"hideScaledOrderModal",value:function(){this.setState({isScaledOrderModalVisible:!1})}},{key:"showBorrowQuoteModal",value:function(){this.setState({isBorrowQuoteModalVisible:!0,isBorrowQuoteModalLoaded:!0})}},{key:"hideBorrowQuoteModal",value:function(){this.setState({isBorrowQuoteModalVisible:!1})}},{key:"showBorrowBaseModal",value:function(){this.setState({isBorrowBaseModalVisible:!0,isBorrowBaseModalLoaded:!0})}},{key:"hideBorrowBaseModal",value:function(){this.setState({isBorrowBaseModalVisible:!1})}},{key:"showDepositBridgeModal",value:function(){this.setState({isDepositBridgeModalVisible:!0,isDepositBridgeModalLoaded:!0})}},{key:"hideDepositBridgeModal",value:function(){this.setState({isDepositBridgeModalVisible:!1})}},{key:"showDepositModal",value:function(){this.setState({isDepositModalVisible:!0,isDepositModalLoaded:!0})}},{key:"hideDepositModal",value:function(){this.setState({isDepositModalVisible:!1})}},{key:"_getLastMarketKey",value:function(){var e=h.Apis.instance().chain_id;return"lastMarket"+(e?"_"+e.substr(0,8):"")}},{key:"showConfirmBuyOrderModal",value:function(){this.setState({isConfirmBuyOrderModalVisible:!0,isConfirmBuyOrderModalLoaded:!0})}},{key:"hideConfirmBuyOrderModal",value:function(){this.setState({isConfirmBuyOrderModalVisible:!1})}},{key:"showConfirmSellOrderModal",value:function(){this.setState({isConfirmSellOrderModalVisible:!0,isConfirmSellOrderModalLoaded:!0})}},{key:"hideConfirmSellOrderModal",value:function(){this.setState({isConfirmSellOrderModalVisible:!1})}},{key:"componentWillMount",value:function(){window.addEventListener("resize",this._setDimensions,{capture:!1,passive:!0}),this._checkFeeStatus()}},{key:"componentDidMount",value:function(){P.a.getTrackedGroupsConfig(),O.a.changeViewSetting.defer(vn({},this._getLastMarketKey(),this.props.quoteAsset.get("symbol")+"_"+this.props.baseAsset.get("symbol"))),window.addEventListener("resize",this._getWindowSize,{capture:!1,passive:!0})}},{key:"_forceRender",value:function(e,t){this.state.forceReRender&&this.setState({forceReRender:!1}),F.a.are_equal_shallow(this.state.activePanels,t.activePanels)&&F.a.are_equal_shallow(this.state.verticalOrderBook,t.verticalOrderBook)&&e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset||this.setState({forceReRender:!0})}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.state.expirationType;if(this._forceRender(e,t),!e.marketReady&&!this.props.marketReady)return!1;var n=!1,r=!1;for(var o in e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset||this.setState({expirationType:{bid:"SPECIFIC"==a.bid?a.bid:"YEAR",ask:"SPECIFIC"==a.ask?a.ask:"YEAR"}}),e)if(e.hasOwnProperty(o)&&(n=n||!F.a.are_equal_shallow(e[o],this.props[o])))break;for(var s in t.panelTabsActive)r=!F.a.are_equal_shallow(t.panelTabsActive[s],this.state.panelTabsActive[s]);return n||r||!F.a.are_equal_shallow(t,this.state)}},{key:"_checkFeeStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[this.props.coreAsset,this.props.baseAsset,this.props.quoteAsset],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.currentAccount,n={},r=[];t.forEach((function(e){r.push(Object(M.b)({accountID:a.get("id"),feeID:e.get("id"),type:"limit_order_create"}))})),Promise.all(r).then((function(a){t.forEach((function(e,t){n[e.get("id")]=a[t]})),F.a.are_equal_shallow(e.state.feeStatus,n)||e.setState({feeStatus:n})})).catch((function(t){console.error("checkFeeStatusAsync error",t),e.setState({feeStatus:{}})}))}},{key:"_getWindowSize",value:function(){var e=window,t=e.innerHeight,a=e.innerWidth;if(t!==this.state.height||a!==this.state.width){this.setState({height:t,width:a});var n=this.refs.center;n&&S.a.update(n)}}},{key:"componentDidUpdate",value:function(e,t){if(this._initPsContainer(),!this.props.exchange.get("tutorialShown")&&e.coreAsset&&t.feeStatus&&!this.tutorialShown){this.tutorialShown=!0;var a=this.props.settings.get("themes");k.a.introJs().setOptions({tooltipClass:a,highlightClass:a,showBullets:!1,hideNext:!0,hidePrev:!0,nextLabel:v.a.translate("walkthrough.next_label"),prevLabel:v.a.translate("walkthrough.prev_label"),skipLabel:v.a.translate("walkthrough.skip_label"),doneLabel:v.a.translate("walkthrough.done_label")}).start(),O.a.setExchangeTutorialShown.defer(!0)}}},{key:"_initPsContainer",value:function(){if(this.refs.center&&this.psInit){var e=this.refs.center;e&&(S.a.initialize(e),this.psInit=!1)}}},{key:"componentWillReceiveProps",value:function(e){if(this._initPsContainer(),e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset&&e.currentAccount===this.props.currentAccount||this._checkFeeStatus([e.coreAsset,e.baseAsset,e.quoteAsset],e.currentAccount),e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol"))return this.setState(this._initialState(e)),O.a.changeViewSetting(vn({},this._getLastMarketKey(),e.quoteAsset.get("symbol")+"_"+e.baseAsset.get("symbol")))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._getWindowSize)}},{key:"_getFeeAssets",value:function(e,t,a){var n=this,r=this.props.currentAccount,o=this.state.feeStatus;function s(e,t){-1===e.indexOf(t)&&e.push(t)}var i=[a,e===a?t:e];s(i,e),s(i,t);var l=[a,t===a?e:t];s(l,e),s(l,t);var c={};function u(e,t,n){var r=void 0;return(e=e.filter((function(e){return!!t[e.get("id")]&&(a=e.get("id"),o[a]&&o[a].hasPoolBalance&&function(e){return o[e]&&o[e].hasBalance}(e.get("id")));var a}))).length?r=e[Math.min(e.length-1,n)]:(r=a,e.push(a)),{assets:e,asset:r}}r.get("balances",[]).filter((function(a,n){return["1.3.0",e.get("id"),t.get("id")].indexOf(n)>=0})).forEach((function(e,t){var a=m.ChainStore.getObject(e);c[t]={balance:a?parseInt(a.get("balance"),10):0,fee:n._getFee(m.ChainStore.getAsset(t))}}));var p=u(i,c,this.state.sellFeeAssetIdx),d=p.assets,h=p.asset,f=u(l,c,this.state.buyFeeAssetIdx),b=f.assets,g=f.asset;return{sellFeeAsset:h,sellFeeAssets:d,sellFee:this._getFee(h),buyFeeAsset:g,buyFeeAssets:b,buyFee:this._getFee(g)}}},{key:"_getFee",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.coreAsset;return this.state.feeStatus[e.get("id")]&&this.state.feeStatus[e.get("id")].fee}},{key:"_verifyFee",value:function(e,t,a,n){var r=this._getFee();return"1.3.0"===e.asset_id?r.getAmount()<=n?"1.3.0":null:(t.asset_id===e.asset_id?e.getAmount()+t.getAmount():t.getAmount())<=a?e.asset_id:r.getAmount()<=n&&"1.3.0"!==e.asset_id?"1.3.0":null}},{key:"_createLimitOrderConfirm",value:function(e,t,a,n,r,o){var s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],i=arguments[7];i.preventDefault();var l=this.props.marketData,c=l.highestBid,u=l.lowestAsk,p=this.state["sell"===o?"ask":"bid"];a=p.for_sale.clone(a?parseInt(m.ChainStore.getObject(a).toJS().balance,10):0),n=new B.a({amount:n?parseInt(m.ChainStore.getObject(n).toJS().balance,10):0});var d=this._getFee(r),h=this._verifyFee(d,p.for_sale,a.getAmount(),n.getAmount());if(!h)return f.Notification.error({message:v.a.translate("notifications.exchange_insufficient_funds_for_fees")});if("buy"===o&&u){var b=this.state.bid.price.toReal()/u.getPrice();if(b>1.2)return this.showConfirmBuyOrderModal(),this.setState({buyDiff:b})}else if("sell"===o&&c){var g=1/(this.state.ask.price.toReal()/c.getPrice());if(g>1.2)return this.showConfirmSellOrderModal(),this.setState({sellDiff:g})}var y=t.getIn(["bitasset","is_prediction_market"]);return p.for_sale.gt(a)&&!y?f.Notification.error({message:v.a.translate("notifications.exchange_insufficient_funds_to_place_order",{amount:p.for_sale.getAmount({real:!0}),symbol:t.get("symbol")})}):p.for_sale.getAmount()>0&&p.to_receive.getAmount()>0?"sell"===o&&y&&s?this._createPredictionShort(h):void this._createLimitOrder(o,h):f.Notification.warning({message:v.a.translate("notifications.exchange_enter_valid_values")})}},{key:"_createScaledOrder",value:function(e,t){var a=this,n=e.map((function(e){return new B.h({for_sale:e.for_sale,expiration:new Date(e.expirationTime||!1),to_receive:e.to_receive,seller:a.props.currentAccount.get("id"),fee:{asset_id:t,amount:0}})}));return P.a.createLimitOrder2(n).then((function(e){e.error&&"wallet locked"!==e.error.message&&f.Notification.error({message:v.a.translate("notifications.exchange_unknown_error_place_scaled_order")}),console.log("order success")})).catch((function(e){console.log("order failed:",e)}))}},{key:"_createLimitOrder",value:function(e,t){var a="sell"===e?"ask":"bid",n=this.state[a],r=null;r="SPECIFIC"===this.state.expirationType[a]?this.EXPIRATIONS[this.state.expirationType[a]].get(a):this.EXPIRATIONS[this.state.expirationType[a]].get();var o=new B.h({for_sale:n.for_sale,expiration:new Date(r||!1),to_receive:n.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:t,amount:0}}),s=N.a.getMarketName(this.props.baseAsset,this.props.quoteAsset),i=s.marketName,l=s.first,c=this.props.marketDirections.get(i);if(c&&l.get("id")!==this.props.baseAsset.get("id")||!c&&l.get("id")!==this.props.baseAsset.get("id")){var u={};u[i]=!c,O.a.changeMarketDirection(u)}return P.a.createLimitOrder2(o).then((function(e){e.error&&"wallet locked"!==e.error.message&&f.Notification.error({message:v.a.translate("notifications.exchange_unknown_error_place_order",{amount:n.to_receive.getAmount({real:!0}),symbol:n.to_receive.asset_id})})})).catch((function(e){console.error("order failed:",e)}))}},{key:"_clearForms",value:function(e){var t=this._initialOrderState(this.props),a=t.ask,n=t.bid;e?"ask"==e?this.setState({ask:a}):"bid"==e&&this.setState({bid:n}):this.setState({bid:n,ask:a})}},{key:"_createPredictionShort",value:function(e){var t=this.state.ask,a=new B.h({for_sale:t.for_sale,to_receive:t.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:e,amount:0}});Promise.all([Object(m.FetchChain)("getAsset",this.props.quoteAsset.getIn(["bitasset","options","short_backing_asset"]))]).then((function(e){var t=fn(e,1)[0],n=new B.a({amount:a.amount_for_sale.getAmount(),asset_id:t.get("id"),precision:t.get("precision")});P.a.createPredictionShort(a,n).then((function(e){e.error&&"wallet locked"!==e.error.message&&f.Notification.error({message:v.a.translate("notifications.exchange_unknown_error_place_order",{amount:buyAssetAmount,symbol:buyAsset.symbol})})}))}))}},{key:"_forceBuy",value:function(e,t,a,n){var r=this.state["sell"===e?"ask":"bid"];a=r.for_sale.clone(a?parseInt(m.ChainStore.getObject(a).get("balance"),10):0),n=new B.a({amount:n?parseInt(m.ChainStore.getObject(n).toJS().balance,10):0});var o=this._getFee(t),s=this._verifyFee(o,r.for_sale,a.getAmount(),n.getAmount());s?this._createLimitOrder(e,s):console.error("Unable to pay fees, aborting limit order creation")}},{key:"_forceSell",value:function(e,t,a,n){var r=this.state["sell"===e?"ask":"bid"];a=r.for_sale.clone(a?parseInt(m.ChainStore.getObject(a).get("balance"),10):0),n=new B.a({amount:n?parseInt(m.ChainStore.getObject(n).toJS().balance,10):0});var o=this._getFee(t),s=this._verifyFee(o,r.for_sale,a.getAmount(),n.getAmount());s?this._createLimitOrder(e,s):console.error("Unable to pay fees, aborting limit order creation")}},{key:"_cancelLimitOrder",value:function(e,t){t.preventDefault();var a=this.props.currentAccount;P.a.cancelLimitOrder(a.get("id"),e)}},{key:"_changeZoomPeriod",value:function(e,t){t.preventDefault(),e!==this.state.currentPeriod&&(this.setState({currentPeriod:e}),O.a.changeViewSetting({currentPeriod:e}))}},{key:"_onGroupOrderLimitChange",value:function(e){var t=this,a=void 0;if("object"==(void 0===e?"undefined":mn(e))&&(e.preventDefault(),a=parseInt(e.target.value)),"number"==typeof e&&(a=parseInt(e)),P.a.changeCurrentGroupLimit(a),a!==this.props.currentGroupOrderLimit){P.a.changeCurrentGroupLimit(a);var n=this.props.sub.split("_");P.a.unSubscribeMarket(n[0],n[1]).then((function(){t.props.subToMarket(t.props,t.props.bucketSize,a)}))}}},{key:"_depthChartClick",value:function(e,t,a){a.preventDefault();var n=this.state,r=n.bid,o=n.ask;r.price=new B.i({base:this.state.bid.for_sale,quote:this.state.bid.to_receive,real:a.xAxis[0].value}),r.priceText=r.price.toReal(),o.price=new B.i({base:this.state.ask.to_receive,quote:this.state.ask.for_sale,real:a.xAxis[0].value}),o.priceText=o.price.toReal();var s={bid:r,ask:o,depthLine:r.price.toReal()};this._setForSale(r,!0)||this._setReceive(r,!0),this._setReceive(o)||this._setForSale(o),this._setPriceText(r,!0),this._setPriceText(o,!1),this.setState(s)}},{key:"_setAutoscroll",value:function(e){this.setState({autoScroll:e})}},{key:"_togglePanel",value:function(e){if(e){var t=[];this.state.activePanels.forEach((function(a){a!==e&&t.push(a)})),this.state.activePanels.includes(e)||t.push(e),this.setState({activePanels:t}),O.a.changeViewSetting({activePanels:t})}}},{key:"_toggleChart",value:function(e){this.setState({chartType:e}),O.a.changeViewSetting({chartType:e})}},{key:"_flipBuySell",value:function(){this.setState({flipBuySell:!this.state.flipBuySell}),O.a.changeViewSetting({flipBuySell:!this.state.flipBuySell})}},{key:"_toggleOpenBuySell",value:function(){O.a.changeViewSetting({buySellOpen:!this.state.buySellOpen}),this.setState({buySellOpen:!this.state.buySellOpen})}},{key:"_toggleMarketPicker",value:function(e){var t=!!e;t&&this.showMarketPickerModal(),this.setState({showMarketPicker:t,marketPickerAsset:e})}},{key:"_moveOrderBook",value:function(){this.state.verticalOrderForm&&this._moveOrderForm(),O.a.changeViewSetting({verticalOrderBook:!this.state.verticalOrderBook}),this.setState({verticalOrderBook:!this.state.verticalOrderBook})}},{key:"_moveOrderForm",value:function(){this.state.verticalOrderBook&&this._moveOrderBook(),O.a.changeViewSetting({verticalOrderForm:!this.state.verticalOrderForm}),this.setState({verticalOrderForm:!this.state.verticalOrderForm})}},{key:"_togglePersonalize",value:function(){this.state.isPersonalizeModalVisible?this.setState({isPersonalizeModalVisible:!this.state.isPersonalizeModalVisible}):this.setState({isPersonalizeModalVisible:!this.state.isPersonalizeModalVisible,isPersonalizeModalLoaded:!0})}},{key:"_toggleScrollbars",value:function(){O.a.changeViewSetting({hideScrollbars:!this.state.hideScrollbars}),this.setState({hideScrollbars:!this.state.hideScrollbars})}},{key:"_toggleSingleColumnOrderForm",value:function(){O.a.changeViewSetting({singleColumnOrderForm:!this.state.singleColumnOrderForm}),this.setState({singleColumnOrderForm:!this.state.singleColumnOrderForm})}},{key:"_mirrorPanels",value:function(){this.setState({mirrorPanels:!this.state.mirrorPanels}),O.a.changeViewSetting({mirrorPanels:!this.state.mirrorPanels})}},{key:"_currentPriceClick",value:function(e,t){var a="bid"===e,n=this.state[e];n.price=t[a?"invert":"clone"](),n.priceText=n.price.toReal(),a?this._setForSale(n,a)||this._setReceive(n,a):this._setReceive(n,a)||this._setForSale(n,a),this.forceUpdate()}},{key:"_orderbookClick",value:function(e){var t=e.isBid(),a=e.totalToReceive({noCache:!0}),n=a.times(e.sellPrice()),r=new B.i({base:t?n:a,quote:t?a:n}),o=this.state[t?"bid":"ask"];o.price=r,o.priceText=r.toReal();var s=vn({},t?"ask":"bid",{for_sale:a,forSaleText:a.getAmount({real:!0}),to_receive:n,toReceiveText:n.getAmount({real:!0}),price:r,priceText:r.toReal()});t?this._setForSale(o,t)||this._setReceive(o,t):this._setReceive(o,t)||this._setForSale(o,t),this.setState(s)}},{key:"_borrowQuote",value:function(){this.showBorrowQuoteModal()}},{key:"_borrowBase",value:function(){this.showBorrowBaseModal()}},{key:"_onDeposit",value:function(e){this.setState({depositModalType:e}),this.showDepositModal()}},{key:"_onBuy",value:function(e){this.setState({buyModalType:e}),this.showDepositBridgeModal()}},{key:"_getSettlementInfo",value:function(){var e=this.props,t=e.lowestCallPrice,a=e.feedPrice,n=e.quoteAsset,r=!1;return a&&(r=a.inverted?t<=a.toReal():t>=a.toReal()),!(!r||!t||n.getIn(["bitasset","is_prediction_market"]))}},{key:"_setTabVerticalPanel",value:function(e){this.setState({tabVerticalPanel:e}),O.a.changeViewSetting({tabVerticalPanel:e})}},{key:"_setTabBuySell",value:function(e){this.setState({tabBuySell:e}),O.a.changeViewSetting({tabBuySell:e})}},{key:"_setPanelTabInGroup",value:function(e,t){var a=this.state.panelTabsActive;Object.keys(a).map((function(n){n==e&&(a[n]=t)})),this.setState({panelTabsActive:a,forceReRender:!0}),O.a.changeViewSetting({panelTabsActive:a})}},{key:"_setPanelTabs",value:function(e,t){var a=this.state,n=a.panelTabs,r=a.panelTabsActive,o={panelTabs:n,panelTabsActive:r};Object.keys(n).map((function(a){o.panelTabs[a]=a==e?t:n[a]})),Object.keys(r).map((function(e){o.panelTabsActive[e]=""})),this.setState({newState:o}),O.a.changeViewSetting(bn({},o))}},{key:"onChangeFeeAsset",value:function(e,t){"buy"===e?(this.setState({buyFeeAssetIdx:t}),O.a.changeViewSetting({buyFeeAssetIdx:t})):(this.setState({sellFeeAssetIdx:t}),O.a.changeViewSetting({sellFeeAssetIdx:t}))}},{key:"onChangeChartHeight",value:function(e){var t=e.value,a=e.increase,n=t||this.state.chartHeight+(a?20:-20);n<425&&(n=425),n>1e3&&(n=1e3),this.setState({chartHeight:n}),O.a.changeViewSetting({chartHeight:n})}},{key:"_toggleBuySellPosition",value:function(){this.setState({buySellTop:!this.state.buySellTop}),O.a.changeViewSetting({buySellTop:!this.state.buySellTop})}},{key:"_setReceive",value:function(e,t){return!(!e.price.isValid()||!e.for_sale.hasAmount())&&(e.to_receive=e.for_sale.times(e.price),e.toReceiveText=e.to_receive.getAmount({real:!0}).toString(),!0)}},{key:"_setForSale",value:function(e,t){return!(!e.price.isValid()||!e.to_receive.hasAmount())&&(e.for_sale=e.to_receive.times(e.price,!0),e.forSaleText=e.for_sale.getAmount({real:!0}).toString(),!0)}},{key:"_setPrice",value:function(e){return!(!e.for_sale.hasAmount()||!e.to_receive.hasAmount())&&(e.price=new B.i({base:e.for_sale,quote:e.to_receive}),e.priceText=e.price.toReal().toString(),!0)}},{key:"_setPriceText",value:function(e,t){var a=e[t?"for_sale":"to_receive"],n=e[t?"to_receive":"for_sale"];a.hasAmount()&&n.hasAmount()&&(e.priceText=new B.i({base:a,quote:n}).toReal().toString())}},{key:"_onInputPrice",value:function(e,t){var a=this.state[e],n="bid"===e;a.price=new B.i({base:a[n?"for_sale":"to_receive"],quote:a[n?"to_receive":"for_sale"],real:parseFloat(t.target.value)||0}),n?this._setForSale(a,n)||this._setReceive(a,n):this._setReceive(a,n)||this._setForSale(a,n),a.priceText=t.target.value,this.forceUpdate()}},{key:"_onInputSell",value:function(e,t,a){var n=this.state[e];n.for_sale.setAmount({real:parseFloat(a.target.value)||0}),n.price.isValid()?this._setReceive(n,t):this._setPrice(n),n.forSaleText=a.target.value,this._setPriceText(n,"bid"===e),this.forceUpdate()}},{key:"_onInputReceive",value:function(e,t,a){var n=this.state[e];n.to_receive.setAmount({real:parseFloat(a.target.value)||0}),n.price.isValid()?this._setForSale(n,t):this._setPrice(n),n.toReceiveText=a.target.value,this._setPriceText(n,"bid"===e),this.forceUpdate()}},{key:"isMarketFrozen",value:function(){var e=this.props,t=e.baseAsset,a=e.quoteAsset,n=t.getIn(["options","whitelist_markets"]).toJS(),r=a.getIn(["options","whitelist_markets"]).toJS(),o=t.getIn(["options","blacklist_markets"]).toJS(),s=a.getIn(["options","blacklist_markets"]).toJS();return r.length&&-1===r.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:a.get("symbol")}:n.length&&-1===n.indexOf(a.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:s.length&&-1!==s.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:a.get("symbol")}:o.length&&-1!==o.indexOf(a.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:{isFrozen:!1}}},{key:"_toggleMiniChart",value:function(){O.a.changeViewSetting({miniDepthChart:!this.props.miniDepthChart})}},{key:"_onChangeMobilePanel",value:function(e){this.setState({mobileKey:e})}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentAccount,n=t.marketLimitOrders,o=t.marketCallOrders,s=t.marketData,i=t.activeMarketHistory,l=t.invertedCalls,c=t.starredMarkets,u=t.quoteAsset,p=t.baseAsset,d=t.lowestCallPrice,h=t.marketStats,m=t.marketReady,b=t.marketSettleOrders,y=t.bucketSize,_=t.totals,k=t.feedPrice,E=t.buckets,w=t.coreAsset,C=t.trackedGroupsConfig,S=t.currentGroupOrderLimit,A=s.combinedBids,x=s.combinedAsks,O=s.lowestAsk,P=s.highestBid,N=s.flatBids,B=s.flatAsks,M=s.flatCalls,F=s.flatSettles,j=s.groupedBids,I=s.groupedAsks,R=this.state,L=R.bid,D=R.ask,V=R.verticalOrderBook,z=R.verticalOrderForm,U=R.chartHeight,H=R.chartType,W=R.flipBuySell,G=R.buyDiff,Q=R.sellDiff,K=R.width,J=R.buySellTop,Y=R.tabBuySell,Z=R.tabVerticalPanel,X=R.hidePanel,ee=R.hideScrollbars,te=R.buyModalType,ae=R.depositModalType,ne=R.autoScroll,re=R.activePanels,oe=R.panelWidth,se=R.mirrorPanels,ie=R.panelTabsActive,le=R.panelTabs,ce=R.singleColumnOrderForm,ue=R.flipOrderBook,pe=R.orderBookReversed,de=R.chartZoom,he=R.chartTools,me=R.hideFunctionButtons,fe=this.isMarketFrozen(),be=fe.isFrozen,ge=(fe.frozenAsset,K);this.refs.center&&(ge=this.refs.center.clientWidth);var ye=null,ve=null,_e=null,ke=null,Ee=null,we=null,Ce=void 0,Se=void 0,Ae=!1,xe=void 0,Oe=void 0,Pe=this.props.viewSettings.get("showVolumeChart",!0);if(ee=!!Qe||ee,u.size&&p.size&&a.size){if(ve=u,Se=(ye=p).get("symbol"),Ce=ve.get("symbol"),_e=a.get("balances").toJS())for(var Te in _e)Te===ve.get("id")&&(ke=_e[Te]),Te===ye.get("id")&&(Ee=_e[Te]),"1.3.0"===Te&&(we=_e[Te]);Ae=this._getSettlementInfo()}var Ne=!!u.get("bitasset_data_id"),Be=!!p.get("bitasset_data_id"),Me=O&&P?O.getPrice()-P.getPrice():0;if(i.size){var Fe=i.take(2);xe=Fe.first();var je=Fe.last();Oe=xe.getPrice()===je.getPrice()?"":xe.getPrice()-je.getPrice()>0?"change-up":"change-down"}if(!w||!Object.keys(this.state.feeStatus).length)return null;var qe=this._getFeeAssets(ve,ye,w),Re=qe.sellFeeAsset,Le=qe.sellFeeAssets,De=qe.sellFee,Ve=qe.buyFeeAsset,ze=qe.buyFeeAssets,Ue=qe.buyFee,He=ye.getIn(["bitasset","is_prediction_market"])||ve.getIn(["bitasset","is_prediction_market"]),We=null;He&&(We=u.getIn(["options","description"]),We=T.a.parseDescription(We).main);var Ge=K<850,Qe=K<640,Ke=Math.max(this.state.height>1100?U:U-125,300),Ye=this.state.expirationType,Ze=this.state.expirationCustomTime,Xe=re.length>=1,$e=ye.getIn(["bitasset","is_prediction_market"]),et=0,tt=function(t){return r.a.createElement("div",{className:"exchange-content-header"},r.a.createElement(q.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!0,keys:[{type:"asset",value:e.props.quoteAsset.get("symbol"),arg:"asset"},{type:"translate",value:t?"exchange.buy":"exchange.sell",arg:"direction"}]}))},at=be||Qe&&!this.state.mobileKey.includes("buySellTab")?null:r.a.createElement(f.Tabs,{animated:!1,activeKey:this.props.viewSettings.get("order-form-bid")||"limit",onChange:this.handleOrderTypeTabChange.bind(this,"bid"),tabBarExtraContent:r.a.createElement("div",null,tt(!0)),defaultActiveKey:"limit",className:g()("exchange--buy-sell-form",z&&!Ge?"":ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"","small-12 exchange-padded middle-content",W?"order-"+(J?2:3)+" large-order-"+(J?2:5)+" sell-form":"order-"+(J?1:2)+" large-order-"+(J?1:4)+" buy-form")},r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.limit"),key:"limit"},r.a.createElement($,{showScaledOrderModal:this.showScaledOrderModal,key:"actionCard_"+et++,onBorrow:Be?this._borrowBase.bind(this):null,onBuy:this._onBuy.bind(this,"bid"),onDeposit:this._onDeposit.bind(this,"bid"),currentAccount:a,backedCoin:this.props.backedCoins.find((function(e){return e.symbol===ye.get("symbol")})),currentBridges:this.props.bridgeCoins.get(ye.get("symbol"))||null,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),parentWidth:ge,styles:{padding:5,paddingRight:se?15:5},type:"bid",hideHeader:!0,expirationType:Ye.bid,expirations:this.EXPIRATIONS,expirationCustomTime:Ze.bid,onExpirationTypeChange:this._handleExpirationChange.bind(this,"bid"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"bid"),amount:L.toReceiveText,price:L.priceText,total:L.forSaleText,quote:ve,base:ye,amountChange:this._onInputReceive.bind(this,"bid",!0),priceChange:this._onInputPrice.bind(this,"bid"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputSell.bind(this,"bid",!1),clearForm:this._clearForms.bind(this,"bid"),balance:Ee,balanceId:ye.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,ve,ye,Ee,we,Ve,"buy"),balancePrecision:ye.get("precision"),quotePrecision:ve.get("precision"),totalPrecision:ye.get("precision"),currentPrice:O.getPrice(),currentPriceObject:O,account:a.get("name"),fee:Ue,hasFeeBalance:this.state.feeStatus[Ue.asset_id].hasBalance,feeAssets:ze,feeAsset:Ve,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"buy"),isPredictionMarket:ye.getIn(["bitasset","is_prediction_market"]),onFlip:W?null:this._flipBuySell.bind(this),onTogglePosition:this.state.buySellTop&&!V?this._toggleBuySellPosition.bind(this):null,moveOrderForm:Ge||W&&!z?null:this._moveOrderForm.bind(this),verticalOrderForm:!Ge&&z,isPanelActive:Xe,activePanels:re,singleColumnOrderForm:ce,hideFunctionButtons:me})),r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.scaled"),key:"scaled"},r.a.createElement(Ie,{expirationType:Ye.bid,expirations:this.EXPIRATIONS,expirationCustomTime:Ze.bid,onExpirationTypeChange:this._handleExpirationChange.bind(this,"bid"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"bid"),currentPrice:O.getPrice(),lastClickedPrice:this.state.ask&&this.state.ask.priceText,currentAccount:a,createScaledOrder:this._createScaledOrder,type:"bid",quoteAsset:ve,baseAsset:ye}))),nt=be||Qe&&!this.state.mobileKey.includes("buySellTab")?null:r.a.createElement(f.Tabs,{activeKey:this.props.viewSettings.get("order-form-ask")||"limit",onChange:this.handleOrderTypeTabChange.bind(this,"ask"),animated:!1,tabBarExtraContent:r.a.createElement("div",null,tt(!1)),defaultActiveKey:"limit",className:g()("exchange--buy-sell-form",z&&!Ge?"":ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"","small-12 exchange-padded middle-content",W?"order-"+(J?1:2)+" large-order-"+(J?1:4)+" buy-form":"order-"+(J?2:3)+" large-order-"+(J?2:5)+" sell-form")},r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.limit"),key:"limit"},r.a.createElement($,{showScaledOrderModal:this.showScaledOrderModal,key:"actionCard_"+et++,onBorrow:Ne?this._borrowQuote.bind(this):null,onBuy:this._onBuy.bind(this,"ask"),onDeposit:this._onDeposit.bind(this,"ask"),currentAccount:a,backedCoin:this.props.backedCoins.find((function(e){return e.symbol===ve.get("symbol")})),currentBridges:this.props.bridgeCoins.get(ve.get("symbol"))||null,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),parentWidth:ge,styles:{padding:5,paddingRight:se?15:5},type:"ask",hideHeader:!0,amount:D.forSaleText,price:D.priceText,total:D.toReceiveText,quote:ve,base:ye,expirationType:Ye.ask,expirations:this.EXPIRATIONS,expirationCustomTime:Ze.ask,onExpirationTypeChange:this._handleExpirationChange.bind(this,"ask"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"ask"),amountChange:this._onInputSell.bind(this,"ask",!1),priceChange:this._onInputPrice.bind(this,"ask"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputReceive.bind(this,"ask",!0),clearForm:this._clearForms.bind(this,"ask"),balance:ke,balanceId:ve.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,ye,ve,ke,we,Re,"sell"),balancePrecision:ve.get("precision"),quotePrecision:ve.get("precision"),totalPrecision:ye.get("precision"),currentPrice:P.getPrice(),currentPriceObject:P,account:a.get("name"),fee:De,hasFeeBalance:this.state.feeStatus[De.asset_id].hasBalance,feeAssets:Le,feeAsset:Re,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"sell"),isPredictionMarket:ve.getIn(["bitasset","is_prediction_market"]),onFlip:W?this._flipBuySell.bind(this):null,onTogglePosition:this.state.buySellTop&&!V?this._toggleBuySellPosition.bind(this):null,moveOrderForm:Ge||!W&&!z?null:this._moveOrderForm.bind(this),verticalOrderForm:!Ge&&z,isPanelActive:Xe,activePanels:re,singleColumnOrderForm:ce,hideFunctionButtons:me})),r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.scaled"),key:"scaled"},r.a.createElement(Ie,{expirationType:Ye.ask,expirations:this.EXPIRATIONS,expirationCustomTime:Ze.ask,onExpirationTypeChange:this._handleExpirationChange.bind(this,"ask"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"ask"),currentPrice:P.getPrice(),lastClickedPrice:this.state.ask&&this.state.ask.priceText,currentAccount:a,createScaledOrder:this._createScaledOrder,type:"ask",baseAsset:ye,quoteAsset:ve}))),rt=Qe&&!this.state.mobileKey.includes("myMarkets")?null:r.a.createElement($t.a,{key:"actionCard_"+et++,className:"left-order-book no-overflow order-9",style:{minWidth:350,height:Ge?680:"calc(100vh - 215px)",padding:Ge?10:0},headerStyle:{width:"100%",display:Ge?"":"display: none"},noHeader:!0,listHeight:this.state.height-450,columns:[{name:"star",index:1},{name:"market",index:2},{name:"vol",index:3},{name:"price",index:4},{name:"change",index:5}],findColumns:[{name:"market",index:1},{name:"issuer",index:2},{name:"vol",index:3},{name:"add",index:4}],current:Ce+"_"+Se,location:this.props.location,history:this.props.history,activeTab:Z||"my-market"}),ot=Qe&&!this.state.mobileKey.includes("orderBook")?null:r.a.createElement(Bt,{ref:"order_book",key:"actionCard_"+et++,latest:xe&&xe.getPrice(),changeClass:Oe,orders:n,calls:o,invertedCalls:l,combinedBids:A,combinedAsks:x,highestBid:P,lowestAsk:O,totalBids:_.bid,totalAsks:_.ask,base:ye,quote:ve,baseSymbol:Se,quoteSymbol:Ce,onClick:this._orderbookClick.bind(this),horizontal:!(V&&!Ge),flipOrderBook:ue,orderBookReversed:pe,marketReady:m,wrapperClass:g()(ge>1200?"xlarge-8":"","medium-12 large-12","small-12 grid-block orderbook no-padding align-spaced no-overflow wrap shrink","order-"+(J?3:1)+" xlarge-order-"+(J?4:1)),innerClass:g()(ge>1200?"medium-6":ge>800?"medium-6 large-6":"","small-12 middle-content",Qe?"":"exchange-padded"),currentAccount:this.props.currentAccount.get("id"),handleGroupOrderLimitChange:this._onGroupOrderLimitChange.bind(this),trackedGroupsConfig:C,currentGroupOrderLimit:S,groupedBids:j,groupedAsks:I,isPanelActive:re.length>=1,onTogglePosition:this.state.buySellTop?null:this._toggleBuySellPosition.bind(this),moveOrderBook:Ge?null:this._moveOrderBook.bind(this),smallScreen:Ge,hideScrollbars:ee,autoScroll:ne,onFlipOrderBook:this._flipOrderBook.bind(this),hideFunctionButtons:me});oe=350,this.refs.order_book&&this.refs.order_book.verticalStickyTable&&this.refs.order_book.verticalStickyTable.current&&this.refs.order_book.verticalStickyTable.current.scrollData&&(oe=this.refs.order_book.verticalStickyTable.current.scrollData.scrollWidth);var st=Qe&&!this.state.mobileKey.includes("marketHistory")?null:r.a.createElement(Xt,{key:"actionCard_"+et++,className:g()(0==le.history?ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-6"),innerClass:Qe?"":"exchange-padded",innerStyle:{paddingBottom:Qe?"0":"1.2rem"},noHeader:0!=le.history,history:i,currentAccount:a,myHistory:a.get("history"),base:ye,quote:ve,baseSymbol:Se,quoteSymbol:Ce,activeTab:"history",tinyScreen:Qe,isPanelActive:Xe,hideScrollbars:ee}),it=Qe&&!this.state.mobileKey.includes("myMarketHistory")?null:r.a.createElement(Xt,{key:"actionCard_"+et++,className:g()(0==le.my_history?ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12",V||z?"order-4":"order-3"),innerClass:Qe?"":"exchange-padded",innerStyle:{paddingBottom:Qe?"0":"1.2rem"},noHeader:0!=le.my_history,history:i,currentAccount:a,myHistory:a.get("history"),base:ye,quote:ve,baseSymbol:Se,quoteSymbol:Ce,activeTab:"my_history",tinyScreen:Qe,isPanelActive:Xe,hideScrollbars:ee}),lt=Qe&&!this.state.mobileKey.includes("myOpenOrders")?null:r.a.createElement(vt,{key:"actionCard_"+et++,style:{marginBottom:Qe?0:15},className:g()(0==le.my_orders?ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-7"),innerClass:Qe?"":"exchange-padded",innerStyle:{paddingBottom:Qe?"0":"1.2rem"},noHeader:0!=le.my_orders,orders:n,settleOrders:b,currentAccount:a,base:ye,quote:ve,baseSymbol:Se,quoteSymbol:Ce,activeTab:"my_orders",onCancel:this._cancelLimitOrder.bind(this),flipMyOrders:this.props.viewSettings.get("flipMyOrders"),feedPrice:this.props.feedPrice,smallScreen:Ge,tinyScreen:Qe,hidePanel:X,isPanelActive:Xe,hideScrollbars:ee}),ct=0===b.size||Qe&&!this.state.mobileKey.includes("settlementOrders")?null:r.a.createElement(vt,{key:"actionCard_"+et++,style:{marginBottom:Qe?0:15},className:g()(0==le.open_settlement?ge>1200?"medium-6 large-6 xlarge-4":ge>800?"medium-6":"":"medium-12","no-padding no-overflow middle-content small-12 order-8"),innerClass:Qe?"":"exchange-padded",innerStyle:{paddingBottom:Qe?"0":"1.2rem"},noHeader:0!=le.open_settlement,orders:n,settleOrders:b,currentAccount:a,base:ye,quote:ve,baseSymbol:Se,quoteSymbol:Ce,activeTab:"open_settlement",onCancel:this._cancelLimitOrder.bind(this),flipMyOrders:this.props.viewSettings.get("flipMyOrders"),feedPrice:this.props.feedPrice,smallScreen:Ge,tinyScreen:Qe,hidePanel:X,isPanelActive:Xe,hideScrollbars:ee}),ut=!Qe&&"price_chart"!=H||Qe&&!this.state.mobileKey.includes("tradingViewChart")?null:r.a.createElement(Ma,{locale:this.props.locale,dataFeed:this.props.dataFeed,baseSymbol:Se,quoteSymbol:Ce,marketReady:m,theme:this.props.settings.get("themes"),buckets:E,bucketSize:y,currentPeriod:this.state.currentPeriod,chartHeight:Ke,chartZoom:!Qe&&de,chartTools:!Qe&&he,mobile:Qe}),pt=!Qe&&"market_depth"!=H||Qe&&!this.state.mobileKey.includes("deptHighChart")?null:r.a.createElement(Va,{marketReady:m,orders:n,showCallLimit:Ae,call_orders:o,flat_asks:B,flat_bids:N,flat_calls:Ae?M:[],flat_settles:this.props.settings.get("showSettles")&&F,settles:b,invertedCalls:l,totalBids:_.bid,totalAsks:_.ask,base:ye,quote:ve,height:Ke,isPanelActive:Xe,onClick:this._depthChartClick.bind(this,ye,ve),feedPrice:!He&&k&&k.toReal(),spread:Me,LCP:Ae?d:null,hasPrediction:He,noFrame:!1,theme:this.props.settings.get("themes"),centerRef:this.refs.center,activePanels:re}),dt=r.a.createElement("div",{className:"exchange--chart-control",style:{height:33,right:"price_chart"==H?"5rem":"15rem",top:"1px",position:"absolute",zIndex:1,padding:"0.2rem"}},"price_chart"==H&&r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.chart_tools")},r.a.createElement(f.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:this._chartTools.bind(this),type:"tool"})),r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.increase_chart_height")},r.a.createElement(f.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:function(){e.onChangeChartHeight({increase:!0})},type:"up"})),r.a.createElement(f.Tooltip,{title:v.a.translate("exchange.settings.tooltip.decrease_chart_height")},r.a.createElement(f.Icon,{style:{cursor:"pointer",fontSize:"1.4rem",marginRight:"0.6rem"},onClick:function(){e.onChangeChartHeight({increase:!1})},type:"down"})),r.a.createElement(f.Tooltip,{title:"market_depth"==H?v.a.translate("exchange.settings.tooltip.show_price_chart"):v.a.translate("exchange.settings.tooltip.show_market_depth")},r.a.createElement(f.Icon,{style:{cursor:"pointer",fontSize:"1.4rem"},onClick:function(){"market_depth"==H?e._toggleChart("price_chart"):e._toggleChart("market_depth")},type:"market_depth"==H?"bar-chart":"area-chart"}))),ht=r.a.createElement("div",{key:"actionCard_"+et++,className:"left-order-book small-12",style:{paddingLeft:5,width:Ge?"auto":300}},r.a.createElement(f.Tabs,{defaultActiveKey:"buy",activeKey:Y,onChange:this._setTabBuySell.bind(this),style:{padding:"0px !important",margin:"0px !important"}},r.a.createElement(f.Tabs.TabPane,{tab:r.a.createElement(q.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!1,keys:[{type:"asset",value:ve.get("symbol"),arg:"asset"},{type:"translate",value:$e?"exchange.short":"exchange.buy",arg:"direction"}]}),key:"buy"},at),r.a.createElement(f.Tabs.TabPane,{tab:r.a.createElement(q.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!1,keys:[{type:"asset",value:ve.get("symbol"),arg:"asset"},{type:"translate",value:$e?"exchange.short":"exchange.sell",arg:"direction"}]}),key:"sell"},nt))),mt={1:[],2:[]},ft=[];Object.keys(le).sort().map((function(e){0==le[e]?("my_history"==e&&ft.push(it),"history"==e&&ft.push(st),"my_orders"==e&&ft.push(lt),"open_settlement"==e&&null!==ct&&ft.push(ct)):("my_history"==e&&mt[le[e]].push(r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.my_history"),key:"my_history"},it)),"history"==e&&mt[le[e]].push(r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.history"),key:"history"},st)),"my_orders"==e&&mt[le[e]].push(r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.my_orders"),key:"my_orders"},lt)),"open_settlement"==e&&null!==ct&&mt[le[e]].push(r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.settle_orders"),key:"open_settlement"},ct)))})),Object.keys(ie).map((function(e){Object.keys(le).map((function(t){var a=!1;a||e!=le[t]||(ie[e]=ie[e]?ie[e]:t,a=!0)}))}));var bt=ft.length;Object.keys(mt).map((function(e){mt[e].length&&bt++}));var gt=mt[1].length>0?r.a.createElement("div",{key:"actionCard_"+et++,className:g()(ge>1200?1==bt?"medium-12 xlarge-4":"medium-6 xlarge-4 ":ge>800?1==bt?"medium-12":"medium-6":"","small-12 order-5",V?"xlarge-order-5":"",V||z?"":ge<1200?"xlarge-order-5":"xlarge-order-2"),style:{paddingRight:5}},r.a.createElement(f.Tabs,{activeKey:ie[1],onChange:this._setPanelTabInGroup.bind(this,1)},mt[1])):null,yt=mt[2].length>0?r.a.createElement("div",{key:"actionCard_"+et++,className:g()(ge>1200?1==bt?"medium-12 xlarge-4":"medium-6 xlarge-4 ":ge>800?1==bt?"medium-12":"medium-6":"","small-12 order-6"),style:{paddingRight:5}},r.a.createElement(f.Tabs,{activeKey:ie[2],onChange:this._setPanelTabInGroup.bind(this,2)},mt[2])):null,_t=bt>2?null:r.a.createElement("div",{className:g()(ge>1200&&(V||V)?"xlarge-order-6 xlarge-8 order-9":"","small-12 grid-block orderbook no-padding align-spaced no-overflow wrap"),key:"actionCard_"+et++}," "),kt=[];Ge?Qe?kt=r.a.createElement(f.Collapse,{activeKey:this.state.mobileKey,onChange:this._onChangeMobilePanel.bind(this),style:{paddingRight:8}},r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.price_history"),key:"tradingViewChart"},ut),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.order_depth"),key:"deptHighChart"},pt),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.buy_sell"),key:"buySellTab"},ht),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.order_book"),key:"orderBook"},ot),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.history"),key:"marketHistory"},st),null!==ct?r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.settle_orders"),key:"settlementOrders"},ct):null,r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.my_history"),key:"myMarketHistory"},it),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.my_orders"),key:"myOpenOrders"},lt),r.a.createElement(f.Collapse.Panel,{header:v.a.translate("exchange.market_name"),key:"myMarkets"},r.a.createElement(f.Tabs,{defaultActiveKey:"my-market",activeKey:Z,onChange:this._setTabVerticalPanel.bind(this)},r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.market_name"),key:"my-market"}),r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.more"),key:"find-market"})),rt)):(kt.push(at),kt.push(nt),kt.push(ot),kt.push(ft),kt.push(gt),kt.push(yt),kt.push(r.a.createElement("div",{className:"order-10 small-12",key:"actionCard_"+et++},r.a.createElement(f.Tabs,{defaultActiveKey:"my-market",activeKey:Z,onChange:this._setTabVerticalPanel.bind(this)},r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.market_name"),key:"my-market"}),r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.more"),key:"find-market"})),rt))):(z||(kt.push(at),kt.push(nt)),V||kt.push(ot),(V||z)&&kt.push(_t),kt.push(ft),kt.push(gt),kt.push(yt));var Et=null,wt=null,Ct=null,St=null,At=!1,xt=!1;return Ge||(V&&(Et=r.a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block",height:"calc(100vh - 170px)",width:oe}},ot)),z&&(Et=r.a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block",height:"calc(100vh - 170px)",width:300}},ht)),wt=r.a.createElement("div",{className:"left-order-book no-padding no-overflow",style:{display:"block"},key:"actionCard_"+et++},r.a.createElement("div",{className:"v-align no-padding align-center grid-block footer shrink column","data-intro":v.a.translate("walkthrough.my_markets")},r.a.createElement(f.Tabs,{defaultActiveKey:"my-market",activeKey:Z,onChange:this._setTabVerticalPanel.bind(this)},r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.market_name"),key:"my-market"}),r.a.createElement(f.Tabs.TabPane,{tab:v.a.translate("exchange.more"),key:"find-market"}))),rt),(!se&&Et||se&&wt)&&(At=!0),(!se&&wt||se&&Et)&&(xt=!0),Ct=r.a.createElement("div",{className:"grid-block left-column shrink no-overflow"},re.includes("left")?se?wt:Et:null,At?r.a.createElement("div",{style:{width:"auto",paddingTop:"calc(50vh - 80px)"},onClick:this._togglePanel.bind(this,"left")},r.a.createElement(f.Icon,{"data-intro":v.a.translate("walkthrough.panel_hide"),type:re.includes("left")?"caret-left":"caret-right"})):null),St=r.a.createElement("div",{className:"grid-block left-column shrink no-overflow"},xt?r.a.createElement("div",{style:{width:"auto",paddingTop:"calc(50vh - 80px)"},onClick:this._togglePanel.bind(this,"right")},r.a.createElement(f.Icon,{"data-intro":v.a.translate("walkthrough.panel_hide"),type:re.includes("right")?"caret-right":"caret-left"})):null,re.includes("right")?se?Et:wt:null)),r.a.createElement("div",{className:"grid-block vertical"},this.props.marketReady?null:r.a.createElement(za.a,null),r.a.createElement(Je,{hasAnyPriceAlert:this.props.hasAnyPriceAlert,showPriceAlertModal:this.showPriceAlertModal,account:this.props.currentAccount,quoteAsset:u,baseAsset:p,hasPrediction:He,starredMarkets:c,lowestAsk:O,highestBid:P,lowestCallPrice:d,showCallLimit:Ae,feedPrice:k,marketReady:m,latestPrice:xe&&xe.getPrice(),marketStats:h,selectedMarketPickerAsset:this.state.marketPickerAsset,onToggleMarketPicker:this._toggleMarketPicker.bind(this),onTogglePersonalize:this._togglePersonalize.bind(this),showVolumeChart:Pe}),r.a.createElement("div",{className:"grid-block page-layout market-layout"},this.state.isMarketPickerModalVisible||this.state.isMarketPickerModalLoaded?r.a.createElement(da,bn({visible:this.state.isMarketPickerModalVisible,showModal:this.showMarketPickerModal,hideModal:this.hideMarketPickerModal,marketPickerAsset:this.state.marketPickerAsset,onToggleMarketPicker:this._toggleMarketPicker.bind(this)},this.props)):null,this.state.isPersonalizeModalVisible||this.state.isPersonalizeModalLoaded?r.a.createElement(ba,{visible:this.state.isPersonalizeModalVisible,showModal:this.showPersonalizeModal,hideModal:this.hidePersonalizeModal,viewSettings:this.props.viewSettings,chartType:H,chartHeight:U,onTogglePersonalize:this._togglePersonalize.bind(this),onChangeChartHeight:this.onChangeChartHeight.bind(this),handleGroupOrderLimitChange:this._onGroupOrderLimitChange.bind(this),trackedGroupsConfig:C,currentGroupOrderLimit:S,verticalOrderBook:V,hideScrollbars:ee,mirrorPanels:se,panelTabs:le,singleColumnOrderForm:ce,buySellTop:J,flipBuySell:W,flipOrderBook:ue,tinyScreen:Qe,smallScreen:Ge,orderBookReversed:pe,chartZoom:de,chartTools:he,hideFunctionButtons:me,onMoveOrderBook:this._moveOrderBook.bind(this),onMirrorPanels:this._mirrorPanels.bind(this),onToggleScrollbars:this._toggleScrollbars.bind(this),onSetAutoscroll:this._setAutoscroll.bind(this),onToggleChart:this._toggleChart.bind(this),onSetPanelTabs:this._setPanelTabs.bind(this),onToggleSingleColumnOrderForm:this._toggleSingleColumnOrderForm.bind(this),onToggleBuySellPosition:this._toggleBuySellPosition.bind(this),onFlipBuySell:this._flipBuySell.bind(this),onFlipOrderBook:this._flipOrderBook.bind(this),onOrderBookReversed:this._orderBookReversed.bind(this),onChartZoom:this._chartZoom.bind(this),onChartTools:this._chartTools.bind(this),onHideFunctionButtons:this._hideFunctionButtons.bind(this)}):null,r.a.createElement(on,null),Ct,r.a.createElement("div",{style:{paddingTop:0},className:g()("grid-block main-content vertical no-overflow")},r.a.createElement("div",{className:"grid-block vertical no-padding ps-container",id:"CenterContent",ref:"center","data-intro":Qe?v.a.translate("walkthrough.collapsed_items"):null},Qe?null:r.a.createElement("div",null,dt,H&&"price_chart"==H?r.a.createElement("div",{className:"grid-block shrink no-overflow",id:"market-charts"},ut):null,H&&"market_depth"==H?r.a.createElement("div",{className:"grid-block vertical no-padding shrink"},pt):null),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},kt))),St),Ne&&(this.state.isBorrowQuoteModalVisible||this.state.isBorrowQuoteModalLoaded)?r.a.createElement(Ua.a,{visible:this.state.isBorrowQuoteModalVisible,hideModal:this.hideBorrowQuoteModal,quoteAssetObj:u.get("id"),backingAssetObj:u.getIn(["bitasset","options","short_backing_asset"]),accountObj:a}):null,Be&&(this.state.isBorrowBaseModalVisible||this.state.isBorrowBaseModalLoaded)?r.a.createElement(Ua.a,{visible:this.state.isBorrowBaseModalVisible,hideModal:this.hideBorrowBaseModal,quoteAssetObj:p.get("id"),backingAssetObj:p.getIn(["bitasset","options","short_backing_asset"]),accountObj:a}):null,this.state.isDepositModalVisible||this.state.isDepositModalLoaded?r.a.createElement(sn.a,bn({visible:this.state.isDepositModalVisible,hideModal:this.hideDepositModal,ref:"deposit_modal",action:"deposit",fiatModal:!1,account:a,sender:a,asset:"bid"===ae?ye:ve,modalId:"simple_deposit_modal"+("bid"===ae?"":"_ask"),balance:"bid"===ae?Ee:ke},this.props.backedCoins.find((function(e){return e.symbol===("bid"===ae?ye.get("symbol"):ve.get("symbol"))})))):null,this.state.isDepositBridgeModalVisible||this.state.isDepositBridgeModalLoaded?r.a.createElement(ln.a,{visible:this.state.isDepositBridgeModalVisible,hideModal:this.hideDepositBridgeModal,ref:"bridge_modal",action:"deposit",account:a.get("name"),sender:a.get("id"),asset:"bid"===te?ye.get("id"):ve.get("id"),modalId:"simple_bridge_modal"+("bid"===te?"":"_ask"),balances:["bid"===te?Ee:ke],bridges:this.props.bridgeCoins.get("bid"===te?ye.get("symbol"):ve.get("symbol"))||null}):null,this.state.isConfirmBuyOrderModalVisible||this.state.isConfirmBuyOrderModalLoaded?r.a.createElement(ma,{visible:this.state.isConfirmBuyOrderModalVisible,hideModal:this.hideConfirmBuyOrderModal,type:"buy",onForce:this._forceBuy.bind(this,"buy",Ve,Ee,we),diff:G,hasOrders:x.length>0}):null,this.state.isConfirmSellOrderModalVisible||this.state.isConfirmSellOrderModalLoaded?r.a.createElement(ma,{visible:this.state.isConfirmSellOrderModalVisible,hideModal:this.hideConfirmSellOrderModal,type:"sell",onForce:this._forceSell.bind(this,"sell",Re,ke,we),diff:Q,hasOrders:A.length>0}):null,r.a.createElement(hn,{onSave:this.handlePriceAlertSave,rules:this.getPriceAlertRules(),latestPrice:xe&&xe.getPrice(),quoteAsset:this.props.quoteAsset.get("id"),baseAsset:this.props.baseAsset.get("id"),visible:this.state.isPriceAlertModalVisible,showModal:this.showPriceAlertModal,hideModal:this.hidePriceAlertModal}))}}]),t}(r.a.Component);_n.propTypes={marketCallOrders:x.a.object.isRequired,activeMarketHistory:x.a.object.isRequired,viewSettings:x.a.object.isRequired},_n.defaultProps={marketCallOrders:[],activeMarketHistory:{},viewSettings:{}};var kn=_n,En=a(597),wn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Cn=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function xn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var On=function(e){function t(){return Sn(this,t),An(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return xn(t,e),Cn(t,[{key:"render",value:function(){var e=this.props.match.params.marketID.toUpperCase().split("_");return e[0]===e[1]?r.a.createElement(En.a,{subtitle:"market_not_found_subtitle"}):r.a.createElement(p.a,{stores:[o.a,s.a,i.a,u.a,c.a],inject:{hasAnyPriceAlert:function(){return i.a.hasAnyPriceAlert(e[0],e[1])},priceAlert:function(){return i.a.getState().priceAlert},locale:function(){return c.a.getState().currentLocale},lockedWalletState:function(){return u.a.getState().locked},marketLimitOrders:function(){return o.a.getState().marketLimitOrders},marketCallOrders:function(){return o.a.getState().marketCallOrders},invertedCalls:function(){return o.a.getState().invertedCalls},marketSettleOrders:function(){return o.a.getState().marketSettleOrders},marketData:function(){return o.a.getState().marketData},totals:function(){return o.a.getState().totals},activeMarketHistory:function(){return o.a.getState().activeMarketHistory},bucketSize:function(){return o.a.getState().bucketSize},buckets:function(){return o.a.getState().buckets},lowestCallPrice:function(){return o.a.getState().lowestCallPrice},feedPrice:function(){return o.a.getState().feedPrice},currentAccount:function(){return s.a.getState().currentAccount},myActiveAccounts:function(){return s.a.getState().myActiveAccounts},viewSettings:function(){return i.a.getState().viewSettings},settings:function(){return i.a.getState().settings},exchange:function(){return i.a.getState().exchange},starredMarkets:function(){return i.a.getState().starredMarkets},marketDirections:function(){return i.a.getState().marketDirections},marketStats:function(){return o.a.getState().marketStats},marketReady:function(){return o.a.getState().marketReady},backedCoins:function(){return l.a.getState().backedCoins.get("OPEN",[])},bridgeCoins:function(){return l.a.getState().bridgeCoins},miniDepthChart:function(){return i.a.getState().viewSettings.get("miniDepthChart",!0)},dataFeed:function(){return new xa},trackedGroupsConfig:function(){return o.a.getState().trackedGroupsConfig},currentGroupOrderLimit:function(){return o.a.getState().currentGroupLimit}}},r.a.createElement(jn,{history:this.props.history,location:this.props.location,quoteAsset:e[0],baseAsset:e[1]}))}}]),t}(r.a.Component),Pn=Object(m.EmitterInstance)(),Tn=void 0,Nn=void 0,Bn=void 0,Mn=void 0,Fn=void 0,jn=function(e){function t(e){Sn(this,t);var a=An(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={sub:null},a._subToMarket=a._subToMarket.bind(a),a}return xn(t,e),Cn(t,[{key:"componentWillMount",value:function(){var e=this;null!==this.props.quoteAsset&&null!==this.props.baseAsset&&(this.props.quoteAsset.toJS&&this.props.baseAsset.toJS&&this._subToMarket(this.props),Pn.on("cancel-order",Nn=P.a.cancelLimitOrderSuccess),Pn.on("close-call",Tn=P.a.closeCallOrderSuccess),Pn.on("call-order-update",Bn=function(t){var a=t.call_price.base.asset_id,n=t.call_price.quote.asset_id,r=e.props.baseAsset.get("id"),o=e.props.quoteAsset.get("id");a!==r&&a!==o||n!==r&&n!==o||P.a.callOrderUpdate(t)}),Pn.on("bitasset-update",Mn=P.a.feedUpdate),Pn.on("settle-order-update",Fn=function(t){var a=market_utils.isMarketAsset(e.props.quoteAsset,e.props.baseAsset),n=a.isMarketAsset,r=a.marketAsset;n&&r.id===t.balance.asset_id&&P.a.settleOrderUpdate(r.id)}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(null!==e.quoteAsset&&null!==e.baseAsset){if(e.baseAsset&&e.baseAsset.getIn(["bitasset","is_prediction_market"])&&this.props.history.push("/market/"+e.baseAsset.get("symbol")+"_"+e.quoteAsset.get("symbol")),e.quoteAsset&&e.baseAsset&&!this.state.sub)return this._subToMarket(e);if(e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol")){var a=this.state.sub.split("_");P.a.unSubscribeMarket(a[0],a[1]).then((function(){t._subToMarket(e)}))}}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.quoteAsset,a=e.baseAsset;null!==t&&null!==a&&(P.a.unSubscribeMarket(t.get("id"),a.get("id")),Pn&&(Pn.off("cancel-order",Nn),Pn.off("close-call",Tn),Pn.off("call-order-update",Bn),Pn.off("bitasset-update",Mn),Pn.off("settle-order-update",Fn)))}},{key:"_subToMarket",value:function(e,t,a){var n=e.quoteAsset,r=e.baseAsset,o=e.bucketSize,s=e.currentGroupOrderLimit;t&&(o=t),a&&(s=a),n.get("id")&&r.get("id")&&(P.a.subscribeMarket.defer(r,n,o,s),this.setState({sub:n.get("id")+"_"+r.get("id")}))}},{key:"render",value:function(){return null===this.props.quoteAsset||null===this.props.baseAsset?r.a.createElement(En.a,{subtitle:"market_not_found_subtitle"}):r.a.createElement(kn,wn({},this.props,{sub:this.state.sub,subToMarket:this._subToMarket}))}}]),t}(r.a.Component);jn.propTypes={currentAccount:R.a.ChainAccount.isRequired,quoteAsset:R.a.ChainAsset.isRequired,baseAsset:R.a.ChainAsset.isRequired,coreAsset:R.a.ChainAsset.isRequired},jn.defaultProps={currentAccount:"1.2.3",coreAsset:"1.3.0"},jn=Object(L.a)(jn,{show_loader:!0});t.default=On}}]);
//# sourceMappingURL=exchange.js.map